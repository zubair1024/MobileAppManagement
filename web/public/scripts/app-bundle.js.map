{"version":3,"sources":["src/app.js","src/appState.js","src/auth-context.js","src/auth-guard.js","src/environment.js","src/http.js","src/main.js","src/ad-list/ad-list.js","src/alarms/alarms.js","src/administration/administration.js","src/app-header/app-header.js","src/app-navbar/app-navbar.js","src/app-footer/app-footer.js","src/app-notifications/app-notifications.js","src/asset-admin/asset-admin.js","src/asset-details/asset-details.js","src/commands/commands.js","src/asset-list/asset-list.js","src/geofences/geofences.js","src/locations/locations.js","src/login/forgot-password.js","src/login/login.js","src/login/user-password.js","src/map/map.js","src/overview/overview.js","src/profile/profile.js","src/project-admin/project-admin.js","src/project-list/project-list.js","src/report-asset-utilization/report-asset-utilization.js","src/resources/index.js","src/user-admin/user-admin.js","src/asset-admin - Copy/asset-admin.js","src/ad-admin/asset-admin.js","src/ad-admin/ad-admin.js"],"names":["Application","aurelia","router","console","info","configureRouter","config","title","App","currentUser","addPipelineStep","postRenderStep","map","route","moduleId","name","activate","created","owningView","myView","log","bind","bindingContext","overrideContext","attached","argument","me","$","sideNav","slider","full_width","dropdown","inDuration","outDuration","constrain_width","hover","alignment","gutter","belowOrigin","collapsible","click","accordion","not","material_select","leftnav","height","leftnavHeight","window","innerHeight","perfectScrollbar","suppressScrollX","righttnav","kendoTabStrip","animation","open","effects","tooltip","delay","ajaxPrefilter","options","originalOptions","jqXHR","error","data","status","Materialize","toast","localStorage","removeItem","setRoot","statusText","detached","unbind","run","navigationInstruction","next","edge","menuWidth","AppState","loggedInUser","apiUrl","features","engineStatus","enabled","inUse","nonReport","alarmFeature","threshold","hasMapPosition","powerOutputKW","grid","toolbar","excel","filterable","filterMenuInit","e","sender","dataSource","schema","model","fields","field","type","beginOperator","container","find","value","trigger","readonly","logicOperator","endOperator","columnMenu","transport","read","contentType","accept","dataType","xhrFields","withCredentials","total","eventTime","createdTime","updated_at","created_at","pageSize","serverPaging","serverFiltering","serverSorting","dataBound","setTimeout","i","columns","length","autoFitColumn","groupable","reorderable","resizable","sortable","pageable","refresh","pageSizes","buttonCount","extra","operators","string","contains","date","gte","lte","generatorFrequency","generatorStatus","generatorEngineRating","locationTypes","geofenceTypes","userRole","volume","distance","pressure","speed","temperature","dateTimeFormat","dateFormat","timeFormat","AuthContext","AuthGuard","active","getItem","warn","debug","testing","Http","client","configure","x","withBaseUrl","withHeader","withInterceptor","request","message","requestError","response","JSON","parse","responseError","handleHttpErrors","statusCode","responseType","stringify","use","standardConfiguration","feature","developmentLogging","plugin","start","then","rootComponent","isLoggedIn","a","document","body","AdList","http","project","cards","user","tagger","Taggle","allowDuplicates","onTagAdd","event","tag","renderGrid","getTags","values","onTagRemove","currentInstruction","params","id","getProject","loading","deferred","callback","get","res","tags","extend","detailTemplate","kendo","template","html","width","cell","operator","messages","privileges","indexOf","push","filter","url","_id","assets","join","kendoGrid","renderEngineRatingChart","loadingEngineRatingChart","noEngineRatingChart","engineRating","engineRatingChart","labels","datasets","prime","continuous","standby","backgroundColor","hoverBackgroundColor","renderCapacityChart","loadingCapacityChart","generatorCapacity","noCapacityChart","categories","rating","capacityChart","kendoChart","text","theme","legend","position","seriesDefaults","seriesColors","series","valueAxis","format","line","visible","axisCrossingValue","categoryAxis","Alarms","currentView","renderAlarms","command","acknowledgeAlarm","preventDefault","dataItem","currentTarget","closest","prompt","ajax","method","msg","alarm","toJSON","success","alert","err","Administration","renderUsers","AppHeader","renderUniversalSearch","kendoAutoComplete","dataTextField","ignoreCase","minLength","placeholder","select","objectType","navigateToRoute","toggleFullScreen","fullScreenElement","mozFullScreen","webkitIsFullScreen","documentElement","requestFullScreen","mozRequestFullScreen","webkitRequestFullScreen","cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","AppNavbar","alarmsCount","userData","kendoDialog","closable","modal","content","supportDialog","close","getAlarmsCount","logout","post","showSupportDialog","deattached","clearInterval","alarmCountPoller","AppFooter","AppNotifications","alarms","notifications","getNotifications","setInterval","cache","notificationCache","dismissNotification","AssetAdmin","httpClient","update","fetchAPI","add","interfaceType","kendoDropDownList","change","uploadAssetImage","images","image","filename","formData","FormData","append","fetch","json","catch","submit","put","location","hash","delete","AssetDetails","mapControl","refreshInterval","autoRefresh","autoPan","autoZoom","autoCluster","markers","stats","controls","averagePowerOutput","averageFuelConsumed","false","true","commands","remoteStartStop","timestamp","ping","getAsset","setCommandStatuses","renderLine","renderFuelLevelGauge","initMap","google","maps","googleMap","renderAssetMarker","latlngBounds","LatLngBounds","Map","getElementById","zoom","center","lat","lng","mapTypeId","mapTypeControl","scrollwheel","draggable","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","navigationControl","navigationControlOptions","NavigationControlStyle","SMALL","renderLegend","innerHTML","ControlPosition","RIGHT_TOP","markerCluster","removeCluster","markerInfo","infowindow","InfoWindow","_asset","eventType","util","dateTime","latitude","longitude","engineHourMeter","powerSupplyVoltage","item","engineCoolantTemperature","oilPressure","iconUrl","marker","Marker","parseFloat","assetName","icon","addListener","iwOuter","iwBackground","prev","children","css","display","addClusters","len","fitBounds","markerClusterer","MarkerClusterer","imagePath","renderChart","ctx","pieChart","canvas","label","fill","fillColor","bodyFontColor","lineTension","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","adddata","myLineChart","Math","floor","random","moment","Date","option","showLines","fontColor","scales","yAxes","ticks","beginAtZero","xAxes","Line","renderEvents","hidden","renderAssetAlarms","assetAlarms","toggleStats","str","kendoRadialGauge","pointer","scale","minorUnit","startAngle","endAngle","max","ranges","from","to","color","remotePingCommand","remoteStart","addClass","remoteStop","sendRemoteCommand","cmd","imei","sensor","Commands","imeis","interfaceMap","btnText","btnDisable","kendoMultiSelect","autoBind","dataValueField","suggest","index","deselect","splice","sendCommand","rawCommand","AssetList","Geofences","renderGeofences","deleteGeofence","confirm","massUpload","files","file","match","now","renderLocations","deleteLocation","ForgotPassword","Login","mapUnknownRoutes","particlesJS","UserPassword","loginBtnText","loginName","password","login","setItem","locationCreation","dropMarker","markerSelected","locationMarkers","geofenceMarkers","newLocation","tabs","newGeofence","geofenceLocation","maxSelectedItems","_location","renderAssetMarkers","initMarkerSelect","renderLocationsTree","renderGeofencesTree","MapTypeId","ROADMAP","markerSelect","autoClose","clearMarkers","removeMarkers","setMap","createDropMarker","latlng","zIndex","round","startRefresher","refresher","getAssetMarkers","stopRefresher","toggleRefresher","srcElement","checked","toggleClusterer","filterMarkers","selectedValues","selectedLen","markersLen","j","getMap","selectGeofence","geofencesToShow","ds","view","items","row","table","uid","checkbox","is","showGeofences","removeGeofences","geofences","renderGeofence","geofence","geofenceMarker","strokeColor","geoShape","Circle","strokeOpacity","strokeWeight","fillOpacity","radius","Polygon","paths","path","bounds","groupHeaderTemplate","scrollable","group","dir","aggregates","aggregate","selectLocation","locationsToShow","showLocations","removeLocations","locations","showAllLocations","showLocationCreationModel","dropMarkerListener","latLng","toPrecision","hideLocationCreationModel","removeListener","createLocation","showGeofenceCreationModel","geofenceCreation","showGeofenceCreationOverlay","hideGeofenceCreationModel","deleteAllShape","hideGeofenceCreationOverlay","createGeofence","drawingManager","clearSelection","selectedShape","setEditable","setSelection","shape","deleteSelectedShape","CenterControl","controlDiv","controlUI","createElement","border","borderRadius","boxShadow","cursor","marginBottom","textAlign","appendChild","controlText","fontFamily","fontSize","lineHeight","paddingLeft","paddingRight","addEventListener","all_overlays","drawing","DrawingManager","drawingControl","drawingControlOptions","TOP_CENTER","drawingModes","OverlayType","CIRCLE","POLYGON","RECTANGLE","circleOptions","clickable","editable","polygonOptions","rectangleOptions","getPolygonCoords","newShape","getPath","getLength","getAt","toUrlValue","pathToCoords","coords","overlay","getCenter","getRadius","getBounds","MARKER","setDrawingMode","centerControlDiv","centerControl","BOTTOM_CENTER","Overview","appState","opStatistics","styles","featureType","elementType","stylers","visibility","hue","lightness","loadingMap","renderPowerOutputBar","loadingPowerOutputBar","day","_project","key","renderliveOperationalStatisticsPie","loadingliveOperationalStatistics","loadingliveOperationalStatisticsPie","current","opStatisticsPrevious","previous","liveoperationalstatistics","notOperational","operational","unknown","renderMiniAlarms","Profile","httpclient","timezone","kendoComboBox","tz","names","v","val","uploadAvatar","ProjectAdmin","projectAssets","idx","ProjectList","showOperators","suggestionOperator","ReportAssetUtilization","UserAdmin","possiblePrivileges","displayControls","AdAdmin"],"mappings":";;;;;;;;;;;;;;;;MAOaA,sBAAAA,sBADZ;AAEC,yBAAYC,OAAZ,EAAqBC,MAArB,EAA6B;AAAA;;AAC3B,WAAKD,OAAL,GAAeA,OAAf;AACA,WAAKC,MAAL,GAAcA,MAAd;AACAC,cAAQC,IAAR,CAAa,WAAb;AACD;;0BAEDC,2CAAgBC,QAAQJ,QAAQ;AAC9BI,aAAOC,KAAP,GAAe,SAAf;AACAC,UAAIC,WAAJ;;AAIAH,aAAOI,eAAP,CAAuB,YAAvB,EAAqCC,cAArC;;AAEAL,aAAOM,GAAP,CAAW,CACT;AACEC,eAAO,OADT;AAEEC,kBAAU,aAFZ;AAGEC,cAAM;AAHR,OADS,EAMT;AACEF,eAAO,CAAC,EAAD,EAAK,UAAL,CADT;AAEEE,cAAM,UAFR;AAGED,kBAAU,mBAHZ;AAIEP,eAAO;AAJT,OANS,EAYT;AACEM,eAAO,SADT;AAEEE,cAAM,SAFR;AAGED,kBAAU,iBAHZ;AAIEP,eAAO;AAJT,OAZS,EAkBT;AACEM,eAAO,gBADT;AAEEE,cAAM,gBAFR;AAGED,kBAAU,+BAHZ;AAIEP,eAAO;AAJT,OAlBS,EAwBT;AACEM,eAAO,YADT;AAEEE,cAAM,YAFR;AAGED,kBAAU,uBAHZ;AAIEP,eAAO;AAJT,OAxBS,EA8BT;AACEM,eAAO,gBADT;AAEEE,cAAM,gBAFR;AAGED,kBAAU,uBAHZ;AAIEP,eAAO;AAJT,OA9BS,EAoCT;AACEM,eAAO,YADT;AAEEE,cAAM,YAFR;AAGED,kBAAU,uBAHZ;AAIEP,eAAO;AAJT,OApCS,EA0CT;AACEM,eAAO,gBADT;AAEEE,cAAM,gBAFR;AAGED,kBAAU,uBAHZ;AAIEP,eAAO;AAJT,OA1CS,EAgDT;AACEM,eAAO,aADT;AAEEE,cAAM,aAFR;AAGED,kBAAU,yBAHZ;AAIEP,eAAO;AAJT,OAhDS,EAsDT;AACEM,eAAO,iBADT;AAEEE,cAAM,iBAFR;AAGED,kBAAU,yBAHZ;AAIEP,eAAO;AAJT,OAtDS,EA4DT;AACEM,eAAO,cADT;AAEEE,cAAM,cAFR;AAGED,kBAAU,2BAHZ;AAIEP,eAAO;AAJT,OA5DS,EAkET;AACEM,eAAO,eADT;AAEEE,cAAM,eAFR;AAGED,kBAAU,6BAHZ;AAIEP,eAAO;AAJT,OAlES,EAwET;AACEM,eAAO,mBADT;AAEEE,cAAM,mBAFR;AAGED,kBAAU,6BAHZ;AAIEP,eAAO;AAJT,OAxES,EA8ET;AACEM,eAAO,mBADT;AAEEE,cAAM,eAFR;AAGED,kBAAU,6BAHZ;AAIEP,eAAO;AAJT,OA9ES,EAoFT;AACEM,eAAO,QADT;AAEEE,cAAM,QAFR;AAGED,kBAAU,eAHZ;AAIEP,eAAO;AAJT,OApFS,EA0FT;AACEM,eAAO,KADT;AAEEE,cAAM,KAFR;AAGED,kBAAU,SAHZ;AAIEP,eAAO;AAJT,OA1FS,EAgGT;AACEM,eAAO,WADT;AAEEE,cAAM,WAFR;AAGED,kBAAU,qBAHZ;AAIEP,eAAO;AAJT,OAhGS,EAsGT;AACEM,eAAO,WADT;AAEEE,cAAM,WAFR;AAGED,kBAAU,qBAHZ;AAIEP,eAAO;AAJT,OAtGS,EA4GT;AACEM,eAAO,UADT;AAEEE,cAAM,UAFR;AAGED,kBAAU,mBAHZ;AAIEP,eAAO;AAJT,OA5GS,EAkHT;AACEM,eAAO,0BADT;AAEEE,cAAM,0BAFR;AAGED,kBAAU,mDAHZ;AAIEP,eAAO;AAJT,OAlHS,EAyHT;AACEM,eAAO,SADT;AAEEE,cAAM,SAFR;AAGED,kBAAU,iBAHZ;AAIEP,eAAO;AAJT,OAzHS,EA+HT;AACEM,eAAO,UADT;AAEEE,cAAM,UAFR;AAGED,kBAAU,mBAHZ;AAIEP,eAAO;AAJT,OA/HS,CAAX;AAsIA,WAAKL,MAAL,GAAcA,MAAd;AACD;;0BAEDc,+BAAW;AACTb,cAAQC,IAAR,CAAa,wBAAb;AACD;;0BAEDa,2BAAQC,YAAYC,QAAQ;AAC1BhB,cAAQiB,GAAR,CAAY,aAAZ;AAGD;;0BAEDC,qBAAKC,gBAAgBC,iBAAiB;AACpCpB,cAAQC,IAAR,CAAa,UAAb;AAGD;;0BAEDoB,6BAASC,UAAU;AACjBtB,cAAQC,IAAR,CAAa,cAAb;AACA,UAAIsB,KAAK,IAAT;;AAIAC,QAAE,mBAAF,EAAuBC,OAAvB,CACE,EADF;;AAOAD,QAAE,SAAF,EAAaE,MAAb,CAAoB;AAClBC,oBAAY;AADM,OAApB;;AAKAH,QAAE,kBAAF,EAAsBI,QAAtB,CAA+B;AAC7BC,oBAAY,GADiB;AAE7BC,qBAAa,GAFgB;AAG7BC,yBAAiB,IAHY;AAI7BC,eAAO,KAJsB;AAK7BC,mBAAW,MALkB;AAM7BC,gBAAQ,CANqB;AAO7BC,qBAAa,IAPgB,EAA/B;;AAWAX,QAAE,cAAF,EAAkBY,WAAlB;;AAEAZ,QAAE,sBAAF,EAA0Ba,KAA1B,CAAgC,YAAW;AACzCb,UAAE,gBAAF,EAAoBC,OAApB,CAA4B,MAA5B;AACD,OAFD;;AAIAD,QAAE,mBAAF,EAAuBY,WAAvB,CAAmC;AACjCE,mBAAW,KADsB,EAAnC;;AAKAd,QAAE,QAAF,EAAYe,GAAZ,CAAgB,WAAhB,EAA6BC,eAA7B;AACA,UAAIC,UAAUjB,EAAE,cAAF,EAAkBkB,MAAlB,EAAd;AACA,UAAIC,gBAAgBC,OAAOC,WAAP,GAAqBJ,OAAzC;AACAjB,QAAE,sBAAF,EAA0BkB,MAA1B,CAAiCC,aAAjC,EAAgDG,gBAAhD,CAAiE;AAC/DC,yBAAiB;AAD8C,OAAjE;AAGA,UAAIC,YAAYxB,EAAE,WAAF,EAAekB,MAAf,EAAhB;AACAlB,QAAE,uBAAF,EAA2BkB,MAA3B,CAAkCM,SAAlC,EAA6CF,gBAA7C,CAA8D;AAC5DC,yBAAiB;AAD2C,OAA9D;;AAKAvB,QAAE,WAAF,EAAeyB,aAAf,CAA6B;AAC3BC,mBAAW;AACTC,gBAAM;AACJC,qBAAS;AADL;AADG;AADgB,OAA7B;;AASA5B,QAAE,aAAF,EAAiB6B,OAAjB,CAAyB,EAAEC,OAAO,EAAT,EAAzB;;AAGA9B,QAAE+B,aAAF,CAAgB,UAASC,OAAT,EAAkBC,eAAlB,EAAmCC,KAAnC,EAA0C;AACxDF,gBAAQG,KAAR,GAAgB,UAASC,IAAT,EAAe;AAC7B,kBAAQA,KAAKC,MAAb;AACA,iBAAK,CAAL;AACEC,0BAAYC,KAAZ,CACI,kEADJ,EAEI,IAFJ;AAIA;;AAEF,iBAAK,GAAL;AACEC,2BAAaC,UAAb,CAAwB,aAAxB;AACA,qBAAO5D,IAAIC,WAAX;AACAiB,iBAAGzB,OAAH,CAAWoE,OAAX,CAAmB,aAAnB;AACAJ,0BAAYC,KAAZ,CAAkB,qBAAlB,EAAyC,IAAzC;AACA;;AAEF,iBAAK,GAAL;AACED,0BAAYC,KAAZ,CAAkB,wBAAlB,EAA4C,IAA5C;AACA;;AAEF;AACE,kBAAIH,KAAKO,UAAT,EAAqB;AACnBL,4BAAYC,KAAZ,CAAkBH,KAAKO,UAAvB,EAAmC,IAAnC;AACD;AACD;AAvBF;AAyBD,SA1BD;AA2BD,OA5BD;AA6BD;;0BAEDC,6BAAS9C,UAAU;AACjBtB,cAAQC,IAAR,CAAa,cAAb;AAGD;;0BAEDoE,yBAAO/C,UAAU;AACftB,cAAQiB,GAAR,CAAY,YAAZ;AAGD;;;;;MAsBGT;;;;;6BACJ8D,mBAAIC,uBAAuBC,MAAM;AAE/BhD,QAAE,mBAAF,EAAuBC,OAAvB,CAA+B;AAC7BgD,cAAM,MADuB,EAA/B;;AAKAjD,QAAE,gBAAF,EAAoBC,OAApB,CAA4B;AAC1BiD,mBAAW,GADe;AAE1BD,cAAM;AAFoB,OAA5B;;AAKA,aAAOD,MAAP;AACD;;;;;;;;;;;;;;;;;;MC5TUG,mBAAAA,WACX,oBAAc;AAAA;;AACZ,QAAIpD,KAAK,IAAT;AACA,SAAKqD,YAAL,GAAoB,IAApB;;AAIA,SAAKzE,MAAL,GAAc;AACZ0E,cAAQ,uBADI;;AAGZC,gBAAU;AACRC,sBAAc;AACZC,mBAAS;AADG,SADN;AAIRC,eAAO;AACLD,mBAAS;AADJ,SAJC;AAORE,mBAAW;AACTF,mBAAS,IADA;AAETG,wBAAc,IAFL;AAGTC,qBAAW;AAHF,SAPH;AAYRC,wBAAgB;AACdL,mBAAS;AADK,SAZR;AAeRM,uBAAe;AACbN,mBAAS;AADI;AAfP,OAHE;AAsBZO,YAAM;AACJC,iBAAS,CAAC,OAAD,EAAU,KAAV,CADL;AAEJC,eAAO;AACLC,sBAAY;AADP,SAFH;;AAMJC,wBAAgB,wBAASC,CAAT,EAAY;AAC1B,cACEA,EAAEC,MAAF,CAASC,UAAT,CAAoBtC,OAApB,CAA4BuC,MAA5B,CAAmCC,KAAnC,CAAyCC,MAAzC,CAAgDL,EAAEM,KAAlD,KACAN,EAAEC,MAAF,CAASC,UAAT,CAAoBtC,OAApB,CAA4BuC,MAA5B,CAAmCC,KAAnC,CAAyCC,MAAzC,CAAgDL,EAAEM,KAAlD,EAAyDC,IAAzD,IACE,MAHJ,EAIE;AACA,gBAAIC,gBAAgBR,EAAES,SAAF,CACjBC,IADiB,CACZ,gCADY,EAEjB1C,IAFiB,CAEZ,mBAFY,CAApB;AAGAwC,0BAAcG,KAAd,CAAoB,KAApB;AACAH,0BAAcI,OAAd,CAAsB,QAAtB;AACAJ,0BAAcK,QAAd;;AAEA,gBAAIC,gBAAgBd,EAAES,SAAF,CACjBC,IADiB,CACZ,gCADY,EAEjB1C,IAFiB,CAEZ,mBAFY,CAApB;AAGA8C,0BAAcD,QAAd;;AAEA,gBAAIE,cAAcf,EAAES,SAAF,CACfC,IADe,CACV,gCADU,EAEf1C,IAFe,CAEV,mBAFU,CAAlB;AAGA+C,wBAAYJ,KAAZ,CAAkB,KAAlB;AACAI,wBAAYH,OAAZ,CAAoB,QAApB;AACAJ,0BAAcK,QAAd;AACD;AACF,SA/BG;AAgCJG,oBAAY,IAhCR;AAiCJd,oBAAY;AACVK,gBAAM,OADI;AAEVU,qBAAW;AACTC,kBAAM;AACJX,oBAAM,KADF;AAEJY,2BAAa,kBAFT;AAGJC,sBAAQ,mCAHJ;AAIJC,wBAAU,MAJN;AAKJC,yBAAW,EAAEC,iBAAiB,IAAnB;AALP,aADG;AAQTxD,mBAAO,eAASiC,CAAT,EAAY;AACjB,mBAAK,CAAL;AACD;AAVQ,WAFD;AAcVG,kBAAQ;AACNnC,kBAAM,WADA;AAENwD,mBAAO,YAFD;AAGNpB,mBAAO;AACLC,sBAAQ;AACNoB,2BAAW,EAAElB,MAAM,MAAR,EADL;AAENmB,6BAAa,EAAEnB,MAAM,MAAR,EAFP;AAGNoB,4BAAY,EAAEpB,MAAM,MAAR,EAHN;AAINqB,4BAAY,EAAErB,MAAM,MAAR;AAJN;AADH;AAHD,WAdE;AA0BVsB,oBAAU,EA1BA;AA2BVC,wBAAc,IA3BJ;AA4BVC,2BAAiB,IA5BP;AA6BVC,yBAAe;AA7BL,SAjCR;AAgEJC,mBAAW,qBAAW;AACpB,cAAItC,OAAO,IAAX;AACAuC,qBAAW,YAAW;AACpB,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIxC,KAAKyC,OAAL,CAAaC,MAAjC,EAAyCF,GAAzC,EAA8C;AAC5CxC,mBAAK2C,aAAL,CAAmBH,CAAnB;AACD;AACF,WAJD,EAIG,CAJH;AAKD,SAvEG;AAwEJrF,gBAAQ,GAxEJ;AAyEJyF,mBAAW,IAzEP;AA0EJC,qBAAa,IA1ET;AA2EJC,mBAAW,IA3EP;AA4EJC,kBAAU,IA5EN;AA6EJC,kBAAU;AACRC,mBAAS,IADD;AAERC,qBAAW,IAFH;AAGRC,uBAAa;AAHL,SA7EN;AAkFJhD,oBAAY;AACViD,iBAAO,KADG;AAEVC,qBAAW;AACTC,oBAAQ;AACNC,wBAAU;AADJ,aADC;AAITC,kBAAM;AACJC,mBAAK,YADD;AAEJC,mBAAK;AAFD;AAJG;AAFD;AAlFR,OAtBM;;AAwHZC,0BAAoB,CAAC,EAAD,EAAK,EAAL,CAxHR;AAyHZC,uBAAiB,CACf,UADe,EAEf,aAFe,EAGf,gBAHe,EAIf,sBAJe,CAzHL;;AAkIZC,6BAAuB,CAAC,OAAD,EAAU,YAAV,EAAwB,SAAxB,CAlIX;;AAqIZC,qBAAe,CACb,mBADa,EAEb,SAFa,EAGb,MAHa,EAIb,iBAJa,EAKb,UALa,EAMb,MANa,EAOb,QAPa,EAQb,iBARa,EASb,eATa,EAUb,SAVa,EAWb,UAXa,EAYb,yBAZa,EAab,OAba,EAcb,qBAda,CArIH;;AAsJZC,qBAAe,CAAC,WAAD,EAAc,WAAd,CAtJH;;AA0JZC,gBAAU,CAAC,eAAD,EAAkB,UAAlB,CA1JE;AA2JZC,cAAQ,CAAC,GAAD,EAAM,KAAN,CA3JI;AA4JZC,gBAAU,CAAC,IAAD,EAAO,IAAP,CA5JE;AA6JZC,gBAAU,CAAC,KAAD,EAAQ,KAAR,CA7JE;AA8JZC,aAAO,CAAC,OAAD,EAAU,OAAV,CA9JK;AA+JZC,mBAAa,CAAC,SAAD,EAAY,YAAZ,CA/JD;AAgKZC,sBAAgB,CACd,qBADc,EAEd,qBAFc,EAGd,sBAHc,EAId,sBAJc,EAKd,uBALc,CAhKJ;AAuKZC,kBAAY,CAAC,WAAD,EAAc,WAAd,EAA2B,YAA3B,CAvKA;AAwKZC,kBAAY,CAAC,WAAD,EAAc,UAAd;AAxKA,KAAd;AA0KD;;;;;;;;;;;;;;;QCjLUC,sBAAAA,cACT,uBAAc;AAAA;AAAG;;;;;;;;;;;;;;;QCDRC,oBAAAA;AACT,6BAAa;AAAA;;AACTjK,oBAAQiB,GAAR,CAAY,kBAAZ;AACH;;4BACDJ,+BAAW;AACPb,oBAAQC,IAAR,CAAa,uBAAb;AACA,gBAAIiK,eAAJ;AACA,gBAAIlG,aAAamG,OAAb,CAAqB,aAArB,CAAJ,EAAyC;AACrCnK,wBAAQoK,IAAR,CAAa,mBAAb;AAEH,aAHD,MAGO;AACHpK,wBAAQiB,GAAR,CAAY,uBAAZ;AACH;AACJ;;;;;;;;;;;oBCbU;AACboJ,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;;;;;;;;;;;MCKFC,eAAAA,eADZ;AAEC,kBAAYzK,OAAZ,EAAqB0K,MAArB,EAA6BzK,MAA7B,EAAqC;AAAA;;AACnC,UAAIwB,KAAK,IAAT;AACA,WAAKiJ,MAAL,GAAcA,MAAd;AACA,WAAK1K,OAAL,GAAeA,OAAf;AACA,WAAKC,MAAL,GAAcA,MAAd;AACAC,cAAQiB,GAAR,CAAY,mBAAZ;;AAEA,WAAKuJ,MAAL,CAAYC,SAAZ,CAAsB,aAAK;AACzBC,UAAEC,WAAF,CAActK,IAAIF,MAAJ,CAAW0E,MAAzB;AACA6F,UACGE,UADH,CACc,kCADd,EACkD,kBADlD,EAEGA,UAFH,CAEc,cAFd,EAE8B,kBAF9B,EAGGA,UAHH,CAGc,QAHd,EAGwB,mCAHxB,EAIGzD,eAJH,CAImB,IAJnB,EAKG0D,eALH,CAKmB;AACfC,iBADe,mBACPC,OADO,EACE;AAEf,mBAAOA,OAAP;AACD,WAJc;AAMfC,sBANe,wBAMFrH,KANE,EAMK;AAElB,kBAAMA,KAAN;AACD,WATc;AAWfsH,kBAXe,oBAWNF,OAXM,EAWG;AAEhB,mBAAOG,KAAKC,KAAL,CAAWJ,QAAQE,QAAnB,CAAP;AACD,WAdc;AAgBfG,uBAhBe,yBAgBDzH,KAhBC,EAgBM;AAEnBpC,eAAG8J,gBAAH,CAAoB1H,KAApB;AACD;AAnBc,SALnB;AA0BD,OA5BD;AA6BD;;mBAED0H,6CAAiB1H,OAAO;AACtB,UAAIpC,KAAK,IAAT;AACAvB,cAAQiB,GAAR,CAAY,SAAZ,EAAuB0C,KAAvB;AACA,cAAQA,MAAM2H,UAAd;AACA,aAAK,CAAL;AACExH,sBAAYC,KAAZ,CACI,kEADJ,EAEI,IAFJ;AAIA;;AAEF,aAAK,GAAL;AACEC,uBAAaC,UAAb,CAAwB,aAAxB;AACA,iBAAO5D,IAAIC,WAAX;AACAiB,aAAGzB,OAAH,CAAWoE,OAAX,CAAmB,aAAnB;AACAJ,sBAAYC,KAAZ,CAAkB,qBAAlB,EAAyC,IAAzC;AACA;;AAEF,aAAK,GAAL;AACED,sBAAYC,KAAZ,CAAkB,wBAAlB,EAA4C,IAA5C;AACA;;AAEF;AACEJ,gBAAM4H,YAAN,KAAuB,MAAvB,GACMzH,YAAYC,KAAZ,CAAkBmH,KAAKM,SAAL,CAAe7H,MAAMsH,QAArB,CAAlB,EAAkD,IAAlD,CADN,GAEMnH,YAAYC,KAAZ,CAAkBJ,MAAMsH,QAAxB,EAAkC,IAAlC,CAFN;AAGA;AAvBF;AAyBD;;;;;;;;;;;UCtEaR,YAAAA;;;;;;;;;;AAAT,WAASA,SAAT,CAAmB3K,OAAnB,EAA4B;AACjCA,YAAQ2L,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYtB,KAAhB,EAAuB;AACrBvK,cAAQ2L,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYtB,OAAhB,EAAyB;AACvBxK,cAAQ2L,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAGD/L,YAAQgM,KAAR,GAAgBC,IAAhB,CAAqB,aAAK;AACxB,UAAIC,gBAAgBC,eAAe,KAAf,GAAuB,aAA3C;AACAC,QAAEhI,OAAF,CAAU8H,aAAV,EAAyBG,SAASC,IAAlC;AACD,KAHD;AAID;;AAED,WAASH,UAAT,GAAsB;;AAEpB,QAAIjI,aAAamG,OAAb,CAAqB,aAArB,CAAJ,EAAyC;AACvC,aAAO,IAAP;AACD,KAFD,MAEO;AACL,aAAO,KAAP;AACD;AACF;;;;;;;;;;;;;;;;;;MCtBYkC,iBAAAA,iBADZ;AAaC,oBAAYC,IAAZ,EAAkBvM,MAAlB,EAA0B;AAAA;;AAAA,WAP1BwM,OAO0B,GAPhB,EAOgB;AAAA,WAF1BC,KAE0B,GAFlB,EAEkB;;AACxB,WAAKF,IAAL,GAAYA,IAAZ;AACA,WAAKvM,MAAL,GAAcA,MAAd;AACA,WAAK0M,IAAL,GAAYpM,IAAIC,WAAhB;AACD;;qBAKDe,+BAAW;AAAA;;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,WAAX,EAAwB;AACpCC,yBAAiB,KADmB;;AAGpCC,kBAAU,kBAASC,KAAT,EAAgBC,GAAhB,EAAqB;AAC7B,cAAIxL,GAAGmL,MAAP,EAAe;AACbnL,eAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AACF,SAPmC;;AASpCC,qBAAa,qBAASL,KAAT,EAAgBC,GAAhB,EAAqB;AAChCxL,aAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AAXmC,OAAxB,CAAd;;AAeA,UACE,KAAKnN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,IACA,KAAKtN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,CAAsCC,EAFxC,EAGE;AACA,YAAIA,KAAK,KAAKvN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,CAAsCC,EAA/C;AACA,aAAKC,UAAL,CAAgBD,EAAhB,EAAoB,YAAM;AACxB,gBAAKE,OAAL,GAAe,KAAf;AACA,gBAAKC,QAAL;AACD,SAHD;AAID,OATD,MASO;AACL,aAAKA,QAAL;AACD;AACF;;qBAEDA,+BAAW;AACT,UAAIlM,KAAK,IAAT;;AAEAA,SAAGyL,UAAH;AAOD;;qBAMDO,iCAAWD,IAAII,UAAU;AAAA;;AACvB,WAAKpB,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,kBAAoCL,EAApC,EAA0CvB,IAA1C,CAA+C,eAAO;AACpD,YAAI6B,OAAOA,IAAIhK,IAAf,EAAqB;AACnB,iBAAK2I,OAAL,GAAeqB,IAAIhK,IAAJ,CAAS,CAAT,CAAf;AACA8J;AACD;AACF,OALD;AAMD;;qBAMDV,iCAAWa,MAAM;AAEf,UAAI1N,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACEC,wBAAgBC,MAAMC,QAAN,CAAezM,EAAE,WAAF,EAAe0M,IAAf,EAAf,CADlB;AAEElG,iBAAS,CACP;AACEiG,oBAAU,+CADZ;AAEE/H,iBAAO,MAFT;AAGE9F,iBAAO,YAHT;AAIE+N,iBAAO,GAJT;AAKEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AALd,SADO,EAYP;AACEnI,iBAAO,OADT;AAEE9F,iBAAO,YAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SAZO,EAqBP;AACEnI,iBAAO,cADT;AAEE9F,iBAAO,cAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SArBO,EA8BP;AACEnI,iBAAO,0BADT;AAEE9F,iBAAO,4BAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SA9BO,EAuCP;AACEnI,iBAAO,YADT;AAEE9F,iBAAO,eAFT;AAGE6N,oBAAU,gFAHZ;AAIEvI,sBAAY;AACViD,mBAAO,MADG;AAEV2F,sBAAU;AACRrO,oBAAM;AADE;AAFA;AAJd,SAvCO;AAFX,OAFW,EAwDXI,IAAIF,MAAJ,CAAWoF,IAxDA,CAAb;;AA4DA,UAAIlF,IAAIC,WAAJ,CAAgBiO,UAAhB,CAA2BC,OAA3B,CAAmC,CAAnC,IAAwC,CAAC,CAA7C,EAAgD;AAC9CrO,eAAOqF,OAAP,CAAeiJ,IAAf,CAAoB;AAClBR,oBAAU;AADQ,SAApB;AAGD;;AASD,UAAIJ,IAAJ,EAAU;AACR1N,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,EAAExI,OAAO,MAAT,EAAiBmI,UAAU,IAA3B,EAAiC9H,OAAOsH,IAAxC,EAA3B;AACD;;AAGD1N,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,QAA3D;;AAEA,UAAI,KAAK0H,OAAL,CAAaqC,GAAb,IAAoB,KAAKrC,OAAL,CAAasC,MAArC,EAA6C;AAC3C1O,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2BlN,EAAEsM,MAAF,CAAS3N,OAAO2F,UAAP,CAAkB4I,MAA3B,EAAmC;AAC5DxI,iBAAO,KADqD;AAE5DmI,oBAAU,IAFkD;AAG5D9H,iBAAO,KAAKgG,OAAL,CAAasC,MAAb,CAAoBC,IAApB,CAAyB,GAAzB;AAHqD,SAAnC,CAA3B;AAKD;;AAED,WAAKvJ,IAAL,GAAY/D,EAAE,YAAF,EAAgBuN,SAAhB,CAA0B5O,MAA1B,CAAZ;AACD;;qBAID6O,6DAA0B;AACxB,UAAIzN,KAAK,IAAT;AACA,UAAIoN,MAAM,KAAKpC,OAAL,CAAaqC,GAAb,0CAC+B,KAAKrC,OAAL,CAAaqC,GAD5C,GAEN,oCAFJ;;AAIA,WAAKK,wBAAL,GAAgC,IAAhC;AACA,WAAK3C,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,CAAqBgB,GAArB,EAA0B5C,IAA1B,CAA+B,eAAO;AACpCxK,WAAG2N,mBAAH,GAAyB,KAAzB;;AAEA3N,WAAG0N,wBAAH,GAA8B,KAA9B;AACA,YAAIrB,OAAOA,IAAIhK,IAAJ,CAASqE,MAAhB,IAA0B2F,IAAIhK,IAAJ,CAAS,CAAT,EAAYwF,qBAA1C,EAAiE;AAC/D,cAAI+F,eAAevB,IAAIhK,IAAJ,CAAS,CAAT,EAAYwF,qBAA/B;AACA7H,aAAGiL,KAAH,CAAS4C,iBAAT,GAA6B,iBAAU7N,GAAG6N,iBAAb,EAAgC;AAC3DjJ,kBAAM,KADqD;AAE3DvC,kBAAM;AACJyL,sBAAQ,CAAC,OAAD,EAAU,WAAV,EAAuB,UAAvB,CADJ;AAEJC,wBAAU,CACR;AACE1L,sBAAM,CACJuL,aAAaI,KADT,EAEJJ,aAAaK,UAFT,EAGJL,aAAaM,OAHT,CADR;AAMEC,iCAAiB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,CANnB;AAOEC,sCAAsB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC;AAPxB,eADQ;AAFN;AAFqD,WAAhC,CAA7B;AAiBD,SAnBD,MAmBO;AAELpO,aAAG2N,mBAAH,GAAyB,IAAzB;AACD;AACF,OA3BD;AA4BD;;qBAIDU,qDAAsB;AAAA;;AACpB,UAAIrO,KAAK,IAAT;AACA,UAAIoN,MAAM,KAAKpC,OAAL,CAAaqC,GAAb,sCAC2B,KAAKrC,OAAL,CAAaqC,GADxC,GAEN,gCAFJ;;AAIA,WAAKiB,oBAAL,GAA4B,IAA5B;AACA,WAAKvD,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,CAAqBgB,GAArB,EAA0B5C,IAA1B,CAA+B,eAAO;AAEpCxK,WAAGsO,oBAAH,GAA0B,KAA1B;AACA,YAAIjC,OAAOA,IAAIhK,IAAJ,CAASqE,MAAhB,IAA0B2F,IAAIhK,IAAJ,CAAS,CAAT,EAAYkM,iBAA1C,EAA6D;AAC3DvO,aAAGwO,eAAH,GAAqB,KAArB;AACA,cAAInM,OAAO,EAAX;AACA,cAAIoM,aAAa,EAAjB;AACA,cAAIF,oBAAoBlC,IAAIhK,IAAJ,CAAS,CAAT,EAAYkM,iBAApC;AACA,eAAK,IAAIG,MAAT,IAAmBH,iBAAnB,EAAsC;AACpClM,iBAAK6K,IAAL,CAAUqB,kBAAkBG,MAAlB,CAAV;AACAD,uBAAWvB,IAAX,CAAgBwB,MAAhB;AACD;;AAEDzO,YAAE,OAAK0O,aAAP,EAAsBC,UAAtB,CAAiC;AAC/B/P,mBAAO;AACLgQ,oBAAM;AADD,aADwB;AAI/BC,mBAAO,UAJwB;AAK/BC,oBAAQ;AACNC,wBAAU;AADJ,aALuB;AAQ/BC,4BAAgB;AACdrK,oBAAM;AADQ,aARe;AAW/BsK,0BAAc,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,CAXiB;AAY/BC,oBAAQ,CACN;AACE9P,oBAAM,YADR;AAEEgD,oBAAMA;AAFR,aADM,CAZuB;AAkB/B+M,uBAAW;AACTtB,sBAAQ;AACNuB,wBAAQ;AADF,eADC;AAITC,oBAAM;AACJC,yBAAS;AADL,eAJG;AAOTC,iCAAmB;AAPV,aAlBoB;AA2B/BC,0BAAc;AACZhB,0BAAYA,UADA;AAEZa,oBAAM;AACJC,yBAAS;AADL;;AAFM,aA3BiB;AAuC/BzN,qBAAS;AACPyN,uBAAS,IADF;AAEPF,sBAAQ,SAFD;AAGP3C,wBAAU;AAHH;AAvCsB,WAAjC;AA6CD,SAvDD,MAuDO;AAEL1M,aAAGwO,eAAH,GAAqB,IAArB;AACD;AACF,OA9DD;AA+DD;;;;;;;;;;;;;;;;;;;;;MCjSUkB,iBAAAA,iBADZ;AAEC,oBAAY3E,IAAZ,EAAkB;AAAA;;AAChB,WAAKA,IAAL,GAAYA,IAAZ;AACD;;qBAEDjL,+BAAW;AACThB,UAAI6Q,WAAJ,GAAkB,IAAlB;;AAEA,WAAKC,YAAL;AACD;;qBAKDA,uCAAe;AACb,UAAI5P,KAAK,IAAT;;AAGA,UAAIpB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACE9B,iBAAO,aADT;AAEE9F,iBAAO,OAFT;AAGE6N,oBAAU;AAHZ,SADO,EAMP,EAAE/H,OAAO,MAAT,EAAiB9F,OAAO,OAAxB,EANO,EAOP;AACE8F,iBAAO,aADT;AAEE9F,iBAAO,cAFT;AAGE6N,oBAAU;AAHZ,SAPO;AADX,OAFW,EAiBX5N,IAAIF,MAAJ,CAAWoF,IAjBA,CAAb;;AAqBApF,aAAO0H,SAAP,GAAmB,YAAW,CAE7B,CAFD;;AAKA,UAAIxH,IAAIC,WAAJ,CAAgBiO,UAAhB,CAA2BC,OAA3B,CAAmC,CAAnC,IAAwC,CAAC,CAA7C,EAAgD;AAC9CrO,eAAO6H,OAAP,CAAeyG,IAAf,CACE;AACE2C,mBAAS,EAAEhB,MAAM,OAAR,EAAiB/N,OAAOd,GAAG8P,gBAA3B,EADX;AAEEjR,iBAAO,SAFT;AAGE+N,iBAAO;AAHT,SADF;AAOD;;AAGDhO,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,QAA3D;;AAGA1E,aAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,EAAExI,OAAO,WAAT,EAAsBmI,UAAU,IAAhC,EAAsC9H,OAAO,IAA7C,EAA3B;;AAEA,WAAKhB,IAAL,GAAY/D,EAAE,SAAF,EAAauN,SAAb,CAAuB5O,MAAvB,CAAZ;AAGD;;qBAMDkR,6CAAiBzL,GAAG;AAClBA,QAAE0L,cAAF;;AAEA,UAAIC,WAAW,KAAKA,QAAL,CAAc/P,EAAEoE,EAAE4L,aAAJ,EAAmBC,OAAnB,CAA2B,IAA3B,CAAd,CAAf;;AAEAzD,YAAM0D,MAAN,CAAa,yBAAb,EAAwC,EAAxC,EAA4C3F,IAA5C,CACE,UAASnI,IAAT,EAAe;AACbpC,UAAEmQ,IAAF,CAAO;AACLC,kBAAQ,KADH;AAELjD,eAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,cAFpB;AAGLjB,gBAAM,EAAEgL,KAAK2C,SAAS3C,GAAhB,EAAqBiD,KAAKjO,IAA1B,EAAgCkO,OAAOP,SAASQ,MAAT,EAAvC,EAHD;AAILC,mBAAS,iBAASpE,GAAT,EAAc;AACrBI,kBAAMiE,KAAN,CAAY,2BAAZ;;AAEA5R,gBAAI6Q,WAAJ,CAAgBC,YAAhB;AACD,WARI;AASLxN,iBAAO,eAASuO,GAAT,EAAc;AACnB3Q,eAAG4P,YAAH;AACD;AAXI,SAAP;AAaD,OAfH,EAgBE,YAAW;AACTnD,cAAMiE,KAAN,CAAY,2BAAZ;AACD,OAlBH;AAoBD;;;;;;;;;;;;;;;;;;;;;MC9FUE,yBAAAA,yBADZ;AAEC,4BAAY7F,IAAZ,EAAkB;AAAA;;AAChB,WAAKA,IAAL,GAAYA,IAAZ;AAaD;;6BAEDjL,+BAAW;AACThB,UAAI6Q,WAAJ,GAAkB,IAAlB;;AAGA1P,QAAE,WAAF,EAAeyB,aAAf,CAA6B;AAC3BC,mBAAW;AACTC,gBAAM;AACJC,qBAAS;AADL;AADG;AADgB,OAA7B;;AASA,WAAKgP,WAAL;AACD;;6BAMDA,mCAAYvE,MAAM;AAEhB,UAAI1N,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACEC,wBAAgBC,MAAMC,QAAN,CAAezM,EAAE,WAAF,EAAe0M,IAAf,EAAf,CADlB;AAEElG,iBAAS,CACP;AACE9B,iBAAO,WADT;AAEE9F,iBAAO,YAFT;AAGE+N,iBAAO,GAHT;AAIEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAJd,SADO,EAWP;AACEnI,iBAAO,MADT;AAEE9F,iBAAO,MAFT;AAGE+N,iBAAO,GAHT;AAIEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAJd,SAXO,EAqBP;AACEnI,iBAAO,WADT;AAEE9F,iBAAO,YAFT;AAGE+N,iBAAO,GAHT;AAIEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAJd,SArBO,EA+BP;AACEnI,iBAAO,UADT;AAEE9F,iBAAO,WAFT;AAGE+N,iBAAO,GAHT;AAIEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAJd,SA/BO,EAyCP;AACEnI,iBAAO,SADT;AAEE9F,iBAAO,cAFT;AAGE+N,iBAAO,GAHT;AAIEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAJd,SAzCO,EAmDP;AACEnI,iBAAO,YADT;AAEE9F,iBAAO,eAFT;AAGE6N,oBAAU,+EAHZ;AAIEvI,sBAAY;AACViD,mBAAO,MADG;AAEV2F,sBAAU;AACRrO,oBAAM;AADE;AAFA;AAJd,SAnDO;AAFX,OAFW,EAoEXI,IAAIF,MAAJ,CAAWoF,IApEA,CAAb;;AAuEApF,aAAOqF,OAAP,CAAeiJ,IAAf,CAAoB;AAClBR,kBAAU;AADQ,OAApB;;AAWA,UAAIJ,IAAJ,EAAU;AACR1N,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,EAAExI,OAAO,MAAT,EAAiBmI,UAAU,IAA3B,EAAiC9H,OAAOsH,IAAxC,EAA3B;AACD;;AAGD1N,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,OAA3D;;AAEA,WAAKU,IAAL,GAAY/D,EAAE,WAAF,EAAeuN,SAAf,CAAyB5O,MAAzB,CAAZ;AACD;;;;;;;;;;;;;;;;;;;;;MCjIUkS,oBAAAA,oBADZ;AAGC,uBAAYtS,MAAZ,EAAoB;AAAA;;AAClB,WAAKA,MAAL,GAAcA,MAAd;AACD;;wBAKDsB,+BAAW;AACT,WAAKiR,qBAAL;AACD;;wBAKDA,yDAAwB;AACtB,UAAI/Q,KAAK,IAAT;;AAEAC,QAAE,mBAAF,EAAuB+Q,iBAAvB,CAAyC;AACvCC,uBAAe,MADwB;AAEvCC,oBAAY,KAF2B;AAGvC/D,gBAAQ,UAH+B;AAIvCgE,mBAAW,CAJ4B;AAKvCC,qBAAa,WAL0B;AAMvC7M,oBAAY;AACVK,gBAAM,OADI;AAEVwB,2BAAiB,IAFP;AAGVd,qBAAW;AACTC,kBAAM;AACJX,oBAAM,KADF;AAEJY,2BAAa,kBAFT;AAGJC,sBAAQ,mCAHJ;AAIJC,wBAAU,MAJN;AAKJC,yBAAW,EAAEC,iBAAiB,IAAnB,EALP;AAMJwH,mBAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB;AANrB;AADG;AAHD,SAN2B;AAoBvCoJ,kBAAU,0JApB6B;AAqBvC2E,gBAAQ,gBAAShN,CAAT,EAAY;AAElB,cAAIA,EAAE2L,QAAF,CAAWsB,UAAf,EAA2B;AACzB7S,oBAAQiB,GAAR,CAAY2E,EAAE2L,QAAF,CAAWsB,UAAvB;AACA,oBAAQjN,EAAE2L,QAAF,CAAWsB,UAAnB;AACA,mBAAK,OAAL;AACEtR,mBAAGxB,MAAH,CAAU+S,eAAV,CAA0B,eAA1B,EAA2C,EAACxF,IAAI1H,EAAE2L,QAAF,CAAW3C,GAAhB,EAA3C;AACA;AACF,mBAAK,SAAL;AACErN,mBAAGxB,MAAH,CAAU+S,eAAV,CAA0B,gBAA1B,EAA4C,EAACxF,IAAI1H,EAAE2L,QAAF,CAAW3C,GAAhB,EAA5C;AACA;AACF;AAEE;AATF;AAWD;AACF;AArCsC,OAAzC;AAuCD;;wBAGDmE,+CAAmB;AACjB/S,cAAQiB,GAAR,CAAYkL,QAAZ;AACA,UAAKA,SAAS6G,iBAAT,IAA8B7G,SAAS6G,iBAAT,KAA+B,IAA9D,IACK,CAAC7G,SAAS8G,aAAV,IAA2B,CAAC9G,SAAS+G,kBAD9C,EACmE;AACjE,YAAI/G,SAASgH,eAAT,CAAyBC,iBAA7B,EAAgD;AAC9CjH,mBAASgH,eAAT,CAAyBC,iBAAzB;AACD,SAFD,MAEO,IAAIjH,SAASgH,eAAT,CAAyBE,oBAA7B,EAAmD;AACxDlH,mBAASgH,eAAT,CAAyBE,oBAAzB;AACD,SAFM,MAEA,IAAIlH,SAASgH,eAAT,CAAyBG,uBAA7B,EAAsD;AAC3DnH,mBAASgH,eAAT,CAAyBG,uBAAzB;AACD;AACF,OATD,MASO;AACL,YAAInH,SAASoH,gBAAb,EAA+B;AAC7BpH,mBAASoH,gBAAT;AACD,SAFD,MAEO,IAAIpH,SAASqH,mBAAb,EAAkC;AACvCrH,mBAASqH,mBAAT;AACD,SAFM,MAEA,IAAIrH,SAASsH,sBAAb,EAAqC;AAC1CtH,mBAASsH,sBAAT;AACD;AACF;AACF;;;;;;;;;;;;;;;;;;;;;MChFUC,oBAAAA,oBADZ;AAMC,uBAAY5T,OAAZ,EAAqBwM,IAArB,EAA2B;AAAA;;AAAA,WAJ3BkB,OAI2B,GAJjB,IAIiB;AAAA,WAH3Bf,IAG2B,GAHpB,EAGoB;AAAA,WAF3BkH,WAE2B,GAFb,CAEa;;AACzB,UAAIpS,KAAK,IAAT;AACA,WAAKzB,OAAL,GAAeA,OAAf;AACA,WAAKwM,IAAL,GAAYA,IAAZ;AAUD;;wBAKDjL,+BAAW;AACTrB,cAAQC,IAAR,CAAa,iBAAb;AACA,UAAI2T,WAAW5P,aAAamG,OAAb,CAAqB,aAArB,CAAf;;AAEA,UAAI,CAACyJ,QAAL,EAAe;AACb,aAAK9T,OAAL,CAAaoE,OAAb,CAAqB,aAArB;AACD,OAFD,MAEO;AACL7D,YAAIC,WAAJ,GAAkB,KAAKmM,IAAL,GAAYvB,KAAKC,KAAL,CAAWyI,QAAX,CAA9B;AACD;AACD,WAAKpG,OAAL,GAAe,KAAf;;AAIAhM,QAAE,gBAAF,EAAoBqS,WAApB,CAAgC;AAC9B1F,eAAO,QADuB;AAE9B/N,eAAO,iBAFuB;AAG9B0T,kBAAU,IAHoB;AAI9BC,eAAO,IAJuB;AAK9BC;AAL8B,OAAhC;;AAUAxS,QAAE,KAAKyS,aAAP,EAAsBrQ,IAAtB,CAA2B,aAA3B,KACEpC,EAAE,KAAKyS,aAAP,EAAsBrQ,IAAtB,CAA2B,aAA3B,EAA0CsQ,KAA1C,EADF;AAED;;wBAKDC,2CAAiB;AACf,UAAI5S,KAAK,IAAT;AACA,WAAK+K,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,CAAqB,cAArB,EAAqC5B,IAArC,CAA0C,eAAO;AAC/C,YAAI6B,GAAJ,EAAS;AACPrM,aAAGoS,WAAH,GAAiB/F,IAAIhK,IAArB;AACD;AACF,OAJD;AAKD;;wBAKDwQ,2BAAS;AAAA;;AACPpU,cAAQC,IAAR,CAAa,aAAb;;AAEA,WAAKqM,IAAL,CAAU9B,MAAV,CAAiB6J,IAAjB,CAAsB,cAAtB,EAAsC,KAAKrO,KAA3C,EAAkD+F,IAAlD,CAAuD,eAAO;AAC5D,cAAKyB,OAAL,GAAe,KAAf;AACA,YAAII,GAAJ,EAAS;AACP5J,uBAAaC,UAAb,CAAwB,aAAxB;AACA,iBAAO5D,IAAIC,WAAX;AACA,gBAAKR,OAAL,CAAaoE,OAAb,CAAqB,aAArB;AACD;AACF,OAPD;AAQD;;wBAKDoQ,iDAAoB;AAClB9S,QAAE,KAAKyS,aAAP,EAAsBrQ,IAAtB,CAA2B,aAA3B,KACEpC,EAAE,KAAKyS,aAAP,EAAsBrQ,IAAtB,CAA2B,aAA3B,EAA0CT,IAA1C,EADF;AAED;;wBAEDoR,mCAAa;AACXvU,cAAQiB,GAAR,CAAY,mBAAZ;;AAEAuT,oBAAc,KAAKC,gBAAnB;AACD;;;;;;;;;;;;;;;;;;QC/FUC,oBAAAA,YACT,qBAAc;AAAA;AAAG;;;;;;;;;;;;;;;;;;MCGRC,2BAAAA,2BADZ;AASC,8BAAY7U,OAAZ,EAAqBwM,IAArB,EAA2B;AAAA;;AAAA,WAN3BjM,GAM2B,GANrBA,GAMqB;AAAA,WAH3BuU,MAG2B,GAHlB,EAGkB;AAAA,WAF3BC,aAE2B,GAFX,EAEW;;AACzB,WAAK/U,OAAL,GAAeA,OAAf;AACA,WAAKwM,IAAL,GAAYA,IAAZ;AACA,WAAKjM,GAAL,GAAWA,GAAX;AACD;;+BACDgB,+BAAW;AAAA;;AACTrB,cAAQiB,GAAR,CAAY,kBAAZ;;AAEAO,QAAE,mBAAF,EAAuBC,OAAvB,CAA+B;AAC7BgD,cAAM,MADuB,EAA/B;;AAKAjD,QAAE,gBAAF,EAAoBC,OAApB,CAA4B;AAC1BiD,mBAAW,GADe;AAE1BD,cAAM;AAFoB,OAA5B;AAIAjD,QAAE,sBAAF,EAA0Ba,KAA1B,CAAgC,YAAW;AACzCb,UAAE,gBAAF,EAAoBC,OAApB,CAA4B,MAA5B;AACD,OAFD;AAGAD,QAAE,mBAAF,EAAuBY,WAAvB,CAAmC;AACjCE,mBAAW,KADsB,EAAnC;;AAKAd,QAAE,QAAF,EAAYe,GAAZ,CAAgB,WAAhB,EAA6BC,eAA7B;AACA,UAAIC,UAAUjB,EAAE,cAAF,EAAkBkB,MAAlB,EAAd;AACA,UAAIC,gBAAgBC,OAAOC,WAAP,GAAqBJ,OAAzC;AACAjB,QAAE,sBAAF,EAA0BkB,MAA1B,CAAiCC,aAAjC,EAAgDG,gBAAhD,CAAiE;AAC/DC,yBAAiB;AAD8C,OAAjE;AAGA,UAAIC,YAAYxB,EAAE,WAAF,EAAekB,MAAf,EAAhB;AACAlB,QAAE,uBAAF,EAA2BkB,MAA3B,CAAkCM,SAAlC,EAA6CF,gBAA7C,CAA8D;AAC5DC,yBAAiB;AAD2C,OAA9D;;AAIA,WAAK+R,gBAAL;;AAGAC,kBAAY,YAAM;AAChB,cAAKD,gBAAL;AACD,OAFD,EAEG,KAFH;AAGD;;+BAKDA,+CAAmB;AAAA;;AAEjB,WAAKF,MAAL,GAAc,EAAd;AACA,WAAKC,aAAL,GAAqB,EAArB;AACA,UAAIxU,IAAIC,WAAJ,IAAmBD,IAAIC,WAAJ,CAAgBsO,GAAvC,EAA4C;AAC1C,aAAKtC,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,0BAA4CtN,IAAIC,WAAJ,CAAgBsO,GAA5D,EAAmE7C,IAAnE,CAAwE,eAAO;AAC7E,cAAI6B,GAAJ,EAAS;AACP,gBAAIoH,QAAQpH,IAAIhK,IAAJ,CAASqR,iBAArB;;AAEA,iBAAK,IAAIlN,IAAI,CAAb,EAAgBA,IAAIiN,MAAM/M,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,kBAAIiN,MAAMjN,CAAN,EAAS8K,UAAb,EAAyB;AACvB,wBAAQmC,MAAMjN,CAAN,EAAS8K,UAAjB;AACA,uBAAK,OAAL;AACE,2BAAK+B,MAAL,CAAYnG,IAAZ,CAAiBuG,MAAMjN,CAAN,CAAjB;AACA;AACF;AAEE;AANF;AAQD;AACF;AACF;AACF,SAjBD;AAkBD;AACF;;+BAMDmN,mDAAoB5H,IAAI;AACtB,UAAI/L,KAAK,IAAT;AACA,UAAIlB,IAAIC,WAAJ,IAAmBD,IAAIC,WAAJ,CAAgBsO,GAAvC,EAA4C;AAC1C,aAAKtC,IAAL,CAAU9B,MAAV,CAAiB6J,IAAjB,kCAAqDhU,IAAIC,WAAJ,CAAgBsO,GAArE,EAA4E;AAC1EtB,cAAIA;AADsE,SAA5E,EAEGvB,IAFH,CAEQ,eAAO;AACb,cAAI6B,OAAOA,IAAI7C,OAAf,EAAwB;AACtBjH,wBAAYC,KAAZ,CAAkB6J,IAAI7C,OAAtB,EAA+B,IAA/B;AACD;AACDxJ,aAAGuT,gBAAH;AACD,SAPD;AAQD;AACF;;;;;;;;;;;;;;;;;;;;;MChGUK,qBAAAA,qBADZ;AAeC,wBAAY7I,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAAA,WAb9B5H,OAa8B,GAbpB,IAaoB;AAAA,WAV9BxH,KAU8B,GAVtB;AACNlB,kBAAUzE,IAAIF,MAAJ,CAAW2E;AADf,OAUsB;AAAA,WAL9BuQ,MAK8B,GALrB,KAKqB;;AAC5B,WAAK7K,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK8K,QAAL,GAAgBF,UAAhB;AACD;;yBAMDvU,6BAASwM,QAAQ;AAAA;;AACf,UAAIA,OAAOC,EAAX,EAAe;AAEb,aAAK+H,MAAL,GAAc,IAAd;AACA,aAAK7K,MAAL,CAAYmD,GAAZ,gBAA6BN,OAAOC,EAApC,EAA0CvB,IAA1C,CAA+C,eAAO;AACpD,gBAAKyB,OAAL,GAAe,KAAf;AACA,cAAII,OAAOA,IAAIhK,IAAf,EAAqB;AAEnB,kBAAKoC,KAAL,GAAaxE,EAAEsM,MAAF,CAAS,IAAT,EAAe,MAAK9H,KAApB,EAA2B4H,IAAIhK,IAAJ,CAAS,CAAT,CAA3B,CAAb;;AAEA,kBAAK8I,MAAL,CAAY6I,GAAZ,CAAgB,MAAKvP,KAAL,CAAW6H,IAA3B;;AAEA,gBAAI,MAAK7H,KAAL,CAAWkD,kBAAf,EAAmC;AACjC1H,gBAAE,MAAK0H,kBAAP,EACGtF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWkD,kBAFpB;AAGD;AACD,gBAAI,MAAKlD,KAAL,CAAWoD,qBAAf,EAAsC;AACpC5H,gBAAE,MAAK4H,qBAAP,EACGxF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWoD,qBAFpB;AAGD;AACD,gBAAI,MAAKpD,KAAL,CAAWnC,MAAf,EAAuB;AACrBrC,gBAAE,MAAKqC,MAAP,EAAeD,IAAf,CAAoB,mBAApB,EAAyC2C,KAAzC,CAA+C,MAAKP,KAAL,CAAWnC,MAA1D;AACD;AACD,gBAAI,MAAKmC,KAAL,CAAWwP,aAAf,EAA8B;AAC5BhU,gBAAE,MAAKgU,aAAP,EACG5R,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWwP,aAFpB;AAGD;AACF;AACF,SA3BD;AA4BD,OA/BD,MA+BO;AACL,aAAKhI,OAAL,GAAe,KAAf;AACD;AACF;;yBAKDnM,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,YAAX,EAAyB;AACrCC,yBAAiB;AADoB,OAAzB,CAAd;;AAKApL,QAAE,KAAK0H,kBAAP,EAA2BuM,iBAA3B,CAA6C;AAC3C3P,oBAAYzF,IAAIF,MAAJ,CAAW+I,kBADoB;;AAG3CwM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASkD,kBAAT,GAA8B,KAAK3C,KAAL,EAA9B;AACD;AAN0C,OAA7C;;AASA/E,QAAE,KAAK4H,qBAAP,EAA8BqM,iBAA9B,CAAgD;AAC9C3P,oBAAYzF,IAAIF,MAAJ,CAAWiJ,qBADuB;;AAG9CsM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASoD,qBAAT,GAAiC,KAAK7C,KAAL,EAAjC;AACD;AAN6C,OAAhD;;AASA/E,QAAE,KAAKqC,MAAP,EAAe4R,iBAAf,CAAiC;AAC/B3P,oBAAYzF,IAAIF,MAAJ,CAAWgJ,eADQ;;AAG/BuM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASnC,MAAT,GAAkB,KAAK0C,KAAL,EAAlB;AACD;AAN8B,OAAjC;;AASA/E,QAAE,KAAKgU,aAAP,EAAsBC,iBAAtB,CAAwC;AACtC3P,oBAAYzF,IAAIF,MAAJ,CAAWqV,aADe;;AAGtCE,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASwP,aAAT,GAAyB,KAAKjP,KAAL,EAAzB;AACD;AANqC,OAAxC;AAQD;;yBAMDoP,6CAAiBC,QAAQ;AACvB5V,cAAQiB,GAAR,CAAY,kBAAZ;AACA,UAAI2U,UAAUA,OAAO,CAAP,CAAd,EAAyB;AACvB,YAAIC,QAAQD,OAAO,CAAP,CAAZ;AACA,YAAIE,iBAAJ;;AAEA,gBAAQD,MAAM1P,IAAd;AACA,eAAK,WAAL;AACE2P,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF,eAAK,YAAL;AACEkH,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF;AACE9K,wBAAYC,KAAZ,CAAkB,mCAAlB,EAAuD,IAAvD;AACA;AAXF;AAaA,YAAI+R,YAAY,KAAK9P,KAAL,CAAW4I,GAA3B,EAAgC;AAC9B,cAAIrN,KAAK,IAAT;;AAEA,cAAIwU,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,QAAhB,EAA0BJ,KAA1B,EAAiCC,QAAjC;AACAC,mBAASE,MAAT,CAAgB,KAAhB,EAAuB,KAAKjQ,KAAL,CAAW4I,GAAlC;;AAIA,eAAK0G,QAAL,CACGY,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,cAD7B,EAC6C;AACzC+M,oBAAQ,MADiC;AAEzCxF,kBAAM2J;AAFmC,WAD7C,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ,gBAAInI,IAAJ,EAAU;AACRE,0BAAYC,KAAZ,CAAkB,oCAAlB,EAAwD,IAAxD;AACD;AACF,WAVH,EAWGqS,KAXH,CAWS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAXT;AAYD;AACF,OAvCD,MAuCO;AACLjH,oBAAYC,KAAZ,CAAkB,yBAAlB,EAA6C,IAA7C;AACD;AACF;;yBAKDsS,2BAAS;AAAA;;AACP,WAAK7I,OAAL,GAAe,IAAf;;AAGA,UAAI,KAAKd,MAAT,EAAiB;AACf,aAAK1G,KAAL,CAAW6H,IAAX,GAAkB,KAAKnB,MAAL,CAAYO,OAAZ,GAAsBC,MAAxC;AACD;;AAED,UAAI,KAAKmI,MAAT,EAAiB;AAEf,aAAK7K,MAAL,CAAY8L,GAAZ,gBAA6B,KAAKtQ,KAAL,CAAW4I,GAAxC,EAA+C,KAAK5I,KAApD,EAA2D+F,IAA3D,CAAgE,gBAAQ;AACtE,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD,OAVD,MAUO;AAEL,aAAKhM,MAAL,CAAY6J,IAAZ,CAAiB,SAAjB,EAA4B,KAAKrO,KAAjC,EAAwC+F,IAAxC,CAA6C,gBAAQ;AACnD,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD;AACF;;yBAKDC,4BAAS;AAAA;;AAEP,WAAKjM,MAAL,CAAYiM,MAAZ,gBAAgC,KAAKzQ,KAAL,CAAW4I,GAA3C,EAAkD7C,IAAlD,CAAuD,gBAAQ;AAC7D,eAAKyB,OAAL,GAAe,KAAf;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,iBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,OAPD;AAQD;;;;;;;;;;;;;;;;;;;;;MC5MUE,uBAAAA,uBADZ;AA6CC,0BAAYpK,IAAZ,EAAkB;AAAA;;AAAA,WA3ClBkB,OA2CkB,GA3CR,IA2CQ;AAAA,WAzClBxH,KAyCkB,GAzCV,EAyCU;AAAA,WAjClB2Q,UAiCkB,GAjCL;AACXC,yBAAiB,KADN;AAEXC,qBAAa,IAFF;AAGXC,iBAAS,IAHE;AAIXC,kBAAU,KAJC;AAKXC,qBAAa;AALF,OAiCK;AAAA,WAzBlBC,OAyBkB,GAzBR,EAyBQ;AAAA,WAnBlBC,KAmBkB,GAnBV;AACNC,kBAAU;AACRC,8BAAoB,KADZ;AAERC,+BAAqB;AAFb,SADJ;AAKND,4BAAoB,WALd;AAMNC,6BAAqB,QANf;AAONzT,cAAM;AACJwT,8BAAoB;AAClBE,mBAAO,WADW;AAElBC,kBAAM;AAFY,WADhB;AAKJF,+BAAqB;AACnBC,mBAAO,QADY;AAEnBC,kBAAM;AAFa;AALjB;AAPA,OAmBU;AAAA,WAysBlBC,QAzsBkB,GAysBP;AACTC,yBAAiB;AACf5T,kBAAQ,IADO;AAEf6T,qBAAW;AAFI,SADR;AAKTC,cAAM;AACJD,qBAAW;AADP;AALG,OAzsBO;;AAChBrX,UAAI6Q,WAAJ,GAAkB,IAAlB;AACA,WAAK5E,IAAL,GAAYA,IAAZ;AACD;;2BAEDzL,6BAASwM,QAAQ;AAAA;;AACf,UAAIA,UAAUA,OAAOC,EAArB,EAAyB;AACvB,aAAKsK,QAAL,CAAcvK,OAAOC,EAArB,EAAyB,YAAM;AAC7B,gBAAKE,OAAL,GAAe,KAAf;AACA,gBAAKC,QAAL;AACD,SAHD;AAID;AACF;;2BAEDpM,+BAAW;AAETG,QAAE,WAAF,EAAeyB,aAAf,CAA6B;AAC3BC,mBAAW;AACTC,gBAAM;AACJC,qBAAS;AADL;AADG;AADgB,OAA7B;;AASA5B,QAAE,cAAF,EAAkBY,WAAlB;;AAGA,WAAKyV,kBAAL;AACD;;2BAMDD,6BAAStK,IAAII,UAAU;AAAA;;AACrB,WAAKpB,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,gBAAkCL,EAAlC,EAAwCvB,IAAxC,CAA6C,eAAO;AAClD,YAAI6B,OAAOA,IAAIhK,IAAf,EAAqB;AACnB,iBAAKoC,KAAL,GAAa4H,IAAIhK,IAAJ,CAAS,CAAT,CAAb;AACA8J;AACD;AACF,OALD;AAMD;;2BAEDD,+BAAW;AAAA;;AACT,UAAIlM,KAAK,IAAT;;AAEA,WAAKuW,UAAL;AACA,WAAKC,oBAAL;;AAKA,WAAKC,OAAL,CAAa,YAAM;AAEjBlQ,mBAAY,YAAM;AAChBmQ,iBAAOC,IAAP,CAAYpL,KAAZ,CAAkBtG,OAAlB,CAA0BjF,GAAG4W,SAA7B,EAAwC,QAAxC;AACD,SAFD,EAEG,GAFH;;AAIA,eAAKC,iBAAL,CAAuB,YAAM,CAAG,CAAhC;AACD,OAPD;AAQD;;2BAMDJ,2BAAQtK,UAAU;AAChB1N,cAAQiB,GAAR,CAAY,SAAZ;;AAGA,WAAKoX,YAAL,GAAoB,IAAIJ,OAAOC,IAAP,CAAYI,YAAhB,EAApB;;AAEA,WAAKH,SAAL,GAAiB,IAAIF,OAAOC,IAAP,CAAYK,GAAhB,CACfpM,SAASqM,cAAT,CAAwB,kBAAxB,CADe,EAEf;AACEC,cAAM,CADR;AAEEC,gBAAQ,EAAEC,KAAK,EAAP,EAAWC,KAAK,EAAhB,EAFV;;AAIEC,mBAAW,WAJb;AAKEC,wBAAgB,IALlB;AAMEC,qBAAa,IANf;AAOEC,mBAAW,IAPb;AAQEC,+BAAuB;AACrBC,iBAAOjB,OAAOC,IAAP,CAAYiB,mBAAZ,CAAgCC;AADlB,SARzB;AAWEC,2BAAmB,KAXrB;AAYEC,kCAA0B;AACxBJ,iBAAOjB,OAAOC,IAAP,CAAYqB,sBAAZ,CAAmCC;AADlB;AAZ5B,OAFe,CAAjB;;AAqBA,WAAKC,YAAL,CAAkB,KAAKtB,SAAvB;;AAEAzK;AACD;;2BAKD+L,qCAAahZ,KAAK;AAChB,UAAI6P,SAAS,KAAKA,MAAlB;AACAA,aAAOoJ,SAAP;AAaAjZ,UAAI0W,QAAJ,CAAac,OAAOC,IAAP,CAAYyB,eAAZ,CAA4BC,SAAzC,EAAoDnL,IAApD,CAAyD6B,MAAzD;AACD;;2BAMD8H,+CAAkB1K,UAAU;AAC1B,UAAInM,KAAK,IAAT;AACA,UAAI,KAAKsY,aAAT,EAAwB;AACtB,aAAKC,aAAL;AACD;;AAED,WAAK7C,OAAL,GAAe,EAAf;;AAEA,WAAK3K,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,uBAAyC,KAAK3H,KAAL,CAAW4I,GAApD,EAA2D7C,IAA3D,CAAgE,eAAO;AACrE,YAAI6B,GAAJ,EAAS;AAAA,qCACE7F,CADF;AAEL,gBAAIgS,aAAanM,IAAIhK,IAAJ,CAASmE,CAAT,CAAjB;AACA,gBAAIiS,aAAa,IAAI/B,OAAOC,IAAP,CAAY+B,UAAhB,CAA2B;AAC1CjG,kuBAe8D+F,WAAWG,MAAX,CAAkBtL,GAfhF,WAewFmL,WAAWG,MAAX,CAAkBtZ,IAf1G,6OAmBsCmZ,WAAWG,MAAX,CAAkBrW,MAAlB,IAA4B,GAnBlE,6OAuBsCkW,WAAWI,SAvBjD,2OA2BsC9Z,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgByJ,QAAhB,CAAyBN,WAAW1S,SAApC,EAA+ChH,IAAIC,WAAJ,CAAgBuJ,cAA/D,CA3BtC,0OA+BsCkQ,WAAWO,QA/BjD,UA+B8DP,WAAWQ,SA/BzE,ifAyCsCR,WAAWhV,YAAX,IAA2B,GAzCjE,qPA6CsCgV,WAAWS,eAAX,IAA8B,GA7CpE,kPAiDsCT,WAAWU,kBAAX,IAAiC,GAjDvE,uPAqDsCpa,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqBX,WAAWY,wBAAhC,EAA0D,aAA1D,KAA4E,GArDlH,gPAyDsCta,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqBX,WAAWa,WAAhC,EAA6C,UAA7C,KAA4D,GAzDlG;AAD0C,aAA3B,CAAjB;;AAoEA,gBAAIC,UAAU,+BAAd;AACA,gBACEd,WAAWG,MAAX,CAAkBrW,MAAlB,IAA4BkW,WAAWG,MAAX,CAAkBrW,MAAlB,KAA6B,UAD3D,EAEE;AACA,sBAAQkW,WAAWG,MAAX,CAAkBrW,MAA1B;AACA,qBAAK,aAAL;AACEgX,4BAAU,mCAAV;AACA;;AAEF,qBAAK,gBAAL;AACEA,4BAAU,sCAAV;AACA;;AAEF;AAEE;AAXF;AAaD,aAhBD,MAgBO;AACL,kBAAId,WAAWG,MAAX,IAAqBH,WAAWG,MAAX,CAAkBpV,QAAlB,CAA2BC,YAApD,EAAkE;AAChE,wBAAQgV,WAAWG,MAAX,CAAkBpV,QAAlB,CAA2BC,YAA3B,CAAwCwB,KAAhD;AACA,uBAAK,IAAL;AACEsU,8BAAU,0BAAV;AACA;;AAEF,uBAAK,KAAL;AACEA,8BAAU,2BAAV;AACA;;AAEF;AAEE;AAXF;AAaD;AACF;;AAGD,gBAAIC,SAAS,IAAI7C,OAAOC,IAAP,CAAY6C,MAAhB,CAAuB;AAClCxK,wBAAU;AACRoI,qBAAKqC,WAAWjB,WAAWO,QAAtB,CADG;AAER1B,qBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFG,eADwB;AAKlCna,qBAAO2Z,WAAWkB,SALgB;AAMlCC,oBAAML,OAN4B;AAOlCpa,mBAAKc,GAAG4W,SAP0B;AAQlC7K,kBAAIyM,WAAWnL;AARmB,aAAvB,CAAb;;AAYAkM,mBAAOK,WAAP,CAAmB,OAAnB,EAA4B,YAAW;AACrCnB,yBAAW7W,IAAX,CAAgB5B,GAAG4W,SAAnB,EAA8B2C,MAA9B;AACD,aAFD;;AAIA7C,mBAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BnB,UAA9B,EAA0C,UAA1C,EAAsD,UAASpU,CAAT,EAAY;AAEhEpE,gBAAE,eAAF,EAAmByB,aAAnB,CAAiC;AAC/BC,2BAAW;AACTC,wBAAM;AACJC,6BAAS;AADL;AADG;AADoB,eAAjC;;AAQA,kBAAIgY,UAAU5Z,EAAE,cAAF,CAAd;AACA,kBAAI6Z,eAAeD,QAAQE,IAAR,EAAnB;;AAEAD,2BAAaE,QAAb,CAAsB,eAAtB,EAAuCC,GAAvC,CAA2C,EAAEC,SAAS,MAAX,EAA3C;;AAEAJ,2BAAaE,QAAb,CAAsB,eAAtB,EAAuCC,GAAvC,CAA2C,EAAEC,SAAS,MAAX,EAA3C;AACD,aAhBD;;AAmBAla,eAAG0V,OAAH,CAAWxI,IAAX,CAAgBqM,MAAhB;;AAGAvZ,eAAG8W,YAAH,CAAgBvK,MAAhB,CAAuB;AACrB6K,mBAAKqC,WAAWjB,WAAWO,QAAtB,CADgB;AAErB1B,mBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFgB,aAAvB;AAjJK;;AACP,eAAK,IAAIxS,IAAI,CAAb,EAAgBA,IAAI6F,IAAIhK,IAAJ,CAASqE,MAA7B,EAAqCF,GAArC,EAA0C;AAAA,kBAAjCA,CAAiC;AAoJzC;;AAGD,cAAIxG,GAAGoV,UAAH,CAAcG,OAAlB,EAA2B;AACzBvV,eAAGuV,OAAH;AACD;;AAGD,cAAIvV,GAAGoV,UAAH,CAAcK,WAAlB,EAA+B;AAC7BzV,eAAGma,WAAH;AACD;;AAGDhO,sBAAYA,UAAZ;AACD;AACF,OArKD;AAsKD;;2BAKDoJ,6BAAU;AACR,UAAI6E,MAAM,KAAK1E,OAAL,CAAahP,MAAvB;AACA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAI4T,GAApB,EAAyB5T,GAAzB,EAA8B;AAE5B,aAAKkP,OAAL,CAAalP,CAAb,EAAgBtH,GAAhB,IAAuB,KAAK4X,YAAL,CAAkBvK,MAAlB,CAAyB,KAAKmJ,OAAL,CAAalP,CAAb,EAAgBwI,QAAzC,CAAvB;AACD;;AAED,WAAK4H,SAAL,CAAeyD,SAAf,CAAyB,KAAKvD,YAA9B;AACD;;2BAKDqD,qCAAc;AACZ,WAAKG,eAAL,GAAuB,IAAIC,eAAJ,CAAoB,KAAK3D,SAAzB,EAAoC,KAAKlB,OAAzC,EAAkD;AACvE8E,mBAAW;AAD4D,OAAlD,CAAvB;AAGD;;2BAEDC,qCAAc;AACZ,UAAIC,MAAM9P,SAASqM,cAAT,CAAwB,SAAxB,CAAV;AACA,WAAK0D,QAAL,GAAgB,iBAAUD,GAAV,EAAe;AAC7B9V,cAAM,KADuB;AAE7BvC,cAAM;AACJyL,kBAAQ,CAAC,KAAD,EAAQ,MAAR,EAAgB,QAAhB,CADJ;AAEJC,oBAAU,CACR;AACE1L,kBAAM,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,CADR;AAEE8L,6BAAiB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,CAFnB;AAGEC,kCAAsB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB;AAHxB,WADQ;AAFN;;AAFuB,OAAf,CAAhB;AAeD;;2BAEDmI,mCAAa;AACX,UAAIqE,SAAShQ,SAASqM,cAAT,CAAwB,iBAAxB,CAAb;AACA,UAAI5U,OAAO;AACTyL,gBAAQ,EADC;AAETC,kBAAU,CACR;AACE8M,iBAAO,qBADT;AAEEC,gBAAM,IAFR;AAGEC,qBAAW,MAHb;AAIEC,yBAAe,MAJjB;AAKEC,uBAAa,GALf;AAMEC,4BAAkB,oBANpB;AAOEC,gCAAsB,MAPxB;AAQEC,4BAAkB,CARpB;AASEC,4BAAkB,CATpB;AAUEC,qCAA2B,oBAV7B;AAWEC,iCAAuB,qBAXzB;AAYEC,iCAAuB,CAZzB;AAaEC,uBAAa,CAbf;AAcEC,0BAAgB,EAdlB;AAeErZ,gBAAM;AAfR,SADQ;AAFD,OAAX;;AAuBA,eAASsZ,OAAT,GAAmB;AACjBC,oBAAYvZ,IAAZ,CAAiB0L,QAAjB,CAA0B,CAA1B,EAA6B1L,IAA7B,CAAkC6K,IAAlC,CACE2O,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,EAA3B,IAAiC,EADnC;AAGAH,oBAAYvZ,IAAZ,CAAiByL,MAAjB,CAAwBZ,IAAxB,CACE8O,OAAO,IAAIC,IAAJ,EAAP,EAAmB5M,MAAnB,CAA0B,qBAA1B,CADF;AAGAuM,oBAAY9H,MAAZ;AACD;;AAED,UAAIoI,SAAS;AACXC,mBAAW,IADA;AAEXpN,gBAAQ,EAAEjB,QAAQ,EAAEsO,WAAW,OAAb,EAAV,EAFG;AAGXC,gBAAQ;AACNC,iBAAO,CACL;AACEC,mBAAO;AACLH,yBAAW,OADN;AAELI,2BAAa;AAFR;AADT,WADK,CADD;AASNC,iBAAO,CACL;AACEF,mBAAO;AACLH,yBAAW;AADN;AADT,WADK;AATD;AAHG,OAAb;AAqBA,UAAIR,cAAc,aAAMc,IAAN,CAAW9B,MAAX,EAAmB;AACnCvY,cAAMA,IAD6B;AAEnCJ,iBAASia;AAF0B,OAAnB,CAAlB;;AAKA1I,kBAAY,YAAM;AAChBmI;AACD,OAFD,EAEG,KAFH;AAGD;;2BAKDgB,uCAAe;AACb,UAAI3c,KAAK,IAAT;;AAEA,UAAIpB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACEpL,gBAAQ,GADV;AAEEsF,iBAAS,CACP;AACE9B,iBAAO,WADT;AAEE9F,iBAAO,YAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SADO,EAUP;AACEnI,iBAAO,WADT;AAEE9F,iBAAO,YAFT;AAGE6N,oBAAU,qFAHZ;AAIEvI,sBAAY;AACViD,mBAAO,MADG;AAEV2F,sBAAU;AACRrO,oBAAM;AADE;AAFA;AAJd,SAVO,EAqBP;AACEiG,iBAAO,aADT;AAEE9F,iBAAO,cAFT;AAGE6N,oBAAU,uFAHZ;AAIEvI,sBAAY;AACViD,mBAAO,MADG;AAEV2F,sBAAU;AACRrO,oBAAM;AADE;AAFA;AAJd,SArBO,EAiCP;AACEiG,iBAAO,UADT;AAEE9F,iBAAO;;AAFT,SAjCO,EAuCP;AACE8F,iBAAO,WADT;AAEE9F,iBAAO;;AAFT,SAvCO,EA6CP;AACE8F,iBAAO,SADT;AAEE9F,iBAAO,SAFT;AAGE+N,iBAAO,GAHT;AAIEgQ,kBAAQ;AAJV,SA7CO,EAmDP;AACEjY,iBAAO,iBADT;AAEE9F,iBAAO;;AAFT,SAnDO,EAyDP;AACE8F,iBAAO,eADT;AAEE9F,iBAAO;;AAFT,SAzDO,EA+DP;AACE8F,iBAAO,0BADT;AAEE9F,iBAAO,4BAFT;AAGE6N,oBAAU;;AAHZ,SA/DO,EAsEP;AACE/H,iBAAO,iBADT;AAEE9F,iBAAO;;AAFT,SAtEO,EA4EP;AACE8F,iBAAO,0BADT;AAEE9F,iBAAO;;AAFT,SA5EO,EAkFP;AACE8F,iBAAO,6BADT;AAEE9F,iBAAO;;AAFT,SAlFO,EAwFP;AACE8F,iBAAO,qBADT;AAEE9F,iBAAO;;AAFT,SAxFO,EA8FP;AACE8F,iBAAO,eADT;AAEE9F,iBAAO;;AAFT,SA9FO,EAoGP;AACE8F,iBAAO,eADT;AAEE9F,iBAAO;;AAFT,SApGO,EA0GP;AACE8F,iBAAO,aADT;AAEE9F,iBAAO,cAFT;AAGE6N,oBAAU;;AAHZ,SA1GO,EAiHP;AACE/H,iBAAO,6BADT;AAEE9F,iBAAO;;AAFT,SAjHO,EAuHP;AACE8F,iBAAO,UADT;AAEE9F,iBAAO,WAFT;AAGE6N,oBAAU;;AAHZ,SAvHO,EA8HP;AACE/H,iBAAO,kBADT;;AAGE9F,iBAAO,YAHT;;AAKE6N,oBAAU;;AALZ,SA9HO;AAFX,OAFW,EA6IX5N,IAAIF,MAAJ,CAAWoF,IA7IA,CAAb;;AAiJApF,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GACEtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,qBADtB;;AAGA1E,aAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,CACzB;AACExI,eAAO,QADT;AAEEmI,kBAAU,IAFZ;AAGE9H,eAAOhF,GAAGyE,KAAH,CAAS4I;AAHlB,OADyB,CAA3B;;AASA,WAAKrJ,IAAL,GAAY/D,EAAE,YAAF,EAAgBuN,SAAhB,CAA0B5O,MAA1B,CAAZ;AACD;;2BAIDie,iDAAoB;AAClB,UAAI7c,KAAK,IAAT;;AAEA,UAAIpB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP,EAAE9B,OAAO,aAAT,EAAwB9F,OAAO,OAA/B,EADO,EAEP,EAAE8F,OAAO,MAAT,EAAiB9F,OAAO,OAAxB,EAFO,EAGP;AACE8F,iBAAO,aADT;AAEE9F,iBAAO,cAFT;AAGE6N,oBAAU;AAHZ,SAHO,EAQP;AACEmD,mBAAS,EAAEhB,MAAM,OAAR,EAAiB/N,OAAOd,GAAG8P,gBAA3B,EADX;AAEEjR,iBAAO,SAFT;AAGE+N,iBAAO;AAHT,SARO;AADX,OAFW,EAkBX9N,IAAIF,MAAJ,CAAWoF,IAlBA,CAAb;;AAsBApF,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,QAA3D;;AAEA1E,aAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,CACzB;AACExI,eAAO,QADT;AAEEmI,kBAAU,IAFZ;AAGE9H,eAAOhF,GAAGyE,KAAH,CAAS4I;AAHlB,OADyB,EAMzB;AACE1I,eAAO,WADT;AAEEmI,kBAAU,IAFZ;AAGE9H,eAAO;AAHT,OANyB,CAA3B;;AAcA,WAAKhB,IAAL,GAAY/D,EAAE,KAAK6c,WAAP,EAAoBtP,SAApB,CAA8B5O,MAA9B,CAAZ;AACD;;2BAMDkR,6CAAiBzL,GAAG;AAClBA,QAAE0L,cAAF;;AAEA,UAAIC,WAAW,KAAKA,QAAL,CAAc/P,EAAEoE,EAAE4L,aAAJ,EAAmBC,OAAnB,CAA2B,IAA3B,CAAd,CAAf;;AAEAzD,YAAM0D,MAAN,CAAa,yBAAb,EAAwC,EAAxC,EAA4C3F,IAA5C,CACE,UAASnI,IAAT,EAAe;AACbpC,UAAEmQ,IAAF,CAAO;AACLC,kBAAQ,KADH;AAELjD,eAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,cAFpB;AAGLjB,gBAAM,EAAEgL,KAAK2C,SAAS3C,GAAhB,EAAqBiD,KAAKjO,IAA1B,EAAgCkO,OAAOP,SAASQ,MAAT,EAAvC,EAHD;AAILC,mBAAS,iBAASpE,GAAT,EAAc;AACrBI,kBAAMiE,KAAN,CAAY,2BAAZ;;AAEA5R,gBAAI6Q,WAAJ,CAAgBkN,iBAAhB;AACD,WARI;AASLza,iBAAO,eAASuO,GAAT,EAAc;AACnB3Q,eAAG6c,iBAAH;AACD;AAXI,SAAP;AAaD,OAfH,EAgBE,YAAW;AACTpQ,cAAMiE,KAAN,CAAY,2BAAZ;AACD,OAlBH;AAoBD;;2BAEDqM,mCAAYC,KAAK;AACf,WAAKrH,KAAL,CAAWC,QAAX,CAAoBoH,GAApB,IAA2B,CAAC,KAAKrH,KAAL,CAAWC,QAAX,CAAoBoH,GAApB,CAA5B;AACA,WAAKrH,KAAL,CAAWqH,GAAX,IAAkB,KAAKrH,KAAL,CAAWtT,IAAX,CAAgB2a,GAAhB,EAAqB,KAAKrH,KAAL,CAAWC,QAAX,CAAoBoH,GAApB,CAArB,CAAlB;AACD;;2BAEDxG,uDAAuB;AACrBvW,QAAE,QAAF,EAAYgd,gBAAZ,CAA6B;AAC3BnO,eAAO,UADoB;AAE3BoO,iBAAS;AACPlY,iBAAOlG,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqB,EAArB,EAAyB,QAAzB;AADA,SAFkB;AAK3BgE,eAAO;AACLC,qBAAW,CADN;AAELC,sBAAY,CAAC,EAFR;AAGLC,oBAAU,GAHL;AAILxP,kBAAQ;AAENpB,sBAAU;AAFJ,WAJH;AAQL6Q,eAAK,GARA;AASLC,kBAAQ,CACN;AACEC,kBAAM,CADR;AAEEC,gBAAI,EAFN;AAGEC,mBAAO;AAHT,WADM,EAMN;AACEF,kBAAM,EADR;AAEEC,gBAAI,EAFN;AAGEC,mBAAO;AAHT,WANM,EAWN;AACEF,kBAAM,EADR;AAEEC,gBAAI,GAFN;AAGEC,mBAAO;AAHT,WAXM;AATH;AALoB,OAA7B;AAiCD;;2BAkCDC,iDAAoB;AAClB,WAAK3H,QAAL,CAAcG,IAAd,CAAmBD,SAAnB,GAA+B6F,OAAOC,MAAP,EAAe5M,MAAf,CAAsB,qBAAtB,CAA/B;AACD;;2BAEDiH,mDAAqB;AACnB,UAAI,KAAKL,QAAL,CAAcC,eAAd,CAA8B5T,MAA9B,KAAyC,IAA7C,EAAmD;AACjDrC,UAAE,KAAK4d,WAAP,EAAoBC,QAApB,CAA6B,UAA7B;AACD,OAFD,MAEO;AACL7d,UAAE,KAAK8d,UAAP,EAAmBD,QAAnB,CAA4B,UAA5B;AACD;AACF;;2BAKDE,+CAAkBC,KAAK;AACrB,UAAIje,KAAK,IAAT;AACA,UAAIA,GAAGyE,KAAP,EAAc;AACZ,aAAKsG,IAAL,CAAU9B,MAAV,CAAiB6J,IAAjB,CAAsB,gBAAtB,EAAwC;AACtCoL,gBAAMle,GAAGyE,KAAH,CAAS0Z,MADuB;AAEtCtO,mBAASoO,GAF6B;AAGtChK,yBAAejU,GAAGyE,KAAH,CAASwP;AAHc,SAAxC,EAIGzJ,IAJH,CAIQ,UAAC6B,GAAD,EAAS;AACf,cAAIA,GAAJ,EAAS;AACP5N,oBAAQiB,GAAR,CAAY2M,GAAZ;AACA9J,wBAAYC,KAAZ,CAAkB6J,IAAI7C,OAAtB,EAA+B,IAA/B;AACD;AACF,SATD;AAUD;AACF;;;;;;;;;;;;;;;;;;;;;MC9xBU4U,mBAAAA,mBADZ;AAUC,sBAAYrT,IAAZ,EAAkB;AAAA;;AAAA,WARlBsT,KAQkB,GARV,EAQU;AAAA,WAPlBC,YAOkB,GAPH,EAOG;AAAA,WAJlBC,OAIkB,GAJR,cAIQ;AAAA,WAHlBC,UAGkB,GAHL,KAGK;;AAChB,WAAKzT,IAAL,GAAYA,IAAZ;AACD;;uBAEDjL,+BAAW;AACT,UAAIE,KAAK,IAAT;AACAlB,UAAI6Q,WAAJ,GAAkB,IAAlB;;AAGA1P,QAAE,sBAAF,EAA0Bwe,gBAA1B,CAA2C;AACzCC,kBAAU,IAD+B;AAEzCzN,uBAAe,MAF0B;AAGzC0N,wBAAgB,MAHyB;AAIzCxR,gBAAQ,UAJiC;AAKzCyR,iBAAS,IALgC;AAMzCC,eAAO,CANkC;AAOzCxN,gBAAQ,gBAAShP,IAAT,EAAe;AACrBrC,aAAGqe,KAAH,CAASnR,IAAT,CAAc7K,KAAK2N,QAAL,CAAcmO,MAA5B;AACAne,aAAGse,YAAH,CAAgBpR,IAAhB,CAAqB7K,KAAK2N,QAAL,CAAciE,aAAnC;AACD,SAVwC;AAWzC6K,kBAAU,kBAASzc,IAAT,EAAe;AACvB5D,kBAAQiB,GAAR,CAAY,UAAZ;AACA,cAAImf,QAAQ7e,GAAGqe,KAAH,CAASpR,OAAT,CAAiB5K,KAAK2N,QAAL,CAAcmO,MAA/B,CAAZ;AACA,cAAIU,QAAQ,CAAC,CAAb,EAAgB;AACd7e,eAAGqe,KAAH,CAASU,MAAT,CAAgBF,KAAhB,EAAuB,CAAvB;AACA7e,eAAGse,YAAH,CAAgBS,MAAhB,CAAuBF,KAAvB,EAA8B,CAA9B;AACD;AACF,SAlBwC;AAmBzCta,oBAAY;AACVK,gBAAM,OADI;AAEVwB,2BAAiB,KAFP;AAGVd,qBAAW;AACTC,kBAAM;AACJ6H,mBAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,QADrB;AAEJsB,oBAAM,KAFF;AAGJY,2BAAa,kBAHT;AAIJC,sBAAQ,mCAJJ;AAKJC,wBAAU,MALN;AAMJC,yBAAW,EAAEC,iBAAiB,IAAnB;AANP;AADG,WAHD;AAaVpB,kBAAQ;AACNnC,kBAAM,WADA;AAENwD,mBAAO,YAFD;AAGNpB,mBAAO;AACLC,sBAAQ;AACNoB,2BAAW,EAAElB,MAAM,MAAR,EADL;AAENmB,6BAAa,EAAEnB,MAAM,MAAR,EAFP;AAGNoB,4BAAY,EAAEpB,MAAM,MAAR,EAHN;AAINqB,4BAAY,EAAErB,MAAM,MAAR;AAJN;AADH;AAHD;AAbE;AAnB6B,OAA3C;AA8CD;;uBAGDoa,qCAAc;AAAA;;AACZ,WAAKT,OAAL,GAAe,SAAf;AACA,WAAKC,UAAL,GAAkB,IAAlB;;AAEA,WAAKzT,IAAL,CAAU9B,MAAV,CAAiB6J,IAAjB,CAAsB,mBAAtB,EAA2C;AACzCuL,eAAO,KAAKA,KAD6B;AAEzCC,sBAAc,KAAKA,YAFsB;AAGzCzO,iBAAS,KAAKoP;AAH2B,OAA3C,EAIGzU,IAJH,CAIQ,UAAC6B,GAAD,EAAS;AACf,cAAKkS,OAAL,GAAe,cAAf;AACA,cAAKC,UAAL,GAAkB,KAAlB;AACA,YAAInS,OAAOA,IAAI7C,OAAf,EAAwB;AACtBjH,sBAAYC,KAAZ,CAAkB6J,IAAI7C,OAAtB,EAA+B,IAA/B;AACD;AACF,OAVD;AAWD;;;;;;;;;;;;;;;;;;;;;MC/EU0V,oBAAAA,oBADZ;AAaC,uBAAYnU,IAAZ,EAAkBvM,MAAlB,EAA0B;AAAA;;AAAA,WAP1BwM,OAO0B,GAPhB,EAOgB;AAAA,WAF1BC,KAE0B,GAFlB,EAEkB;;AACxB,WAAKF,IAAL,GAAYA,IAAZ;AACA,WAAKvM,MAAL,GAAcA,MAAd;AACA,WAAK0M,IAAL,GAAYpM,IAAIC,WAAhB;AACD;;wBAKDe,+BAAW;AAAA;;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,WAAX,EAAwB;AACpCC,yBAAiB,KADmB;;AAGpCC,kBAAU,kBAASC,KAAT,EAAgBC,GAAhB,EAAqB;AAC7B,cAAIxL,GAAGmL,MAAP,EAAe;AACbnL,eAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AACF,SAPmC;;AASpCC,qBAAa,qBAASL,KAAT,EAAgBC,GAAhB,EAAqB;AAChCxL,aAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AAXmC,OAAxB,CAAd;;AAeA,UACE,KAAKnN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,IACA,KAAKtN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,CAAsCC,EAFxC,EAGE;AACA,YAAIA,KAAK,KAAKvN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,CAAsCC,EAA/C;AACA,aAAKC,UAAL,CAAgBD,EAAhB,EAAoB,YAAM;AACxB,gBAAKE,OAAL,GAAe,KAAf;AACA,gBAAKC,QAAL;AACD,SAHD;AAID,OATD,MASO;AACL,aAAKA,QAAL;AACD;AACF;;wBAEDA,+BAAW;AACT,UAAIlM,KAAK,IAAT;;AAEAA,SAAGyL,UAAH;;AAGAzL,SAAGyN,uBAAH;;AAGAzN,SAAGqO,mBAAH;AACD;;wBAMDrC,iCAAWD,IAAII,UAAU;AAAA;;AACvB,WAAKpB,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,kBAAoCL,EAApC,EAA0CvB,IAA1C,CAA+C,eAAO;AACpD,YAAI6B,OAAOA,IAAIhK,IAAf,EAAqB;AACnB,iBAAK2I,OAAL,GAAeqB,IAAIhK,IAAJ,CAAS,CAAT,CAAf;AACA8J;AACD;AACF,OALD;AAMD;;wBAMDV,iCAAWa,MAAM;AAEf,UAAI1N,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACEC,wBAAgBC,MAAMC,QAAN,CAAezM,EAAE,WAAF,EAAe0M,IAAf,EAAf,CADlB;AAEElG,iBAAS,CACP;AACEiG,oBAAU,+CADZ;AAEE/H,iBAAO,MAFT;AAGE9F,iBAAO,YAHT;AAIE+N,iBAAO,GAJT;AAKEzI,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AALd,SADO,EAYP;AACEnI,iBAAO,OADT;AAEE9F,iBAAO,YAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SAZO,EAqBP;AACEnI,iBAAO,cADT;AAEE9F,iBAAO,cAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SArBO,EA8BP;AACEnI,iBAAO,0BADT;AAEE9F,iBAAO,4BAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SA9BO,EAuCP;AACEnI,iBAAO,YADT;AAEE9F,iBAAO,eAFT;AAGE6N,oBAAU,gFAHZ;AAIEvI,sBAAY;AACViD,mBAAO,MADG;AAEV2F,sBAAU;AACRrO,oBAAM;AADE;AAFA;AAJd,SAvCO;AAFX,OAFW,EAwDXI,IAAIF,MAAJ,CAAWoF,IAxDA,CAAb;;AA4DA,UAAIlF,IAAIC,WAAJ,CAAgBiO,UAAhB,CAA2BC,OAA3B,CAAmC,CAAnC,IAAwC,CAAC,CAA7C,EAAgD;AAC9CrO,eAAOqF,OAAP,CAAeiJ,IAAf,CAAoB;AAClBR,oBAAU;AADQ,SAApB;AAGD;;AASD,UAAIJ,IAAJ,EAAU;AACR1N,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,EAAExI,OAAO,MAAT,EAAiBmI,UAAU,IAA3B,EAAiC9H,OAAOsH,IAAxC,EAA3B;AACD;;AAGD1N,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,QAA3D;;AAEA,UAAI,KAAK0H,OAAL,CAAaqC,GAAb,IAAoB,KAAKrC,OAAL,CAAasC,MAArC,EAA6C;AAC3C1O,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2BlN,EAAEsM,MAAF,CAAS3N,OAAO2F,UAAP,CAAkB4I,MAA3B,EAAmC;AAC5DxI,iBAAO,KADqD;AAE5DmI,oBAAU,IAFkD;AAG5D9H,iBAAO,KAAKgG,OAAL,CAAasC,MAAb,CAAoBC,IAApB,CAAyB,GAAzB;AAHqD,SAAnC,CAA3B;AAKD;;AAED,WAAKvJ,IAAL,GAAY/D,EAAE,YAAF,EAAgBuN,SAAhB,CAA0B5O,MAA1B,CAAZ;AACD;;wBAID6O,6DAA0B;AACxB,UAAIzN,KAAK,IAAT;AACA,UAAIoN,MAAM,KAAKpC,OAAL,CAAaqC,GAAb,0CAC+B,KAAKrC,OAAL,CAAaqC,GAD5C,GAEN,oCAFJ;;AAIA,WAAKK,wBAAL,GAAgC,IAAhC;AACA,WAAK3C,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,CAAqBgB,GAArB,EAA0B5C,IAA1B,CAA+B,eAAO;AACpCxK,WAAG2N,mBAAH,GAAyB,KAAzB;;AAEA3N,WAAG0N,wBAAH,GAA8B,KAA9B;AACA,YAAIrB,OAAOA,IAAIhK,IAAJ,CAASqE,MAAhB,IAA0B2F,IAAIhK,IAAJ,CAAS,CAAT,EAAYwF,qBAA1C,EAAiE;AAC/D,cAAI+F,eAAevB,IAAIhK,IAAJ,CAAS,CAAT,EAAYwF,qBAA/B;AACA7H,aAAGiL,KAAH,CAAS4C,iBAAT,GAA6B,iBAAU7N,GAAG6N,iBAAb,EAAgC;AAC3DjJ,kBAAM,KADqD;AAE3DvC,kBAAM;AACJyL,sBAAQ,CAAC,OAAD,EAAU,WAAV,EAAuB,UAAvB,CADJ;AAEJC,wBAAU,CACR;AACE1L,sBAAM,CACJuL,aAAaI,KADT,EAEJJ,aAAaK,UAFT,EAGJL,aAAaM,OAHT,CADR;AAMEC,iCAAiB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,CANnB;AAOEC,sCAAsB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC;AAPxB,eADQ;AAFN;AAFqD,WAAhC,CAA7B;AAiBD,SAnBD,MAmBO;AAELpO,aAAG2N,mBAAH,GAAyB,IAAzB;AACD;AACF,OA3BD;AA4BD;;wBAIDU,qDAAsB;AAAA;;AACpB,UAAIrO,KAAK,IAAT;AACA,UAAIoN,MAAM,KAAKpC,OAAL,CAAaqC,GAAb,sCAC2B,KAAKrC,OAAL,CAAaqC,GADxC,GAEN,gCAFJ;;AAIA,WAAKiB,oBAAL,GAA4B,IAA5B;AACA,WAAKvD,IAAL,CAAU9B,MAAV,CAAiBmD,GAAjB,CAAqBgB,GAArB,EAA0B5C,IAA1B,CAA+B,eAAO;AAEpCxK,WAAGsO,oBAAH,GAA0B,KAA1B;AACA,YAAIjC,OAAOA,IAAIhK,IAAJ,CAASqE,MAAhB,IAA0B2F,IAAIhK,IAAJ,CAAS,CAAT,EAAYkM,iBAA1C,EAA6D;AAC3DvO,aAAGwO,eAAH,GAAqB,KAArB;AACA,cAAInM,OAAO,EAAX;AACA,cAAIoM,aAAa,EAAjB;AACA,cAAIF,oBAAoBlC,IAAIhK,IAAJ,CAAS,CAAT,EAAYkM,iBAApC;AACA,eAAK,IAAIG,MAAT,IAAmBH,iBAAnB,EAAsC;AACpClM,iBAAK6K,IAAL,CAAUqB,kBAAkBG,MAAlB,CAAV;AACAD,uBAAWvB,IAAX,CAAgBwB,MAAhB;AACD;;AAEDzO,YAAE,OAAK0O,aAAP,EAAsBC,UAAtB,CAAiC;AAC/B/P,mBAAO;AACLgQ,oBAAM;AADD,aADwB;AAI/BC,mBAAO,UAJwB;AAK/BC,oBAAQ;AACNC,wBAAU;AADJ,aALuB;AAQ/BC,4BAAgB;AACdrK,oBAAM;AADQ,aARe;AAW/BsK,0BAAc,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,CAXiB;AAY/BC,oBAAQ,CACN;AACE9P,oBAAM,YADR;AAEEgD,oBAAMA;AAFR,aADM,CAZuB;AAkB/B+M,uBAAW;AACTtB,sBAAQ;AACNuB,wBAAQ;AADF,eADC;AAITC,oBAAM;AACJC,yBAAS;AADL,eAJG;AAOTC,iCAAmB;AAPV,aAlBoB;AA2B/BC,0BAAc;AACZhB,0BAAYA,UADA;AAEZa,oBAAM;AACJC,yBAAS;AADL;;AAFM,aA3BiB;AAuC/BzN,qBAAS;AACPyN,uBAAS,IADF;AAEPF,sBAAQ,SAFD;AAGP3C,wBAAU;AAHH;AAvCsB,WAAjC;AA6CD,SAvDD,MAuDO;AAEL1M,aAAGwO,eAAH,GAAqB,IAArB;AACD;AACF,OA9DD;AA+DD;;;;;;;;;;;;;;;;;;;;;MChSU2Q,oBAAAA,oBADZ;AAEC,uBAAYpU,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAC5B,WAAK9I,IAAL,GAAYA,IAAZ;AACA,WAAKgJ,QAAL,GAAgBF,UAAhB;AACD;;wBAED/T,+BAAW;AACThB,UAAI6Q,WAAJ,GAAkB,IAAlB;;AAGA,WAAKyP,eAAL;AACD;;wBAKDA,6CAAkB;AAChB,UAAIpf,KAAK,IAAT;;AAGA,UAAIpB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACE9B,iBAAO,MADT;AAEE9F,iBAAO;AAFT,SADO,EAKP;AACE8F,iBAAO,MADT;AAEE9F,iBAAO;AAFT,SALO;AADX,OAFW,EAcXC,IAAIF,MAAJ,CAAWoF,IAdA,CAAb;;AAkBApF,aAAO0H,SAAP,GAAmB,YAAW,CAE7B,CAFD;;AAKA,UAAIxH,IAAIC,WAAJ,CAAgBiO,UAAhB,CAA2BC,OAA3B,CAAmC,CAAnC,IAAwC,CAAC,CAA7C,EAAgD;AAC9CrO,eAAO6H,OAAP,CAAeyG,IAAf,CACE;AACE2C,mBAAS,EAAEhB,MAAM,QAAR,EAAkB/N,OAAOd,GAAGqf,cAA5B,EADX;AAEExgB,iBAAO,SAFT;AAGE+N,iBAAO;AAHT,SADF;AAOD;;AAGDhO,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,WAA3D;;AAEA,WAAKU,IAAL,GAAY/D,EAAE,YAAF,EAAgBuN,SAAhB,CAA0B5O,MAA1B,CAAZ;AACD;;wBAMDygB,yCAAehb,GAAG;AAChBA,QAAE0L,cAAF;;AAEA,UAAIC,WAAW,KAAKA,QAAL,CAAc/P,EAAEoE,EAAE4L,aAAJ,EAAmBC,OAAnB,CAA2B,IAA3B,CAAd,CAAf;;AAEAzD,YAAM6S,OAAN,CAAc,kCAAd,EAAkD9U,IAAlD,CACE,UAASnI,IAAT,EAAe;AACbpC,UAAEmQ,IAAF,CAAO;AACLC,kBAAQ,QADH;AAELjD,eAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,YAFpB;AAGLjB,gBAAM,EAAEgL,KAAK2C,SAAS3C,GAAhB,EAHD;AAILoD,mBAAS,iBAASpE,GAAT,EAAc;AACrBI,kBAAMiE,KAAN,CAAY,oBAAZ;;AAEA5R,gBAAI6Q,WAAJ,CAAgByP,eAAhB;AACD,WARI;AASLhd,iBAAO,eAASuO,GAAT,EAAc;AACnB3Q,eAAGof,eAAH;AACD;AAXI,SAAP;AAaD,OAfH,EAgBE,YAAW;AACT3S,cAAMiE,KAAN,CAAY,oBAAZ;AACD,OAlBH;AAoBD;;wBAKD6O,iCAAWC,OAAO;AAChB/gB,cAAQiB,GAAR,CAAY,aAAZ;AACA,UAAI8f,SAASA,MAAM,CAAN,CAAb,EAAuB;AACrB,YAAIC,OAAOD,MAAM,CAAN,CAAX;AACA,YAAIjL,iBAAJ;;AAGA,YAAIkL,KAAKpgB,IAAL,CAAUqgB,KAAV,CAAgB,MAAhB,CAAJ,EAA6B;AAC3BnL,qBAAWzV,IAAIC,WAAJ,CAAgBsO,GAAhB,GAAsB,GAAtB,GAA4B4O,KAAK0D,GAAL,EAA5B,GAAyC,MAApD;AACD,SAFD,MAEO,IAAIF,KAAKpgB,IAAL,CAAUqgB,KAAV,CAAgB,OAAhB,CAAJ,EAA8B;AACnCnL,qBAAWzV,IAAIC,WAAJ,CAAgBsO,GAAhB,GAAsB,GAAtB,GAA4B4O,KAAK0D,GAAL,EAA5B,GAAyC,OAApD;AACD,SAFM,MAEA;AACLpd,sBAAYC,KAAZ,CAAkB,oCAAlB,EAAwD,IAAxD;AACD;AACD,YAAI+R,QAAJ,EAAc;AAEZ,cAAIC,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,OAAhB,EAAyB+K,IAAzB,EAA+BlL,QAA/B;;;AAGA,eAAKR,QAAL,CACGY,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,kBAD7B,EACiD;AAC7C+M,oBAAQ,MADqC;AAE7CxF,kBAAM2J;AAFuC,WADjD,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ,gBAAInI,IAAJ,EAAU;AACRE,0BAAYC,KAAZ,CAAkB,4BAAlB,EAAgD,IAAhD;AACD;AACF,WAVH,EAWGqS,KAXH,CAWS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAXT;AAYD;AACF,OA/BD,MA+BO;AACLjH,oBAAYC,KAAZ,CAAkB,uBAAlB,EAA2C,IAA3C;AACD;AACF;;;;;;;;;;;;;;;;;;;;;MCjIUkN,iBAAAA,iBADZ;AAEC,oBAAY3E,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAC5B,WAAK9I,IAAL,GAAYA,IAAZ;AACA,WAAKgJ,QAAL,GAAgBF,UAAhB;AACD;;qBAED/T,+BAAW;AACThB,UAAI6Q,WAAJ,GAAkB,IAAlB;;AAGA,WAAKiQ,eAAL;AACD;;qBAKDA,6CAAkB;AAChB,UAAI5f,KAAK,IAAT;;AAGA,UAAIpB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACE9B,iBAAO,MADT;AAEE9F,iBAAO;AAFT,SADO,EAKP;AACE8F,iBAAO,MADT;AAEE9F,iBAAO;AAFT,SALO,EASP;AACE8F,iBAAO,UADT;AAEE9F,iBAAO;AAFT,SATO,EAaP;AACE8F,iBAAO,WADT;AAEE9F,iBAAO;AAFT,SAbO;AADX,OAFW,EAsBXC,IAAIF,MAAJ,CAAWoF,IAtBA,CAAb;;AA0BApF,aAAO0H,SAAP,GAAmB,YAAW,CAE7B,CAFD;;AAKA,UAAIxH,IAAIC,WAAJ,CAAgBiO,UAAhB,CAA2BC,OAA3B,CAAmC,CAAnC,IAAwC,CAAC,CAA7C,EAAgD;AAC9CrO,eAAO6H,OAAP,CAAeyG,IAAf,CACE;AACE2C,mBAAS,EAAEhB,MAAM,QAAR,EAAkB/N,OAAOd,GAAG6f,cAA5B,EADX;AAEEhhB,iBAAO,SAFT;AAGE+N,iBAAO;AAHT,SADF;AAOD;;AAGDhO,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,WAA3D;;AAEA,WAAKU,IAAL,GAAY/D,EAAE,YAAF,EAAgBuN,SAAhB,CAA0B5O,MAA1B,CAAZ;AACD;;qBAMDihB,yCAAexb,GAAG;;AAGhB,UAAI2L,WAAW,KAAKA,QAAL,CAAc/P,EAAEoE,EAAE4L,aAAJ,EAAmBC,OAAnB,CAA2B,IAA3B,CAAd,CAAf;;AAEAzD,YAAM6S,OAAN,CAAc,kCAAd,EAAkD9U,IAAlD,CACE,UAASnI,IAAT,EAAe;AACb,YAAIrC,KAAK,IAAT;AACAC,UAAEmQ,IAAF,CAAO;AACLC,kBAAQ,QADH;AAELjD,eAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,YAFpB;AAGLjB,gBAAM,EAAEgL,KAAK2C,SAAS3C,GAAhB,EAHD;AAILoD,mBAAS,iBAASpE,GAAT,EAAc;AACrBI,kBAAMiE,KAAN,CAAY,oBAAZ;;AAEA5R,gBAAI6Q,WAAJ,CAAgBiQ,eAAhB;AACD,WARI;AASLxd,iBAAO,eAASuO,GAAT,EAAc;AACnB3Q,eAAG4f,eAAH;AACA5f,eAAG2S,KAAH;AACD;AAZI,SAAP;AAcD,OAjBH,EAkBE,YAAW;AACTlG,cAAMiE,KAAN,CAAY,oBAAZ;AACA1Q,WAAG2S,KAAH;AACD,OArBH;AAuBD;;qBAID4M,iCAAWC,OAAO;AAChB/gB,cAAQiB,GAAR,CAAY,aAAZ;AACA,UAAI8f,SAASA,MAAM,CAAN,CAAb,EAAuB;AACrB,YAAIC,OAAOD,MAAM,CAAN,CAAX;AACA,YAAIjL,iBAAJ;;AAGA,YAAIkL,KAAKpgB,IAAL,CAAUqgB,KAAV,CAAgB,MAAhB,CAAJ,EAA6B;AAC3BnL,qBAAWzV,IAAIC,WAAJ,CAAgBsO,GAAhB,GAAsB,GAAtB,GAA4B4O,KAAK0D,GAAL,EAA5B,GAAyC,MAApD;AACD,SAFD,MAEO,IAAIF,KAAKpgB,IAAL,CAAUqgB,KAAV,CAAgB,OAAhB,CAAJ,EAA8B;AACnCnL,qBAAWzV,IAAIC,WAAJ,CAAgBsO,GAAhB,GAAsB,GAAtB,GAA4B4O,KAAK0D,GAAL,EAA5B,GAAyC,OAApD;AACD,SAFM,MAEA;AACLpd,sBAAYC,KAAZ,CAAkB,oCAAlB,EAAwD,IAAxD;AACD;AACD,YAAI+R,QAAJ,EAAc;AAEZ,cAAIC,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,OAAhB,EAAyB+K,IAAzB,EAA+BlL,QAA/B;;;AAGA,eAAKR,QAAL,CACGY,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,kBAD7B,EACiD;AAC7C+M,oBAAQ,MADqC;AAE7CxF,kBAAM2J;AAFuC,WADjD,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ,gBAAInI,IAAJ,EAAU;AACRE,0BAAYC,KAAZ,CAAkB,4BAAlB,EAAgD,IAAhD;AACD;AACF,WAVH,EAWGqS,KAXH,CAWS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAXT;AAYD;AACF,OA/BD,MA+BO;AACLjH,oBAAYC,KAAZ,CAAkB,uBAAlB,EAA2C,IAA3C;AACD;AACF;;;;;;;;;;;;;;;;;;QChJUsd,yBAAAA;;;;;;;;;;;;;;;;;QCAAC,gBAAAA;;;;;wBAETphB,2CAAgBC,QAAQJ,QAAQ;AAC5BI,mBAAOM,GAAP,CAAW,CACP;AACIC,uBAAO,EADX,EACeE,MAAM,eADrB;AAEID,0BAAU,iBAFd;AAGIP,uBAAO;AAHX,aADO,EAMP;AACIM,uBAAO,iBADX;AAEIE,sBAAM,iBAFV;AAGID,0BAAU,mBAHd;AAIIP,uBAAO;AAJX,aANO,CAAX;AAaAD,mBAAOohB,gBAAP,CAAwB,uBAAe;AAEnC,uBAAO,iBAAP;AACH,aAHD;;AAKA,iBAAKxhB,MAAL,GAAcA,MAAd;AACH;;wBAEDsB,+BAAW;AACPmgB,wBAAY,cAAZ,EAEI;AACI,6BAAa;AACT,8BAAU;AACN,iCAAS,EADH;AAEN,mCAAW;AACP,sCAAU,IADH;AAEP,0CAAc;AAFP;AAFL,qBADD;AAQT,6BAAS;AACL,iCAAS;AADJ,qBARA;AAWT,6BAAS;AACL,gCAAQ,QADH;AAEL,kCAAU;AACN,qCAAS,CADH;AAEN,qCAAS;AAFH,yBAFL;AAML,mCAAW;AACP,wCAAY;AADL,yBANN;AASL,iCAAS;AACL,mCAAO,gBADF;AAEL,qCAAS,GAFJ;AAGL,sCAAU;AAHL;AATJ,qBAXA;AA0BT,+BAAW;AACP,iCAAS,GADF;AAEP,kCAAU,KAFH;AAGP,gCAAQ;AACJ,sCAAU,KADN;AAEJ,qCAAS,CAFL;AAGJ,2CAAe,GAHX;AAIJ,oCAAQ;AAJJ;AAHD,qBA1BF;AAoCT,4BAAQ;AACJ,iCAAS,CADL;AAEJ,kCAAU,IAFN;AAGJ,gCAAQ;AACJ,sCAAU,KADN;AAEJ,qCAAS,EAFL;AAGJ,wCAAY,GAHR;AAIJ,oCAAQ;AAJJ;AAHJ,qBApCC;AA8CT,mCAAe;AACX,kCAAU,IADC;AAEX,oCAAY,GAFD;AAGX,iCAAS,SAHE;AAIX,mCAAW,GAJA;AAKX,iCAAS;AALE,qBA9CN;AAqDT,4BAAQ;AACJ,kCAAU,IADN;AAEJ,iCAAS,CAFL;AAGJ,qCAAa,MAHT;AAIJ,kCAAU,KAJN;AAKJ,oCAAY,KALR;AAMJ,oCAAY,KANR;AAOJ,mCAAW;AACP,sCAAU,KADH;AAEP,uCAAW,GAFJ;AAGP,uCAAW;AAHJ;AAPP;AArDC,iBADjB;AAoEI,iCAAiB;AACb,iCAAa,QADA;AAEb,8BAAU;AACN,mCAAW;AACP,sCAAU,IADH;AAEP,oCAAQ;AAFD,yBADL;AAKN,mCAAW;AACP,sCAAU,IADH;AAEP,oCAAQ;AAFD,yBALL;AASN,kCAAU;AATJ,qBAFG;AAab,6BAAS;AACL,gCAAQ;AACJ,wCAAY,GADR;AAEJ,2CAAe;AACX,2CAAW;AADA;AAFX,yBADH;AAOL,kCAAU;AACN,wCAAY,GADN;AAEN,oCAAQ,EAFF;AAGN,wCAAY,CAHN;AAIN,uCAAW,CAJL;AAKN,qCAAS;AALH,yBAPL;AAcL,mCAAW;AACP,wCAAY;AADL,yBAdN;AAiBL,gCAAQ;AACJ,4CAAgB;AADZ,yBAjBH;AAoBL,kCAAU;AACN,4CAAgB;AADV;AApBL;AAbI,iBApErB;AA0GI,iCAAiB,IA1GrB;AA2GI,+BAAe;AACX,iCAAa,KADF;AAEX,wCAAoB,OAFT;AAGX,wCAAoB,EAHT;AAIX,2CAAuB,SAJZ;AAKX,yCAAqB,WALV;AAMX,uCAAmB;AANR;AA3GnB,aAFJ;AAwHH;;;;;;;;;;;;;;;;;;;;;MC7IQC,uBAAAA,uBADZ;AAUC,0BAAY3hB,OAAZ,EAAqBwM,IAArB,EAA2B;AAAA;;AAAA,WAR3BkB,OAQ2B,GARjB,KAQiB;AAAA,WAP3BkU,YAO2B,GAPZ,OAOY;AAAA,WAL3B1b,KAK2B,GALnB;AACN2b,mBAAW,EADL;AAENC,kBAAU;AAFJ,OAKmB;;AACzB,WAAK9hB,OAAL,GAAeA,OAAf;AACA,WAAK0K,MAAL,GAAc8B,KAAK9B,MAAnB;AACD;;2BAEDqX,yBAAQ;AAAA;;AACN,UAAItgB,KAAK,IAAT;AACA,WAAKiM,OAAL,GAAe,IAAf;AACA,WAAKkU,YAAL,GAAoB,eAApB;;AAGA,WAAKlX,MAAL,CAAY6J,IAAZ,CAAiB,aAAjB,EAAgC,KAAKrO,KAArC,EACG+F,IADH,CACQ,eAAO;AACXxK,WAAGiM,OAAH,GAAa,KAAb;AACA,YAAII,GAAJ,EAAS;AACP5J,uBAAa8d,OAAb,CAAqB,aAArB,EAAoC5W,KAAKM,SAAL,CAAeoC,IAAIhK,IAAnB,CAApC;AACA,gBAAK9D,OAAL,CAAaoE,OAAb,CAAqB,KAArB;AACD;AACF,OAPH;AAQD;;;;;;;;;;;;;;;;;;;;;MC5BUqU,cAAAA,cADZ;AAsCC,iBAAYjM,IAAZ,EAAkB;AAAA;;AAAA,WApClBkB,OAoCkB,GApCR,IAoCQ;AAAA,WAnClBuU,gBAmCkB,GAnCC,KAmCD;AAAA,WA7BlBpL,UA6BkB,GA7BL;AACXC,yBAAiB,KADN;AAEXC,qBAAa,IAFF;AAGXC,iBAAS,IAHE;AAIXC,kBAAU,KAJC;AAKXC,qBAAa;AALF,OA6BK;AAAA,WArBlBC,OAqBkB,GArBR,EAqBQ;AAAA,WAjBlB+K,UAiBkB,GAjBL,IAiBK;AAAA,WAXlBC,cAWkB,GAXD,EAWC;AAAA,WARlBC,eAQkB,GARA,EAQA;AAAA,WALlBC,eAKkB,GALA,EAKA;AAAA,WAFlBC,WAEkB,GAFJ,EAEI;;AAChB,WAAK5X,MAAL,GAAc8B,KAAK9B,MAAnB;AACD;;kBAKDnJ,+BAAW;AAAA;;AACThB,UAAI6Q,WAAJ,GAAkB,IAAlB;AACA,UAAI3P,KAAK,IAAT;;AAEA,WAAKiM,OAAL,GAAe,KAAf;AACAhM,QAAE,SAAF,EAAa6gB,IAAb;;AAIA7gB,QAAE,cAAF,EAAkBY,WAAlB;;AAGAZ,QAAE,KAAK6H,aAAP,EAAsBoM,iBAAtB,CAAwC;AACtC3P,oBAAYzF,IAAIF,MAAJ,CAAWkJ,aADe;;AAGtCqM,gBAAQ,kBAAW;AAEjBnU,aAAG6gB,WAAH,CAAejc,IAAf,GAAsB,KAAKI,KAAL,EAAtB;AACD;AANqC,OAAxC;;AAUA/E,QAAE,KAAK8H,aAAP,EAAsBmM,iBAAtB,CAAwC;AACtC3P,oBAAYzF,IAAIF,MAAJ,CAAWmJ,aADe;;AAGtCoM,gBAAQ,kBAAW;AAEjBnU,aAAG+gB,WAAH,CAAenc,IAAf,GAAsB,KAAKI,KAAL,EAAtB;AACD;AANqC,OAAxC;;AAWA/E,QAAE,KAAK+gB,gBAAP,EAAyBvC,gBAAzB,CAA0C;AACxCrN,qBAAa,WAD2B;AAExCH,uBAAe,MAFyB;AAGxC0N,wBAAgB,KAHwB;AAIxCsC,0BAAkB,CAJsB;AAKxC/P,oBAAY,KAL4B;AAMxC/D,gBAAQ,UANgC;;AAQxC5I,oBAAY;AACVK,gBAAM,OADI;AAEVwB,2BAAiB,IAFP;AAGVd,qBAAW;AACTC,kBAAM;AACJX,oBAAM,KADF;AAEJY,2BAAa,kBAFT;AAGJC,sBAAQ,mCAHJ;AAIJC,wBAAU,MAJN;AAKJC,yBAAW,EAAEC,iBAAiB,IAAnB,EALP;AAMJwH,mBAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB;AANrB;AADG;AAHD,SAR4B;AAsBxC+N,gBAAQ,gBAAShN,CAAT,EAAY;AAElB,cAAIA,EAAE2L,QAAF,CAAW3C,GAAf,EAAoB;AAClBrN,eAAG+gB,WAAH,CAAeG,SAAf,GAA2B7c,EAAE2L,QAAF,CAAW3C,GAAtC;AACD;AACF,SA3BuC;AA4BxCyR,kBAAU,kBAASza,CAAT,EAAY;AAEpBrE,aAAG+gB,WAAH,CAAeG,SAAf,GAA4B,IAA5B;AACD;;AA/BuC,OAA1C;;AAqCA,WAAKzK,OAAL,CAAa,YAAM;AAEjBlQ,mBAAW,YAAW;AACpBmQ,iBAAOC,IAAP,CAAYpL,KAAZ,CAAkBtG,OAAlB,CAA0BjF,GAAG4W,SAA7B,EAAwC,QAAxC;AACD,SAFD,EAEG,GAFH;;AAKA,cAAKuK,kBAAL,CAAwB,YAAM;AAC5BlhB,YAAE,SAAF,EAAa6gB,IAAb;;AAGA,gBAAKM,gBAAL;;AAGA,gBAAKC,mBAAL;;AAGA,gBAAKC,mBAAL;AACD,SAXD;AAYD,OAnBD;AAoBD;;kBAMD7K,2BAAQtK,UAAU;AAChB1N,cAAQiB,GAAR,CAAY,SAAZ;AACA,UAAIM,KAAK,IAAT;;AAEA,WAAK8W,YAAL,GAAoB,IAAIJ,OAAOC,IAAP,CAAYI,YAAhB,EAApB;;AAEAjY,UAAI8X,SAAJ,GAAgB,KAAKA,SAAL,GAAiB,IAAIF,OAAOC,IAAP,CAAYK,GAAhB,CAAoBpM,SAASqM,cAAT,CAAwB,KAAxB,CAApB,EAAoD;AACnFC,cAAM,CAD6E;AAEnFC,gBAAQ,EAAEC,KAAK,EAAP,EAAWC,KAAK,EAAhB,EAF2E;AAGnFC,mBAAWZ,OAAOC,IAAP,CAAY4K,SAAZ,CAAsBC,OAHkD;AAInFjK,wBAAgB,IAJmE;AAKnFC,qBAAa,IALsE;AAMnFC,mBAAW,IANwE;AAOnFC,+BAAuB;AACrBC,iBAAOjB,OAAOC,IAAP,CAAYiB,mBAAZ,CAAgCC;AADlB,SAP4D;AAUnFC,2BAAmB,KAVgE;AAWnFC,kCAA0B;AACxBJ,iBAAOjB,OAAOC,IAAP,CAAYqB,sBAAZ,CAAmCC;AADlB;AAXyD,OAApD,CAAjC;;AAiBA,WAAKC,YAAL,CAAkB,KAAKtB,SAAvB;;AAEAzK;AACD;;kBAKD+L,qCAAahZ,KAAK;AAChB,UAAI6P,SAAS,KAAKA,MAAlB;AACAA,aAAOoJ,SAAP;AAaAjZ,UAAI0W,QAAJ,CAAac,OAAOC,IAAP,CAAYyB,eAAZ,CAA4BC,SAAzC,EAAoDnL,IAApD,CAAyD6B,MAAzD;AACD;;kBAKDqS,+CAAmB;AACjB,UAAI7c,aAAa,EAAjB;AACA,WAAK,IAAIiC,IAAI,CAAb,EAAgBA,IAAI,KAAKkP,OAAL,CAAahP,MAAjC,EAAyCF,GAAzC,EAA8C;AAC5C,YAAI+S,SAAS,KAAK7D,OAAL,CAAalP,CAAb,CAAb;AACAjC,mBAAW2I,IAAX,CAAgB;AACdnB,cAAIwN,OAAOxN;AADG,SAAhB;AAGD;;AAED,WAAK0V,YAAL,GAAoBxhB,EAAE,eAAF,EACjBwe,gBADiB,CACA;AAChBiD,mBAAW,KADK;AAEhBnd,oBAAYA,UAFI;AAGhB0M,uBAAe,IAHC;AAIhB0N,wBAAgB;AAJA,OADA,EAOjBtc,IAPiB,CAOZ,kBAPY,CAApB;AAQD;;kBAMD8e,iDAAmBhV,UAAU;AAC3B,UAAInM,KAAK,IAAT;AACA,UAAI,KAAKsY,aAAT,EAAwB;AACtB,aAAKC,aAAL;AACA,aAAK+B,eAAL,CAAqBqH,YAArB;AACD;;AAED,WAAKC,aAAL;AACA,WAAKlM,OAAL,GAAe,EAAf;;AAEA,WAAKzM,MAAL,CAAYmD,GAAZ,CAAgB,aAAhB,EAA+B5B,IAA/B,CAAoC,eAAO;AACzC,YAAI6B,OAAOA,IAAIhK,IAAf,EAAqB;AACnB5D,kBAAQC,IAAR,CAAa,KAAb;;AADmB,qCAEV8H,CAFU;AAGjB,gBAAIgS,aAAanM,IAAIhK,IAAJ,CAASmE,CAAT,CAAjB;AACA,gBAAIiS,aAAa,IAAI/B,OAAOC,IAAP,CAAY+B,UAAhB,CAA2B;AAC1CjG,muBAegE+F,WAAWG,MAAX,CAAkBtL,GAflF,WAe0FmL,WAAWG,MAAX,CAAkBtZ,IAf5G,6OAmBsCmZ,WAAWG,MAAX,CAAkBrW,MAAlB,IAA4B,GAnBlE,6OAuBsCkW,WAAWI,SAvBjD,4OA2BsC9Z,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgByJ,QAAhB,CAAyBN,WAAW1S,SAApC,EAA+ChH,IAAIC,WAAJ,CAAgBuJ,cAA/D,CA3BtC,0OA+BsCkQ,WAAWO,QA/BjD,UA+B8DP,WAAWQ,SA/BzE,ifAyCsCR,WAAWhV,YAAX,IAA2B,GAzCjE,qPA6CsCgV,WAAWS,eAAX,IAA8B,GA7CpE,kPAiDsCT,WAAWU,kBAAX,IAAiC,GAjDvE,uPAqDsCpa,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqBX,WAAWY,wBAAhC,EAA0D,aAA1D,KAA4E,GArDlH,gPAyDsCta,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqBX,WAAWa,WAAhC,EAA6C,UAA7C,KAA4D,GAzDlG;AAD0C,aAA3B,CAAjB;;AAoEA,gBAAIC,UAAU,+BAAd;AACA,gBACEd,WAAWG,MAAX,CAAkBrW,MAAlB,IAA4BkW,WAAWG,MAAX,CAAkBrW,MAAlB,KAA6B,UAD3D,EAEE;AACA,sBAAQkW,WAAWG,MAAX,CAAkBrW,MAA1B;AACA,qBAAK,aAAL;AACEgX,4BAAU,mCAAV;AACA;;AAEF,qBAAK,gBAAL;AACEA,4BAAU,sCAAV;AACA;;AAEF;AAEE;AAXF;AAaD,aAhBD,MAgBO;AACL,kBAAId,WAAWG,MAAX,IAAqBH,WAAWG,MAAX,CAAkBpV,QAAlB,CAA2BC,YAApD,EAAkE;AAChE,wBAAQgV,WAAWG,MAAX,CAAkBpV,QAAlB,CAA2BC,YAA3B,CAAwCwB,KAAhD;AACA,uBAAK,IAAL;AACEsU,8BAAU,0BAAV;AACA;;AAEF,uBAAK,KAAL;AACEA,8BAAU,2BAAV;AACA;;AAEF;AAEE;AAXF;AAaD;AACF;;AAED,gBAAIC,SAAS,IAAI7C,OAAOC,IAAP,CAAY6C,MAAhB,CAAuB;AAClCxK,wBAAU;AACRoI,qBAAKqC,WAAWjB,WAAWO,QAAtB,CADG;AAER1B,qBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFG,eADwB;AAKlCna,qBAAO2Z,WAAWkB,SALgB;AAMlCC,oBAAML,OAN4B;AAOlCpa,mBAAKc,GAAG4W,SAP0B;AAQlC7K,kBAAIyM,WAAWG,MAAX,CAAkBtZ;AARY,aAAvB,CAAb;;AAYAka,mBAAOK,WAAP,CAAmB,OAAnB,EAA4B,YAAW;AACrCnB,yBAAW7W,IAAX,CAAgB5B,GAAG4W,SAAnB,EAA8B2C,MAA9B;AACD,aAFD;;AAIA7C,mBAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BnB,UAA9B,EAA0C,UAA1C,EAAsD,UAASpU,CAAT,EAAY;AAEhEpE,gBAAE,WAAF,EAAeyB,aAAf,CAA6B;AAC3BC,2BAAW;AACTC,wBAAM;AACJC,6BAAS;AADL;AADG;AADgB,eAA7B;;AASA,kBAAIgY,UAAU5Z,EAAE,cAAF,CAAd;AACA,kBAAI6Z,eAAeD,QAAQE,IAAR,EAAnB;;AAEAD,2BAAaE,QAAb,CAAsB,eAAtB,EAAuCC,GAAvC,CAA2C,EAAEC,SAAS,MAAX,EAA3C;;AAEAJ,2BAAaE,QAAb,CAAsB,eAAtB,EAAuCC,GAAvC,CAA2C,EAAEC,SAAS,MAAX,EAA3C;AACD,aAjBD;;AAoBAla,eAAG0V,OAAH,CAAWxI,IAAX,CAAgBqM,MAAhB;;AAGAvZ,eAAG8W,YAAH,CAAgBvK,MAAhB,CAAuB;AACrB6K,mBAAKqC,WAAWjB,WAAWO,QAAtB,CADgB;AAErB1B,mBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFgB,aAAvB;AAlJiB;;AAEnB,eAAK,IAAIxS,IAAI,CAAb,EAAgBA,IAAI6F,IAAIhK,IAAJ,CAASqE,MAA7B,EAAqCF,GAArC,EAA0C;AAAA,kBAAjCA,CAAiC;AAoJzC;;AAGD,cAAIxG,GAAGoV,UAAH,CAAcG,OAAlB,EAA2B;AACzBvV,eAAGuV,OAAH;AACD;;AAGD,cAAIvV,GAAGoV,UAAH,CAAcK,WAAlB,EAA+B;AAC7BzV,eAAGma,WAAH;AACD;;AAGDhO,sBAAYA,UAAZ;AACD;AACF,OAtKD;AAuKD;;kBAKDyV,yCAAgB;AACd,UAAIlM,UAAU,KAAKA,OAAnB;;AAEA,WAAK,IAAIlP,IAAI,CAAb,EAAgBA,IAAIkP,QAAQhP,MAA5B,EAAoCF,GAApC,EAAyC;AACvCkP,gBAAQlP,CAAR,EAAWqb,MAAX,CAAkB,IAAlB;AACD;AACF;;kBAGDC,6CAAiBC,QAAQ1iB,MAAMsN,MAAM;AAMnC,UAAI4M,SAAS,IAAI7C,OAAOC,IAAP,CAAY6C,MAAhB,CAAuB;AAClCxK,kBAAU+S,MADwB;AAElCpI,cAAM,kCAF4B;AAGlCza,aAAK,KAAK0X,SAHwB;AAIlCoL,gBAAQnG,KAAKoG,KAAL,CAAWF,OAAO3K,GAAP,KAAe,CAAC,MAA3B,KAAsC;AAJZ,OAAvB,CAAb;;AAYA,aAAOmC,MAAP;AACD;;kBAKD2I,2CAAiB;AAAA;;AACfzjB,cAAQC,IAAR,CAAa,uBAAb;AACA,WAAKyjB,SAAL,GAAiB3O,YAAY,YAAM;AACjC,eAAK4O,eAAL,CAAqB,IAArB;AACD,OAFgB,EAEd,KAAKhN,UAAL,CAAgBC,eAFF,CAAjB;AAGD;;kBAKDgN,yCAAgB;AACd5jB,cAAQC,IAAR,CAAa,uBAAb;AACAuU,oBAAc,KAAKkP,SAAnB;AACD;;kBAMDG,2CAAgBje,GAAG;AACjB,UAAIA,EAAEke,UAAF,CAAaC,OAAjB,EAA0B;AACxB,aAAKN,cAAL;AACD,OAFD,MAEO;AACL,aAAKG,aAAL;AACD;AACF;;kBAKD9M,6BAAU;AACR,UAAI6E,MAAM,KAAK1E,OAAL,CAAahP,MAAvB;AACA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAI4T,GAApB,EAAyB5T,GAAzB,EAA8B;AAE5B,aAAKkP,OAAL,CAAalP,CAAb,EAAgBtH,GAAhB,IAAuB,KAAK4X,YAAL,CAAkBvK,MAAlB,CAAyB,KAAKmJ,OAAL,CAAalP,CAAb,EAAgBwI,QAAzC,CAAvB;AACD;;AAED,WAAK4H,SAAL,CAAeyD,SAAf,CAAyB,KAAKvD,YAA9B;AACD;;kBAKDqD,qCAAc;AACZ,WAAKG,eAAL,GAAuB,IAAIC,eAAJ,CAAoB,KAAK3D,SAAzB,EAAoC,KAAKlB,OAAzC,EAAkD;AACvE8E,mBAAW;AAD4D,OAAlD,CAAvB;AAGD;;kBAKDjC,yCAAgB;AACd,WAAK+B,eAAL,CAAqBqH,YAArB;AACA,WAAKR,kBAAL,CAAwB,YAAM,CAAE,CAAhC;AACD;;kBAMDsB,2CAAgBpe,GAAG;AACjB,UAAIA,EAAEke,UAAF,CAAaC,OAAjB,EAA0B;AACxB,aAAKrI,WAAL;AACD,OAFD,MAEO;AACL,aAAK5B,aAAL;AACD;AACF;;kBAEDmK,yCAAgB;AACd,WAAKd,aAAL;AACA,WAAKtH,eAAL,CAAqBqH,YAArB;AACA,UAAIgB,iBAAiB,KAAKlB,YAAL,CAAkBzc,KAAlB,EAArB;;AAEA,UAAI2d,kBAAkBA,eAAejc,MAAf,GAAwB,CAA9C,EAAiD;AAC/C,YAAIkc,cAAcD,eAAejc,MAAjC;AACA,YAAImc,aAAa,KAAKnN,OAAL,CAAahP,MAA9B;;AAEA,aAAKga,cAAL,GAAsB,EAAtB;;AAEA,aAAK,IAAIla,IAAI,CAAb,EAAgBA,IAAIoc,WAApB,EAAiCpc,GAAjC,EAAsC;AACpC,eAAK,IAAIsc,IAAI,CAAb,EAAgBA,IAAID,UAApB,EAAgCC,GAAhC,EAAqC;AACnC,gBAAIH,eAAenc,CAAf,MAAsB,KAAKkP,OAAL,CAAaoN,CAAb,EAAgB/W,EAA1C,EAA8C;AAC5C,mBAAK2U,cAAL,CAAoBxT,IAApB,CAAyB,KAAKwI,OAAL,CAAaoN,CAAb,CAAzB;;AAGA,kBAAI,CAAC,KAAKpN,OAAL,CAAaoN,CAAb,EAAgBC,MAAhB,EAAL,EAA+B;AAC7B,qBAAKrN,OAAL,CAAaoN,CAAb,EAAgBjB,MAAhB,CAAuB,KAAKjL,SAA5B;AACD;AACF;AACF;AACF;AACD,aAAKrB,OAAL;AACA,aAAKH,UAAL,CAAgBE,WAAhB,GAA8B,KAA9B;AACD,OApBD,MAoBO;AACL,aAAK6L,kBAAL;AACD;AACF;;kBAKD6B,2CAAiB;AACf,UAAIC,kBAAkB,EAAtB;AACA,UAAIjf,OAAO/D,EAAE,gBAAF,EAAoBoC,IAApB,CAAyB,WAAzB,CAAX;AACA,UAAI6gB,KAAKlf,KAAKO,UAAL,CAAgB4e,IAAhB,EAAT;;AAGA,WAAK,IAAI3c,IAAI,CAAb,EAAgBA,IAAI0c,GAAGxc,MAAvB,EAA+BF,GAA/B,EAAoC;AAClC,aAAK,IAAIsc,IAAI,CAAb,EAAgBA,IAAII,GAAG1c,CAAH,EAAM4c,KAAN,CAAY1c,MAAhC,EAAwCoc,GAAxC,EAA6C;AAC3C,cAAIO,MAAMrf,KAAKsf,KAAL,CAAWve,IAAX,CAAgB,kBAAkBme,GAAG1c,CAAH,EAAM4c,KAAN,CAAYN,CAAZ,EAAeS,GAAjC,GAAuC,IAAvD,CAAV;AACA,cAAIC,WAAWvjB,EAAEojB,GAAF,EAAOte,IAAP,CAAY,gBAAZ,CAAf;AACA,cAAIye,SAASC,EAAT,CAAY,UAAZ,CAAJ,EAA6B;AAC3BR,4BAAgB/V,IAAhB,CAAqBgW,GAAG1c,CAAH,EAAM4c,KAAN,CAAYN,CAAZ,CAArB;AACD;AACF;AACF;;AAED,UAAIG,gBAAgBvc,MAApB,EAA4B;AAC1B,aAAKgd,aAAL,CAAmBT,eAAnB;AACD,OAFD,MAEO;AACL,aAAKU,eAAL;AACD;AACF;;kBAMDD,uCAAcE,WAAW;AACvBnlB,cAAQiB,GAAR,CAAY,aAAZ,EAA2BkkB,SAA3B;AACA,UAAI5jB,KAAK,IAAT;;AAEA,WAAK2jB,eAAL;;AAGA,WAAK,IAAInd,IAAI,CAAb,EAAgBA,IAAIod,UAAUld,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,aAAKqd,cAAL,CAAoBD,UAAUpd,CAAV,CAApB;AACD;;AAyED,UAAIxG,GAAGoV,UAAH,CAAcG,OAAlB,EAA2B;AACzBvV,WAAGuV,OAAH;AACD;AACF;;kBAMDsO,yCAAeC,UAAU;AACvB,UAAI9jB,KAAK,IAAT;AACA,UAAI+jB,uBAAJ;;AAGA,UAAIC,cAAc,SAAlB;AACA,UAAIjJ,YAAY,SAAhB;;AAEA,UAAI+I,SAASlf,IAAT,KAAkB,WAAtB,EAAmC;AACjCof,sBAAc,SAAd;AACAjJ,oBAAY,SAAZ;AACD;;AAGD,cAAQ+I,SAASG,QAAT,CAAkBrf,IAA1B;AACA,aAAK,QAAL;AACEmf,2BAAiB,IAAIrN,OAAOC,IAAP,CAAYuN,MAAhB,CAAuB;AACtCF,yBAAaA,WADyB;AAEtCG,2BAAe,GAFuB;AAGtCC,0BAAc,CAHwB;AAItCrJ,uBAAWA,SAJ2B;AAKtCsJ,yBAAa,IALyB;AAMtCnlB,iBAAKc,GAAG4W,SAN8B;AAOtCO,oBAAQ2M,SAASG,QAAT,CAAkB9M,MAPY;AAQtCmN,oBAAQR,SAASG,QAAT,CAAkBK;AARY,WAAvB,CAAjB;AAUA;AACF,aAAK,SAAL;AACEP,2BAAiB,IAAIrN,OAAOC,IAAP,CAAY4N,OAAhB,CAAwB;AACvCP,yBAAaA,WAD0B;AAEvCG,2BAAe,GAFwB;AAGvCC,0BAAc,CAHyB;AAIvCrJ,uBAAWA,SAJ4B;AAKvCsJ,yBAAa,IAL0B;AAMvCnlB,iBAAKc,GAAG4W,SAN+B;AAOvC4N,mBAAOV,SAASG,QAAT,CAAkBQ,IAAlB,CAAuBjU,MAAvB;AAPgC,WAAxB,CAAjB;AASA;AACF,aAAK,WAAL;AACEuT,2BAAiB,IAAIrN,OAAOC,IAAP,CAAY4N,OAAhB,CAAwB;AACvCP,yBAAaA,WAD0B;AAEvCG,2BAAe,GAFwB;AAGvCC,0BAAc,CAHyB;AAIvCrJ,uBAAWA,SAJ4B;AAKvCsJ,yBAAa,IAL0B;AAMvCnlB,iBAAKc,GAAG4W,SAN+B;AAOvC8N,oBAAQZ,SAASG,QAAT,CAAkBS;AAPa,WAAxB,CAAjB;AASA;AACF;AACE;AApCF;AAsCA,WAAK9D,eAAL,CAAqB1T,IAArB,CAA0B6W,cAA1B;AACD;;kBAKDJ,6CAAkB;AAChB,UAAIC,YAAY,KAAKhD,eAArB;;AAEA,WAAK,IAAIpa,IAAI,CAAb,EAAgBA,IAAIod,UAAUld,MAA9B,EAAsCF,GAAtC,EAA2C;AACzCod,kBAAUpd,CAAV,EAAaqb,MAAb,CAAoB,IAApB;AACD;AACF;;kBAMDR,qDAAsB;AAIpB,UAAIziB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACE9B,iBAAO,MADT;AAEE9F,iBAAO,UAFT;AAGE6N,oBAAU;AAHZ,SADO,EAMP;AACEA,oBAAU;AADZ,SANO,EASP;AACE/H,iBAAO,MADT;AAEE9F,iBAAO,MAFT;AAGE8lB,+BAAqB,wBAHvB;AAIE/H,kBAAQ;AAJV,SATO;AADX,OAFW,EAoBX9d,IAAIF,MAAJ,CAAWoF,IApBA,CAAb;;AAwBApF,aAAOqF,OAAP,GAAiB,IAAjB;AACArF,aAAOmI,QAAP,GAAkB,KAAlB;AACAnI,aAAOgmB,UAAP,GAAoB,KAApB;AACAhmB,aAAOoI,QAAP,GAAkB,KAAlB;AACApI,aAAOgI,SAAP,GAAmB,KAAnB;;AAEAhI,aAAOuC,MAAP,GAAgB,MAAhB;;AAGAvC,aAAO2F,UAAP,CAAkB2B,QAAlB,GAA6B,IAA7B;;AAGAtH,aAAO2F,UAAP,CAAkBsgB,KAAlB,GAA0B;AACxBlgB,eAAO,MADiB;AAExBmgB,aAAK,KAFmB;AAGxBC,oBAAY,CAAC,EAAEpgB,OAAO,MAAT,EAAiBqgB,WAAW,OAA5B,EAAD;AAHY,OAA1B;;AAOApmB,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,WAA3D;;AAGA,WAAKU,IAAL,GAAY/D,EAAE,gBAAF,EAAoBuN,SAApB,CAA8B5O,MAA9B,CAAZ;AACD;;kBAKDqmB,2CAAiB;AACf,UAAIC,kBAAkB,EAAtB;AACA,UAAIlhB,OAAO/D,EAAE,gBAAF,EAAoBoC,IAApB,CAAyB,WAAzB,CAAX;AACA,UAAI6gB,KAAKlf,KAAKO,UAAL,CAAgB4e,IAAhB,EAAT;;AAGA,WAAK,IAAI3c,IAAI,CAAb,EAAgBA,IAAI0c,GAAGxc,MAAvB,EAA+BF,GAA/B,EAAoC;AAClC,aAAK,IAAIsc,IAAI,CAAb,EAAgBA,IAAII,GAAG1c,CAAH,EAAM4c,KAAN,CAAY1c,MAAhC,EAAwCoc,GAAxC,EAA6C;AAC3C,cAAIO,MAAMrf,KAAKsf,KAAL,CAAWve,IAAX,CAAgB,kBAAkBme,GAAG1c,CAAH,EAAM4c,KAAN,CAAYN,CAAZ,EAAeS,GAAjC,GAAuC,IAAvD,CAAV;AACA,cAAIC,WAAWvjB,EAAEojB,GAAF,EAAOte,IAAP,CAAY,gBAAZ,CAAf;AACA,cAAIye,SAASC,EAAT,CAAY,UAAZ,CAAJ,EAA6B;AAC3ByB,4BAAgBhY,IAAhB,CAAqBgW,GAAG1c,CAAH,EAAM4c,KAAN,CAAYN,CAAZ,CAArB;AACD;AACF;AACF;;AAED,UAAIoC,gBAAgBxe,MAApB,EAA4B;AAC1B,aAAKye,aAAL,CAAmBD,eAAnB;AACD,OAFD,MAEO;AACL,aAAKE,eAAL;AACD;AACF;;kBAMDD,uCAAcE,WAAW;AACvB,UAAIrlB,KAAK,IAAT;;AAEA,WAAKolB,eAAL;;AAHuB,mCAMd5e,CANc;AAOrB,YAAIgS,aAAa6M,UAAU7e,CAAV,CAAjB;;AAEA,YAAI+S,SAAS,IAAI7C,OAAOC,IAAP,CAAY6C,MAAhB,CAAuB;AAClCxK,oBAAU;AACRoI,iBAAKqC,WAAWjB,WAAWO,QAAtB,CADG;AAER1B,iBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFG,WADwB;AAKlCna,iBAAO2Z,WAAWnZ,IALgB;AAMlCsa,2CAA+BnB,WAAW5T,IAA1C,SANkC;AAOlC1F,eAAKc,GAAG4W,SAP0B;AAQlC7K,cAAIyM,WAAWnL;AARmB,SAAvB,CAAb;;AAWA,YAAIoL,aAAa,IAAI/B,OAAOC,IAAP,CAAY+B,UAAhB,CAA2B;AAC1CjG,0kBAY0C+F,WAAWnZ,IAZrD,GAY4DmH,CAZ5D,4OAgB0CgS,WAAW5T,IAhBrD,0OAoB0C4T,WAAWO,QApBrD,UAoBkEP,WAAWQ,SApB7E;AAD0C,SAA3B,CAAjB;;AA+BAO,eAAOK,WAAP,CAAmB,OAAnB,EAA4B,YAAW;AACrCnB,qBAAW7W,IAAX,CAAgB5B,GAAG4W,SAAnB,EAA8B2C,MAA9B;AACD,SAFD;;AAKA7C,eAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BnB,UAA9B,EAA0C,UAA1C,EAAsD,UAASpU,CAAT,EAAY;AAEhEpE,YAAE,WAAF,EAAeyB,aAAf,CAA6B;AAC3BC,uBAAW;AACTC,oBAAM;AACJC,yBAAS;AADL;AADG;AADgB,WAA7B;AAOD,SATD;;AAYA7B,WAAG2gB,eAAH,CAAmBzT,IAAnB,CAAwBqM,MAAxB;;AAGAvZ,WAAG8W,YAAH,CAAgBvK,MAAhB,CAAuB;AACrB6K,eAAKqC,WAAWjB,WAAWO,QAAtB,CADgB;AAErB1B,eAAKoC,WAAWjB,WAAWQ,SAAtB;AAFgB,SAAvB;AAvEqB;;AAMvB,WAAK,IAAIxS,IAAI,CAAb,EAAgBA,IAAI6e,UAAU3e,MAA9B,EAAsCF,GAAtC,EAA2C;AAAA,eAAlCA,CAAkC;AAqE1C;;AAGD,UAAIxG,GAAGoV,UAAH,CAAcG,OAAlB,EAA2B;AACzBvV,WAAGuV,OAAH;AACD;AACF;;kBAKD6P,6CAAkB;AAChB,UAAIC,YAAY,KAAK1E,eAArB;;AAEA,WAAK,IAAIna,IAAI,CAAb,EAAgBA,IAAI6e,UAAU3e,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC6e,kBAAU7e,CAAV,EAAaqb,MAAb,CAAoB,IAApB;AACD;AACF;;kBAKDyD,+CAAmB,CAKlB;;kBAKDC,iEAA4B;AAC1B,UAAIvlB,KAAK,IAAT;AACA,WAAKwgB,gBAAL,GAAwB,IAAxB;;AAEA,WAAKK,WAAL,GAAmB,EAAnB;;AAGA,WAAK2E,kBAAL,GAA0B9O,OAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CACxB,KAAKhD,SADmB,EAExB,OAFwB,EAGxB,UAASrL,KAAT,EAAgB;AACdtL,UAAE,SAAF,EAAa6gB,IAAb;;AAEA,YAAI9gB,GAAGygB,UAAP,EAAmB;AACjBzgB,aAAGygB,UAAH,CAAcoB,MAAd,CAAqB,IAArB;AACA7hB,aAAGygB,UAAH,GAAgB,IAAhB;AACD;;AAEDzgB,WAAG6gB,WAAH,CAAe9H,QAAf,GAA0BxN,MAAMka,MAAN,CAAarO,GAAb,GAAmBsO,WAAnB,CAA+B,CAA/B,CAA1B;AACA1lB,WAAG6gB,WAAH,CAAe7H,SAAf,GAA2BzN,MAAMka,MAAN,CAAapO,GAAb,GAAmBqO,WAAnB,CAA+B,CAA/B,CAA3B;;AAGA1lB,WAAGygB,UAAH,GAAgBzgB,GAAG8hB,gBAAH,CACdvW,MAAMka,MADQ,EAEd,MAFc,uGAAhB;AAOD,OAtBuB,CAA1B;AAwBD;;kBAKDE,iEAA4B;AAC1B,WAAKnF,gBAAL,GAAwB,KAAxB;;AAEA,WAAKC,UAAL,CAAgBoB,MAAhB,CAAuB,IAAvB;;AAEAnL,aAAOC,IAAP,CAAYpL,KAAZ,CAAkBqa,cAAlB,CAAiC,KAAKJ,kBAAtC;AACD;;kBAKDK,2CAAiB;AAAA;;AACf,UAAI7lB,KAAK,IAAT;AACAvB,cAAQiB,GAAR,CAAY,gBAAZ;AACA,UAAI,CAAC,KAAKmhB,WAAL,CAAiBjc,IAAtB,EAA4B;AAC1B,aAAKic,WAAL,CAAiBjc,IAAjB,GAAwB9F,IAAIF,MAAJ,CAAWkJ,aAAX,CAAyB,CAAzB,CAAxB;AACD;AACD,UACE,KAAK+Y,WAAL,CAAiBxhB,IAAjB,IACA,KAAKwhB,WAAL,CAAiB9H,QADjB,IAEA,KAAK8H,WAAL,CAAiB7H,SAHnB,EAIE;AACA,aAAK/P,MAAL,CACG6J,IADH,CACQ,WADR,EACqB;AACjBzT,gBAAMW,GAAG6gB,WAAH,CAAexhB,IADJ;AAEjBuF,gBAAM5E,GAAG6gB,WAAH,CAAejc,IAFJ;AAGjBmU,oBAAU/Y,GAAG6gB,WAAH,CAAe9H,QAHR;AAIjBC,qBAAWhZ,GAAG6gB,WAAH,CAAe7H;AAJT,SADrB,EAOGxO,IAPH,CAOQ,eAAO;AACX,cAAI6B,GAAJ,EAAS;AACP,mBAAKgV,mBAAL;AACA,mBAAKsE,yBAAL;AACD;AACF,SAZH;AAaD,OAlBD,MAkBO;AACLpjB,oBAAYC,KAAZ,CAAkB,yCAAlB,EAA6D,IAA7D;AACD;AACF;;kBAMDsjB,iEAA4B;AAC1B,WAAKC,gBAAL,GAAwB,IAAxB;AACA,WAAKhF,WAAL,GAAmB,EAAnB;;AAGA,WAAKiF,2BAAL;AACD;;kBAKDC,iEAA4B;AAC1B,WAAKF,gBAAL,GAAwB,KAAxB;;AAEA,WAAKG,cAAL;;AAEA,WAAKC,2BAAL;AACD;;kBAKDC,2CAAiB;AAAA;;AACf,UAAIpmB,KAAK,IAAT;;AAEA,UAAI,CAAC,KAAK+gB,WAAL,CAAiBnc,IAAtB,EAA4B;AAC1B,aAAKmc,WAAL,CAAiBnc,IAAjB,GAAwB9F,IAAIF,MAAJ,CAAWmJ,aAAX,CAAyB,CAAzB,CAAxB;AACD;AACD,UAAI,KAAKgZ,WAAL,CAAiBG,SAAjB,IACF,KAAKH,WAAL,CAAiB1hB,IADf,IAEF,KAAK0hB,WAAL,CAAiBkD,QAFnB,EAGE;AACAxlB,gBAAQiB,GAAR,CAAY,KAAKqhB,WAAjB;AACA,aAAK9X,MAAL,CACG6J,IADH,CACQ,WADR,EACqB9S,GAAG+gB,WADxB,EAEGvW,IAFH,CAEQ,eAAO;AACX,cAAI6B,GAAJ,EAAS;AACP,mBAAKiV,mBAAL;AACA,mBAAK2E,yBAAL;AACD;AACF,SAPH;AAQD,OAbD,MAaO;AACL1jB,oBAAYC,KAAZ,CAAkB,yCAAlB,EAA6D,IAA7D;AACD;AACF;;kBAMD8e,qDAAsB;AAIpB,UAAI1iB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACE9B,iBAAO,MADT;AAEE9F,iBAAO,UAFT;AAGE6N,oBAAU;AAHZ,SADO,EAMP;AACEA,oBAAU;AADZ,SANO,EASP;AACE/H,iBAAO,MADT;AAEE9F,iBAAO,MAFT;AAGE8lB,+BAAqB,wBAHvB;AAIE/H,kBAAQ;AAJV,SATO;AADX,OAFW,EAoBX9d,IAAIF,MAAJ,CAAWoF,IApBA,CAAb;;AAwBApF,aAAOqF,OAAP,GAAiB,IAAjB;AACArF,aAAOmI,QAAP,GAAkB,KAAlB;AACAnI,aAAOgmB,UAAP,GAAoB,KAApB;AACAhmB,aAAOoI,QAAP,GAAkB,KAAlB;AACApI,aAAOgI,SAAP,GAAmB,KAAnB;;AAEAhI,aAAOuC,MAAP,GAAgB,MAAhB;;AAGAvC,aAAO2F,UAAP,CAAkB2B,QAAlB,GAA6B,IAA7B;;AAGAtH,aAAO2F,UAAP,CAAkBsgB,KAAlB,GAA0B;AACxBlgB,eAAO,MADiB;AAExBmgB,aAAK,KAFmB;AAGxBC,oBAAY,CAAC,EAAEpgB,OAAO,MAAT,EAAiBqgB,WAAW,OAA5B,EAAD;AAHY,OAA1B;;AAOApmB,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,WAA3D;;AAGA,WAAKU,IAAL,GAAY/D,EAAE,gBAAF,EAAoBuN,SAApB,CAA8B5O,MAA9B,CAAZ;AACD;;kBAMDonB,qEAA8B;AAC5B,UAAIhmB,KAAK,IAAT;AACA,UAAI,KAAKqmB,cAAT,EAAyB;AAEvB,aAAKA,cAAL,CAAoBxE,MAApB,CAA2B,KAAKjL,SAAhC;AACD,OAHD,MAGO;AAAA,YAwCI0P,cAxCJ,GAwCL,SAASA,cAAT,GAA0B;AACxB,cAAIC,aAAJ,EAAmB;AACjBA,0BAAcC,WAAd,CAA0B,KAA1B;AACAD,4BAAgB,IAAhB;AACD;AACF,SA7CI;;AAAA,YA+CIE,YA/CJ,GA+CL,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AAC3BjoB,kBAAQiB,GAAR,CAAY,cAAZ;AACA4mB;AACAC,0BAAgBG,KAAhB;AACAA,gBAAMF,WAAN,CAAkB,IAAlB;AAGD,SAtDI;;AAAA,YAwDIG,mBAxDJ,GAwDL,SAASA,mBAAT,GAA+B;AAC7B,cAAIJ,aAAJ,EAAmB;AACjBA,0BAAc1E,MAAd,CAAqB,IAArB;AACD;AACF,SA5DI;;AAAA,YA+DI+E,aA/DJ,GA+DL,SAASA,aAAT,CAAuBC,UAAvB,EAAmC3nB,GAAnC,EAAwC;AAEtC,cAAI4nB,YAAYlc,SAASmc,aAAT,CAAuB,KAAvB,CAAhB;AACAD,oBAAUnP,KAAV,CAAgBxJ,eAAhB,GAAkC,MAAlC;AACA2Y,oBAAUnP,KAAV,CAAgBqP,MAAhB,GAAyB,gBAAzB;AACAF,oBAAUnP,KAAV,CAAgBsP,YAAhB,GAA+B,KAA/B;AACAH,oBAAUnP,KAAV,CAAgBuP,SAAhB,GAA4B,0BAA5B;AACAJ,oBAAUnP,KAAV,CAAgBwP,MAAhB,GAAyB,SAAzB;AACAL,oBAAUnP,KAAV,CAAgByP,YAAhB,GAA+B,MAA/B;AACAN,oBAAUnP,KAAV,CAAgB0P,SAAhB,GAA4B,QAA5B;AACAP,oBAAUjoB,KAAV,GAAkB,4BAAlB;AACAgoB,qBAAWS,WAAX,CAAuBR,SAAvB;;AAGA,cAAIS,cAAc3c,SAASmc,aAAT,CAAuB,KAAvB,CAAlB;AACAQ,sBAAY5P,KAAZ,CAAkBgG,KAAlB,GAA0B,eAA1B;AACA4J,sBAAY5P,KAAZ,CAAkB6P,UAAlB,GAA+B,yBAA/B;AACAD,sBAAY5P,KAAZ,CAAkB8P,QAAlB,GAA6B,MAA7B;AACAF,sBAAY5P,KAAZ,CAAkB+P,UAAlB,GAA+B,MAA/B;AACAH,sBAAY5P,KAAZ,CAAkBgQ,WAAlB,GAAgC,KAAhC;AACAJ,sBAAY5P,KAAZ,CAAkBiQ,YAAlB,GAAiC,KAAjC;AACAL,sBAAYpP,SAAZ,GAAwB,sBAAxB;AACA2O,oBAAUQ,WAAV,CAAsBC,WAAtB;;AAGAT,oBAAUe,gBAAV,CAA2B,OAA3B,EAAoC,YAAW;AAC7ClB;AACD,WAFD;AAGD,SA3FI;;AACL3mB,WAAG8nB,YAAH,GAAkB,EAAlB;AACA,YAAIvB,sBAAJ;AACA,aAAKF,cAAL,GAAsB,IAAI3P,OAAOC,IAAP,CAAYoR,OAAZ,CAAoBC,cAAxB,CAAuC;AAE3DC,0BAAgB,IAF2C;AAG3DC,iCAAuB;AACrBlZ,sBAAU0H,OAAOC,IAAP,CAAYyB,eAAZ,CAA4B+P,UADjB;AAErBC,0BAAc,CAEZ1R,OAAOC,IAAP,CAAYoR,OAAZ,CAAoBM,WAApB,CAAgCC,MAFpB,EAGZ5R,OAAOC,IAAP,CAAYoR,OAAZ,CAAoBM,WAApB,CAAgCE,OAHpB,EAIZ7R,OAAOC,IAAP,CAAYoR,OAAZ,CAAoBM,WAApB,CAAgCG,SAJpB;AAFO,WAHoC;AAY3DC,yBAAe;AACb1N,uBAAW,SADE;AAEbsJ,yBAAa,GAFA;AAGbD,0BAAc,CAHD;AAIbsE,uBAAW,KAJE;AAKbC,sBAAU,IALG;AAMb3G,oBAAQ;AANK,WAZ4C;AAoB3D4G,0BAAgB;AACdF,uBAAW,IADG;AAEdjR,uBAAW,IAFG;AAGdkR,sBAAU,IAHI;AAId5N,uBAAW,SAJG;AAKdsJ,yBAAa;;AALC,WApB2C;AA4B3DwE,4BAAkB;AAChBH,uBAAW,IADK;AAEhBjR,uBAAW,IAFK;AAGhBkR,sBAAU,IAHM;AAIhB5N,uBAAW,SAJK;AAKhBsJ,yBAAa;AALG;AA5ByC,SAAvC,CAAtB;;AA0FA,aAAKgC,cAAL,CAAoBxE,MAApB,CAA2B7hB,GAAG4W,SAA9B;;AAEA,YAAIkS,mBAAmB,SAAnBA,gBAAmB,CAASC,QAAT,EAAmB;AACxCtqB,kBAAQiB,GAAR,CAAY,YAAZ;AACA,cAAI0a,MAAM2O,SAASC,OAAT,GAAmBC,SAAnB,EAAV;AACA,eAAK,IAAIziB,IAAI,CAAb,EAAgBA,IAAI4T,GAApB,EAAyB5T,GAAzB,EAA8B;AAC5B/H,oBAAQiB,GAAR,CAAYqpB,SAASC,OAAT,GAAmBE,KAAnB,CAAyB1iB,CAAzB,EAA4B2iB,UAA5B,CAAuC,CAAvC,CAAZ;AACD;AACF,SAND;;AAQAzS,eAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8B,KAAKyM,cAAnC,EAAmD,iBAAnD,EAAsE,UAAS9a,KAAT,EAAgB;AACpFA,gBAAMyd,OAAN,GAAgBC,SAAhB;AACA,cAAI1d,MAAM3G,IAAN,KAAe,SAAnB,EAA8B;AAC5B5E,eAAG+gB,WAAH,CAAekD,QAAf,GAA0B,EAA1B;AACAjkB,eAAG+gB,WAAH,CAAekD,QAAf,CAAwBrf,IAAxB,GAA+B2G,MAAM3G,IAArC;AACA5E,eAAGopB,YAAH,CAAgB7d,MAAMyd,OAAN,EAAhB,EAAiC,UAACK,MAAD,EAAU;AACzCrpB,iBAAG+gB,WAAH,CAAekD,QAAf,CAAwBQ,IAAxB,GAA+B4E,MAA/B;AACD,aAFD;AAGD;AACD3S,iBAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BrO,MAAMyd,OAAN,EAA9B,EAA+C,WAA/C,EAA4D,YAAW;AACrEhpB,eAAGopB,YAAH,CAAgB7d,MAAMyd,OAAN,EAAhB,EAAiC,UAACK,MAAD,EAAU;AACzCrpB,iBAAG+gB,WAAH,CAAekD,QAAf,CAAwBQ,IAAxB,GAA+B4E,MAA/B;AACD,aAFD;AAGD,WAJD;AAKA3S,iBAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BrO,MAAMyd,OAAN,EAA9B,EAA+C,QAA/C,EAAyD,YAAW;AAClEhpB,eAAGopB,YAAH,CAAgB7d,MAAMyd,OAAN,EAAhB,EAAiC,UAACK,MAAD,EAAU;AACzCrpB,iBAAG+gB,WAAH,CAAekD,QAAf,CAAwBQ,IAAxB,GAA+B4E,MAA/B;AACD,aAFD;AAMD,WAPD;AAQD,SAtBD;;AAwBA3S,eAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8B,KAAKyM,cAAnC,EAAmD,iBAAnD,EAAsE,UAAS9a,KAAT,EAAgB;AACpFvL,aAAG8nB,YAAH,CAAgB5a,IAAhB,CAAqB3B,KAArB;;AAEA,cAAIA,MAAM3G,IAAN,KAAe,QAAnB,EAA6B;AAC3B5E,eAAG+gB,WAAH,CAAekD,QAAf,GAA0B,EAA1B;AACAjkB,eAAG+gB,WAAH,CAAekD,QAAf,CAAwBrf,IAAxB,GAA+B2G,MAAM3G,IAArC;AACA5E,eAAG+gB,WAAH,CAAekD,QAAf,CAAwB9M,MAAxB,GAAiC5L,MAAM+d,OAAN,CAAcC,SAAd,EAAjC;AACAvpB,eAAG+gB,WAAH,CAAekD,QAAf,CAAwBK,MAAxB,GAAiC/Y,MAAM+d,OAAN,CAAcE,SAAd,EAAjC;AAED,WAND,MAMO,IAAIje,MAAM3G,IAAN,KAAe,WAAnB,EAAgC;AACrC5E,eAAG+gB,WAAH,CAAekD,QAAf,GAA0B,EAA1B;AACAjkB,eAAG+gB,WAAH,CAAekD,QAAf,CAAwBrf,IAAxB,GAA+B2G,MAAM3G,IAArC;AACA5E,eAAG+gB,WAAH,CAAekD,QAAf,CAAwBS,MAAxB,GAAiCnZ,MAAM+d,OAAN,CAAcG,SAAd,EAAjC;AACD;AACD,cAAIle,MAAM3G,IAAN,KAAe8R,OAAOC,IAAP,CAAYoR,OAAZ,CAAoBM,WAApB,CAAgCqB,MAAnD,EAA2D;AACzD1pB,eAAGqmB,cAAH,CAAkBsD,cAAlB,CAAiC,IAAjC;;;AAGA,gBAAIZ,WAAWxd,MAAM+d,OAArB;AACAP,qBAASnkB,IAAT,GAAgB2G,MAAM3G,IAAtB;AACA8R,mBAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BmP,QAA9B,EAAwC,OAAxC,EAAiD,YAAW;AAC1DtC,2BAAasC,QAAb;AACD,aAFD;;AAIAtC,yBAAasC,QAAb;AACD;AACF,SA1BD;;AA6BA,YAAIa,mBAAmBhf,SAASmc,aAAT,CAAuB,KAAvB,CAAvB;AACA,YAAI8C,gBAAgB,IAAIjD,aAAJ,CAAkBgD,gBAAlB,EAAoC5pB,GAAG4W,SAAvC,CAApB;;AAEAgT,yBAAiB/K,KAAjB,GAAyB,CAAzB;AACA7e,WAAG4W,SAAH,CAAahB,QAAb,CAAsBc,OAAOC,IAAP,CAAYyB,eAAZ,CAA4B0R,aAAlD,EAAiE5c,IAAjE,CAAsE0c,gBAAtE;AACD;AACF;;kBAED1D,2CAAiB;AACf,WAAK,IAAI1f,IAAI,CAAb,EAAgBA,IAAI,KAAKshB,YAAL,CAAkBphB,MAAtC,EAA8CF,GAA9C,EAAmD;AACjD,aAAKshB,YAAL,CAAkBthB,CAAlB,EAAqB8iB,OAArB,CAA6BzH,MAA7B,CAAoC,IAApC;AACD;AACD,WAAKiG,YAAL,GAAoB,EAApB;AACD;;kBAED3B,qEAA8B;AAE5B,WAAKE,cAAL,CAAoBxE,MAApB,CAA2B,IAA3B;AACD;;kBAMDuH,qCAAa3E,MAAMtY,UAAU;AAC3B,UAAIiO,MAAMqK,KAAK/d,MAAf;AACA,UAAI2iB,SAAS,EAAb;AACA,WAAK,IAAI7iB,IAAI,CAAb,EAAgBA,IAAI4T,GAApB,EAAyB5T,GAAzB,EAA8B;AAC5B6iB,eAAOnc,IAAP,CAAY;AACVkK,eAAKqN,KAAKyE,KAAL,CAAW1iB,CAAX,EAAc4Q,GAAd,EADK;AAEVC,eAAKoN,KAAKyE,KAAL,CAAW1iB,CAAX,EAAc6Q,GAAd;AAFK,SAAZ;AAID;;AAEDlL,kBAAYA,SAASkd,MAAT,CAAZ;AACD;;kBAKDrW,mCAAa;AACXvU,cAAQC,IAAR,CAAa,gBAAb;AACA,WAAK2jB,aAAL;AACD;;;;;;;;;;;;;;;;;;;;;MCnxCU0H,mBAAAA,mBADZ;AAoCC,sBAAYhf,IAAZ,EAAkBif,QAAlB,EAA4B;AAAA;;AAAA,WAjC5BlrB,GAiC4B,GAjCtBA,GAiCsB;AAAA,WA/B5BmN,OA+B4B,GA/BlB,IA+BkB;AAAA,WAzB5BmJ,UAyB4B,GAzBf;AACXC,yBAAiB,KADN;AAEXC,qBAAa,IAFF;AAGXC,iBAAS,IAHE;AAIXC,kBAAU,KAJC;AAKXC,qBAAa;AALF,OAyBe;AAAA,WAjB5BC,OAiB4B,GAjBlB,EAiBkB;AAAA,WAb5B+K,UAa4B,GAbf,IAae;AAAA,WAP5BC,cAO4B,GAPX,EAOW;AAAA,WAJ5BuJ,YAI4B,GAJb,EAIa;AAAA,WAF5Bhf,KAE4B,GAFpB,EAEoB;;AAC1B,WAAKhC,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK+gB,QAAL,GAAgBA,QAAhB;AACD;;uBAEDlqB,+BAAW;AACT,UAAIE,KAAK,IAAT;AAeD;;uBAMDyW,2BAAQtK,UAAU;AAChB1N,cAAQiB,GAAR,CAAY,SAAZ;;AAGA,WAAKoX,YAAL,GAAoB,IAAIJ,OAAOC,IAAP,CAAYI,YAAhB,EAApB;;AAEA,WAAKH,SAAL,GAAiB,IAAIF,OAAOC,IAAP,CAAYK,GAAhB,CACfpM,SAASqM,cAAT,CAAwB,aAAxB,CADe,EAEf;AACEC,cAAM,EADR;AAEEC,gBAAQ,EAAEC,KAAK,EAAP,EAAWC,KAAK,EAAhB,EAFV;AAGEC,mBAAWZ,OAAOC,IAAP,CAAY4K,SAAZ,CAAsBC,OAHnC;AAIEjK,wBAAgB,IAJlB;AAKEC,qBAAa,KALf;AAMEC,mBAAW,IANb;AAOEyS,gBAAQ,CACN;AACEC,uBAAa,mBADf;AAEEC,uBAAa,eAFf;AAGEC,mBAAS,CAAC,EAAEC,YAAY,IAAd,EAAD,EAAuB,EAAE3M,OAAO,SAAT,EAAvB;AAHX,SADM,EAMN;AACEwM,uBAAa,KADf;AAEEC,uBAAa,eAFf;AAGEC,mBAAS,CACP,EAAEC,YAAY,IAAd,EADO,EAEP,EAAEC,KAAK,SAAP,EAFO,EAGP,EAAE5M,OAAO,SAAT,EAHO;AAHX,SANM,EAeN;AACEwM,uBAAa,MADf;AAEEC,uBAAa,UAFf;AAGEC,mBAAS,CAAC,EAAEG,WAAW,GAAb,EAAD,EAAqB,EAAEF,YAAY,YAAd,EAArB;AAHX,SAfM,EAoBN;AACEH,uBAAa,MADf;AAEEC,uBAAa,QAFf;AAGEC,mBAAS,CAAC,EAAEC,YAAY,KAAd,EAAD;AAHX,SApBM,EAyBN;AACEH,uBAAa,cADf;AAEEC,uBAAa,UAFf;AAGEC,mBAAS,CAAC,EAAEC,YAAY,IAAd,EAAD,EAAuB,EAAEE,WAAW,GAAb,EAAvB;AAHX,SAzBM,EA8BN;AACEL,uBAAa,OADf;AAEEC,uBAAa,KAFf;AAGEC,mBAAS,CAAC,EAAE1M,OAAO,SAAT,EAAD;AAHX,SA9BM,CAPV;AA2CEjG,+BAAuB;AACrBC,iBAAOjB,OAAOC,IAAP,CAAYiB,mBAAZ,CAAgCC;AADlB,SA3CzB;AA8CEC,2BAAmB,KA9CrB;AA+CEC,kCAA0B;AACxBJ,iBAAOjB,OAAOC,IAAP,CAAYqB,sBAAZ,CAAmCC;AADlB;AA/C5B,OAFe,CAAjB;;AAwDA,WAAKC,YAAL,CAAkB,KAAKtB,SAAvB;;;AAWAzK;AACD;;uBAKD+L,qCAAahZ,KAAK;AAChB,UAAI6P,SAAS,KAAKA,MAAlB;AACAA,aAAOoJ,SAAP;AAaAjZ,UAAI0W,QAAJ,CAAac,OAAOC,IAAP,CAAYyB,eAAZ,CAA4BC,SAAzC,EAAoDnL,IAApD,CAAyD6B,MAAzD;AACD;;uBAMDoS,iDAAmBhV,UAAU;AAC3B,UAAInM,KAAK,IAAT;AACA,WAAKyqB,UAAL,GAAkB,IAAlB;AACA,UAAI,KAAKnS,aAAT,EAAwB;AACtB,aAAKC,aAAL;AACD;;AAED,WAAK7C,OAAL,GAAe,EAAf;;AAEA,WAAKzM,MAAL,CAAYmD,GAAZ,CAAgB,aAAhB,EAA+B5B,IAA/B,CAAoC,eAAO;AACzC,YAAI6B,OAAOA,IAAIhK,IAAf,EAAqB;AACnB5D,kBAAQC,IAAR,CAAa,KAAb;;AADmB,qCAEV8H,CAFU;AAGjB,gBAAIgS,aAAanM,IAAIhK,IAAJ,CAASmE,CAAT,CAAjB;AACA,gBAAIiS,aAAa,IAAI/B,OAAOC,IAAP,CAAY+B,UAAhB,CAA2B;AAC1CjG,iuBAe8D+F,WAAWG,MAAX,CAAkBtL,GAfhF,WAewFmL,WAAWG,MAAX,CAAkBtZ,IAf1G,6OAmBsCmZ,WAAWG,MAAX,CAAkBrW,MAAlB,IAA4B,GAnBlE,6OAuBsCkW,WAAWI,SAvBjD,4OA2BsC9Z,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgByJ,QAAhB,CAAyBN,WAAW1S,SAApC,EAA+ChH,IAAIC,WAAJ,CAAgBuJ,cAA/D,CA3BtC,0OA+BsCkQ,WAAWO,QA/BjD,UA+B8DP,WAAWQ,SA/BzE,ifAyCsCR,WAAWhV,YAAX,IAA2B,GAzCjE,qPA6CsCgV,WAAWS,eAAX,IAA8B,GA7CpE,kPAiDsCT,WAAWU,kBAAX,IAAiC,GAjDvE,qPAqDsCpa,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqBX,WAAWY,wBAAhC,EAA0D,aAA1D,KAA4E,GArDlH,gPAyDsCta,IAAI+Z,IAAJ,CAASxJ,MAAT,CAAgB8J,IAAhB,CAAqBX,WAAWa,WAAhC,EAA6C,UAA7C,KAA4D,GAzDlG;AAD0C,aAA3B,CAAjB;;AAoEA,gBAAIC,UAAU,+BAAd;AACA,gBACEd,WAAWG,MAAX,CAAkBrW,MAAlB,IAA4BkW,WAAWG,MAAX,CAAkBrW,MAAlB,KAA6B,UAD3D,EAEE;AACA,sBAAQkW,WAAWG,MAAX,CAAkBrW,MAA1B;AACA,qBAAK,aAAL;AACEgX,4BAAU,mCAAV;AACA;;AAEF,qBAAK,gBAAL;AACEA,4BAAU,sCAAV;AACA;;AAEF;AAEE;AAXF;AAaD,aAhBD,MAgBO;AACL,kBAAId,WAAWG,MAAX,IAAqBH,WAAWG,MAAX,CAAkBpV,QAAlB,CAA2BC,YAApD,EAAkE;AAChE,wBAAQgV,WAAWG,MAAX,CAAkBpV,QAAlB,CAA2BC,YAA3B,CAAwCwB,KAAhD;AACA,uBAAK,IAAL;AACEsU,8BAAU,0BAAV;AACA;;AAEF,uBAAK,KAAL;AACEA,8BAAU,2BAAV;AACA;;AAEF;AAEE;AAXF;AAaD;AACF;;AAED,gBAAIC,SAAS,IAAI7C,OAAOC,IAAP,CAAY6C,MAAhB,CAAuB;AAClCxK,wBAAU;AACRoI,qBAAKqC,WAAWjB,WAAWO,QAAtB,CADG;AAER1B,qBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFG,eADwB;AAKlCna,qBAAO2Z,WAAWkB,SALgB;AAMlCC,oBAAML,OAN4B;AAOlCpa,mBAAKc,GAAG4W,SAP0B;AAQlC7K,kBAAIyM,WAAWkB;AARmB,aAAvB,CAAb;;AAYAH,mBAAOK,WAAP,CAAmB,OAAnB,EAA4B,YAAW;AACrCnB,yBAAW7W,IAAX,CAAgB5B,GAAG4W,SAAnB,EAA8B2C,MAA9B;AACD,aAFD;;AAIA7C,mBAAOC,IAAP,CAAYpL,KAAZ,CAAkBqO,WAAlB,CAA8BnB,UAA9B,EAA0C,UAA1C,EAAsD,UAASpU,CAAT,EAAY;AAEhEpE,gBAAE,WAAF,EAAeyB,aAAf,CAA6B;AAC3BC,2BAAW;AACTC,wBAAM;AACJC,6BAAS;AADL;AADG;AADgB,eAA7B;;AAQA,kBAAIgY,UAAU5Z,EAAE,cAAF,CAAd;AACA,kBAAI6Z,eAAeD,QAAQE,IAAR,EAAnB;;AAEAD,2BAAaE,QAAb,CAAsB,eAAtB,EAAuCC,GAAvC,CAA2C,EAAEC,SAAS,MAAX,EAA3C;;AAEAJ,2BAAaE,QAAb,CAAsB,eAAtB,EAAuCC,GAAvC,CAA2C,EAAEC,SAAS,MAAX,EAA3C;AACD,aAhBD;;AAmBAla,eAAG0V,OAAH,CAAWxI,IAAX,CAAgBqM,MAAhB;;AAGAvZ,eAAG8W,YAAH,CAAgBvK,MAAhB,CAAuB;AACrB6K,mBAAKqC,WAAWjB,WAAWO,QAAtB,CADgB;AAErB1B,mBAAKoC,WAAWjB,WAAWQ,SAAtB;AAFgB,aAAvB;AAjJiB;;AAEnB,eAAK,IAAIxS,IAAI,CAAb,EAAgBA,IAAI6F,IAAIhK,IAAJ,CAASqE,MAA7B,EAAqCF,GAArC,EAA0C;AAAA,kBAAjCA,CAAiC;AAmJzC;;AAGD,cAAIxG,GAAGoV,UAAH,CAAcG,OAAlB,EAA2B;AACzBvV,eAAGuV,OAAH;AACD;;AAGD,cAAIvV,GAAGoV,UAAH,CAAcK,WAAlB,EAA+B;AAC7BzV,eAAGma,WAAH;AACD;;AAGDhO,sBAAYA,UAAZ;AACD;AACF,OArKD;AAsKD;;uBAKDoJ,6BAAU;AACR,UAAI6E,MAAM,KAAK1E,OAAL,CAAahP,MAAvB;AACA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAI4T,GAApB,EAAyB5T,GAAzB,EAA8B;AAE5B,aAAKkP,OAAL,CAAalP,CAAb,EAAgBtH,GAAhB,IAAuB,KAAK4X,YAAL,CAAkBvK,MAAlB,CAAyB,KAAKmJ,OAAL,CAAalP,CAAb,EAAgBwI,QAAzC,CAAvB;AACD;;AAED,WAAK4H,SAAL,CAAeyD,SAAf,CAAyB,KAAKvD,YAA9B;AACD;;uBAKDqD,qCAAc;AACZ,WAAKG,eAAL,GAAuB,IAAIC,eAAJ,CAAoB,KAAK3D,SAAzB,EAAoC,KAAKlB,OAAzC,EAAkD;AACvE8E,mBAAW;AAD4D,OAAlD,CAAvB;AAGD;;uBAKDkQ,uDAAuB;AAAA;;AACrB,UAAInmB,aAAa,EAAjB;AACA,UAAIkK,aAAa,EAAjB;AACA,UAAIU,SAAS,EAAb;AACA,WAAKwb,qBAAL,GAA6B,IAA7B;AACA,WAAK1hB,MAAL,CACGmD,GADH,CACO,mDADP,EAEG5B,IAFH,CAEQ,eAAO;AACX,YAAI6B,OAAOA,IAAIhK,IAAf,EAAqB;AACnB,eAAK,IAAImE,IAAI,CAAb,EAAgBA,IAAI6F,IAAIhK,IAAJ,CAASqE,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,gBAAIokB,MAAM5O,OAAO,IAAIC,IAAJ,EAAP,EAAmB5M,MAAnB,CAA0B,MAA1B,CAAV;AACAZ,uBAAWvB,IAAX,CAAgBb,IAAIhK,IAAJ,CAASmE,CAAT,EAAYqkB,QAAZ,CAAqBxrB,IAArC;AACA,gBAAI,CAACkF,WAAWqmB,GAAX,CAAL,EAAsB;AACpBrmB,yBAAWqmB,GAAX,IAAkB,CAACve,IAAIhK,IAAJ,CAASmE,CAAT,EAAYzC,aAAb,CAAlB;AACD,aAFD,MAEO;AACLQ,yBAAWqmB,GAAX,EAAgB1d,IAAhB,CAAqBb,IAAIhK,IAAJ,CAASmE,CAAT,EAAYzC,aAAjC;AACD;AACF;AACD,eAAK,IAAI+mB,GAAT,IAAgBvmB,UAAhB,EAA4B;AAC1B4K,mBAAOjC,IAAP,CAAY;AACV7N,oBAAMyrB,GADI;AAEVzoB,oBAAMkC,WAAWumB,GAAX;AAFI,aAAZ;AAID;;AAGD7qB,YAAE,iBAAF,EAAqB2O,UAArB,CAAgC;AAC9B/P,mBAAO;AACLgQ,oBAAM;AADD,aADuB;AAI9BC,mBAAO,UAJuB;AAK9BC,oBAAQ;AACNC,wBAAU;AADJ,aALsB;AAQ9BC,4BAAgB;AACdrK,oBAAM;AADQ,aARc;AAW9BsK,0BAAc,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,CAXgB;AAY9BC,oBAAQA,MAZsB;AAa9BC,uBAAW;AACTtB,sBAAQ;AACNuB,wBAAQ;AADF,eADC;AAITC,oBAAM;AACJC,yBAAS;AADL,eAJG;AAOTC,iCAAmB;AAPV,aAbmB;AAsB9BC,0BAAc;AACZhB,0BAAYA,UADA;AAEZa,oBAAM;AACJC,yBAAS;AADL;AAFM,aAtBgB;AA4B9BzN,qBAAS;AACPyN,uBAAS,IADF;AAEPF,sBAAQ,SAFD;AAGP3C,wBAAU;AAHH;AA5BqB,WAAhC;AAkCA,gBAAKie,qBAAL,GAA6B,KAA7B;AACD;AACF,OAzDH;AA0DD;;uBAKDI,mFAAqC;AAAA;;AACnC,UAAI/qB,KAAK,IAAT;AACA,WAAKgrB,gCAAL,GAAwC,IAAxC;AACA,WAAKC,mCAAL,GAA2C,IAA3C;AACA,WAAKhiB,MAAL,CAAYmD,GAAZ,CAAgB,sCAAhB,EAAwD5B,IAAxD,CAA6D,eAAO;AAClE,YAAI6B,GAAJ,EAAS;AACP,cAAIA,IAAIhK,IAAR,EAAc;AACZ,mBAAK4nB,YAAL,GAAoB5d,IAAIhK,IAAJ,CAAS6oB,OAA7B;AACA,mBAAKC,oBAAL,GAA4B9e,IAAIhK,IAAJ,CAAS+oB,QAAT,GACxB/e,IAAIhK,IAAJ,CAAS+oB,QADe,GAExB,IAFJ;;AAIA,gBAAI1Q,MAAM9P,SAASqM,cAAT,CAAwB,gBAAxB,CAAV;AACAjX,eAAGiL,KAAH,CAASogB,yBAAT,GAAqC,iBAAU3Q,GAAV,EAAe;AAClD9V,oBAAM,KAD4C;AAElDvC,oBAAM;AACJyL,wBAAQ,CAAC,iBAAD,EAAoB,aAApB,EAAmC,SAAnC,CADJ;AAEJC,0BAAU,CACR;AACE1L,wBAAM,CACJrC,GAAGiqB,YAAH,CAAgBqB,cADZ,EAEJtrB,GAAGiqB,YAAH,CAAgBsB,WAFZ,EAGJvrB,GAAGiqB,YAAH,CAAgBuB,OAHZ,CADR;AAMErd,mCAAiB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,CANnB;AAOEC,wCAAsB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC;AAPxB,iBADQ;AAFN;AAF4C,aAAf,CAArC;AAiBD;AACF;AACD,eAAK6c,mCAAL,GAA2C,KAA3C;AACD,OA7BD;AA8BD;;uBAKDQ,+CAAmB;AACjB,UAAI7sB,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACE9B,iBAAO,aADT;AAEE9F,iBAAO,OAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI,WAHd;AAQEJ,oBAAU;AARZ,SADO,EAWP;AACE/H,iBAAO,MADT;AAEE9F,iBAAO,OAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SAXO,EAoBP;AACEnI,iBAAO,aADT;AAEE9F,iBAAO,cAFT;AAGE6N,oBAAU;AAHZ,SApBO;AADX,OAFW,EA8BX5N,IAAIF,MAAJ,CAAWoF,IA9BA,CAAb;;AAkCApF,aAAO0H,SAAP,GAAmB,YAAW,CAE7B,CAFD;;AAKA1H,aAAOqF,OAAP,GAAiB,IAAjB;;AAEArF,aAAOgI,SAAP,GAAmB,KAAnB;;AAEAhI,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,QAA3D;;AAEA1E,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiClD,IAAjC,GAAwC;AACtCsJ,gBAAQ;AAD8B,OAAxC;;AAIA/M,aAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,CACzB;AACExI,eAAO,WADT;AAEEmI,kBAAU,IAFZ;AAGE9H,eAAO;AAHT,OADyB,CAA3B;;AASA,WAAKhB,IAAL,GAAY/D,EAAE,aAAF,EAAiBuN,SAAjB,CAA2B5O,MAA3B,CAAZ;AACD;;uBAKDoU,mCAAa;AACXvU,cAAQC,IAAR,CAAa,qBAAb;AAED;;;;;;;;;;;;;;;;;;;;;MC7hBUgtB,kBAAAA,kBADZ;AASC,qBAAYntB,OAAZ,EAAqBwM,IAArB,EAA2B4gB,UAA3B,EAAuC;AAAA;;AAAA,WAPvC1f,OAOuC,GAP7B,IAO6B;AAAA,WAFvC2J,QAEuC,GAF5B,EAE4B;;AACrC,WAAK3M,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK0iB,UAAL,GAAkBA,UAAlB;AACA,WAAKptB,OAAL,GAAeA,OAAf;AACD;;sBAKDe,+BAAW;AAET,WAAKmF,KAAL,GAAakF,KAAKC,KAAL,CAAWnH,aAAamG,OAAb,CAAqB,aAArB,CAAX,CAAb;AACA,WAAKqD,OAAL,GAAe,KAAf;AACD;;sBAKDnM,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEAvB,cAAQiB,GAAR,CAAYM,GAAGyE,KAAf;;AAGA,WAAKmR,QAAL,CAAcgW,QAAd,GAAyB3rB,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AACpDtnB,oBAAYyX,OAAO8P,EAAP,CAAUC,KAAV,EADwC;AAEpD5e,gBAAQ,UAF4C;AAGpDyR,iBAAS,IAH2C;AAIpD5Z,eAAOhF,GAAGyE,KAAH,CAASmnB,QAAT,GAAoB5rB,GAAGyE,KAAH,CAASmnB,QAA7B,GAAwC;AAJK,OAA7B,CAAzB;;AAQA,WAAKhW,QAAL,CAAc1N,QAAd,GAAyBjI,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AACpDtnB,oBAAYzF,IAAIF,MAAJ,CAAWsJ,QAD6B;AAEpDiF,gBAAQ,UAF4C;AAGpDyR,iBAAS,IAH2C;AAIpD5Z,eAAOhF,GAAGyE,KAAH,CAASyD,QAAT,GAAoBlI,GAAGyE,KAAH,CAASyD,QAA7B,GAAwC;AAJK,OAA7B,CAAzB;;AAQA,WAAK0N,QAAL,CAAcxN,KAAd,GAAsBnI,EAAE,QAAF,EAAY4rB,aAAZ,CAA0B;AAC9CtnB,oBAAYzF,IAAIF,MAAJ,CAAWwJ,KADuB;AAE9C+E,gBAAQ,UAFsC;AAG9CyR,iBAAS,IAHqC;AAI9C5Z,eAAOhF,GAAGyE,KAAH,CAAS2D,KAAT,GAAiBpI,GAAGyE,KAAH,CAAS2D,KAA1B,GAAkC;AAJK,OAA1B,CAAtB;;AAQA,WAAKwN,QAAL,CAAczN,QAAd,GAAyBlI,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AACpDtnB,oBAAYzF,IAAIF,MAAJ,CAAWuJ,QAD6B;AAEpDgF,gBAAQ,UAF4C;AAGpDyR,iBAAS,IAH2C;AAIpD5Z,eAAOhF,GAAGyE,KAAH,CAASunB,CAAT,GAAahsB,GAAGyE,KAAH,CAAS0D,QAAtB,GAAiC;AAJY,OAA7B,CAAzB;;AAQA,WAAKyN,QAAL,CAAc3N,MAAd,GAAuBhI,EAAE,SAAF,EAAa4rB,aAAb,CAA2B;AAChDtnB,oBAAYzF,IAAIF,MAAJ,CAAWqJ,MADyB;AAEhDkF,gBAAQ,UAFwC;AAGhDyR,iBAAS,IAHuC;AAIhD5Z,eAAOhF,GAAGyE,KAAH,CAASwD,MAAT,GAAkBjI,GAAGyE,KAAH,CAASwD,MAA3B,GAAoC;AAJK,OAA3B,CAAvB;;AAQA,WAAK2N,QAAL,CAAcvN,WAAd,GAA4BpI,EAAE,cAAF,EAAkB4rB,aAAlB,CAAgC;AAC1DtnB,oBAAYzF,IAAIF,MAAJ,CAAWyJ,WADmC;AAE1D8E,gBAAQ,UAFkD;AAG1DyR,iBAAS,IAHiD;AAI1D5Z,eAAOhF,GAAGyE,KAAH,CAAS4D,WAAT,GAAuBrI,GAAGyE,KAAH,CAAS4D,WAAhC,GAA8C;AAJK,OAAhC,CAA5B;;AAQA,WAAKuN,QAAL,CAActN,cAAd,GAA+BrI,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AAC1DtnB,oBAAYzF,IAAIF,MAAJ,CAAW0J,cADmC;AAE1D6E,gBAAQ,UAFkD;AAG1DyR,iBAAS,IAHiD;AAI1D5Z,eAAOhF,GAAGyE,KAAH,CAAS6D,cAAT,GACHtI,GAAGyE,KAAH,CAAS6D,cADN,GAEH;AANsD,OAA7B,CAA/B;;AAUA,WAAKsN,QAAL,CAAcrN,UAAd,GAA2BtI,EAAE,OAAF,EAAW4rB,aAAX,CAAyB;AAClDtnB,oBAAYzF,IAAIF,MAAJ,CAAW2J,UAD2B;AAElD4E,gBAAQ,UAF0C;AAGlDyR,iBAAS,IAHyC;AAIlD5Z,eAAOhF,GAAGyE,KAAH,CAAS8D,UAAT,GAAsBvI,GAAGyE,KAAH,CAAS8D,UAA/B,GAA4C;AAJD,OAAzB,CAA3B;;AAQA,WAAKqN,QAAL,CAAcpN,UAAd,GAA2BvI,EAAE,OAAF,EAAW4rB,aAAX,CAAyB;AAClDtnB,oBAAYzF,IAAIF,MAAJ,CAAW4J,UAD2B;AAElD2E,gBAAQ,UAF0C;AAGlDyR,iBAAS,IAHyC;AAIlD5Z,eAAOhF,GAAGyE,KAAH,CAAS+D,UAAT,GAAsBxI,GAAGyE,KAAH,CAAS+D,UAA/B,GAA4C;AAJD,OAAzB,CAA3B;AAMD;;sBAKDsM,2BAAS;AAAA;;AACP,UAAI9U,KAAK,IAAT;AACA,WAAKiM,OAAL,GAAe,IAAf;;AAGA,WAAK,IAAI6e,GAAT,IAAgB,KAAKlV,QAArB,EAA+B;AAC7B,aAAKnR,KAAL,CAAWqmB,GAAX,IAAkB,KAAKlV,QAAL,CAAckV,GAAd,EAAmBmB,GAAnB,EAAlB;AACD;;AAED,WAAKhjB,MAAL,CAAY8L,GAAZ,YAAyB,KAAKtQ,KAAL,CAAW2b,SAApC,EAAiD,KAAK3b,KAAtD,EAA6D+F,IAA7D,CAAkE,gBAAQ;AACxExK,WAAGiM,OAAH,GAAa,KAAb;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEA/G,uBAAaC,UAAb,CAAwB,aAAxB;AACA,gBAAKnE,OAAL,CAAaoE,OAAb,CAAqB,aAArB;AACD;AACF,OARD;AASD;;sBAMDupB,qCAAa7X,QAAQ;AACnB,UAAIA,UAAUA,OAAO,CAAP,CAAd,EAAyB;AACvB,YAAIC,QAAQD,OAAO,CAAP,CAAZ;AACA,YAAIE,iBAAJ;;AAEA9V,gBAAQiB,GAAR,CAAY2U,OAAO,CAAP,CAAZ;;AAEA,gBAAQC,MAAM1P,IAAd;AACA,eAAK,WAAL;AACE2P,uBAAW,KAAK9P,KAAL,CAAW2b,SAAX,GAAuB,MAAlC;AACA;;AAEF,eAAK,YAAL;AACE7L,uBAAW,KAAK9P,KAAL,CAAW2b,SAAX,GAAuB,MAAlC;AACA;;AAEF;AACE7d,wBAAYC,KAAZ,CAAkB,mCAAlB,EAAuD,IAAvD;AACA;AAXF;;AAeA,YAAI+R,QAAJ,EAAc;AACZ,cAAIvU,KAAK,IAAT;;AAEA,cAAIwU,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,QAAhB,EAA0BJ,KAA1B,EAAiCC,QAAjC;AACAC,mBAASE,MAAT,CAAgB,MAAhB,EAAwB,KAAKjQ,KAAL,CAAW2b,SAAnC;;AAIA,eAAKuL,UAAL,CACGhX,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,aAD7B,EAC4C;AACxC+M,oBAAQ,MADgC;AAExCxF,kBAAM2J;AAFkC,WAD5C,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ/H,yBAAaC,UAAb,CAAwB,aAAxB;AACA1C,eAAGzB,OAAH,CAAWoE,OAAX,CAAmB,aAAnB;AACD,WATH,EAUGkS,KAVH,CAUS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAVT;AAWD;AACF,OA1CD,MA0CO;AACLjH,oBAAYC,KAAZ,CAAkB,yBAAlB,EAA6C,IAA7C;AACD;AACF;;;;;;;;;;;;;;;;;;;;;MCnLU2pB,uBAAAA,uBADZ;AAeC,0BAAYphB,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAAA,WAb9B5H,OAa8B,GAbpB,IAaoB;AAAA,WAV9BxH,KAU8B,GAVtB;AACN6I,gBAAQ;AADF,OAUsB;AAAA,WAL9BwG,MAK8B,GALrB,KAKqB;;AAC5B,WAAK7K,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK8K,QAAL,GAAgBF,UAAhB;AACD;;2BAMDvU,6BAASwM,QAAQ;AAAA;;AACfrN,cAAQiB,GAAR,CAAY,wBAAZ;AACA,UAAIoM,OAAOC,EAAX,EAAe;AAEb,aAAK+H,MAAL,GAAc,IAAd;AACA,aAAK7K,MAAL,CAAYmD,GAAZ,kBAA+BN,OAAOC,EAAtC,EAA4CvB,IAA5C,CAAiD,eAAO;AACtD,gBAAKyB,OAAL,GAAe,KAAf;AACA,cAAII,OAAOA,IAAIhK,IAAf,EAAqB;AACnB,kBAAKoC,KAAL,GAAa4H,IAAIhK,IAAJ,CAAS,CAAT,CAAb;AACA,kBAAK8I,MAAL,CAAY6I,GAAZ,CAAgB,MAAKvP,KAAL,CAAW6H,IAA3B;;AAEA,gBAAI,MAAK7H,KAAL,CAAW6I,MAAX,CAAkB5G,MAAtB,EAA8B;AAC5BzG,gBAAE,MAAKmsB,aAAP,EACG/pB,IADH,CACQ,kBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAW6I,MAFpB;;AAIA,mBAAK,IAAI9G,IAAI,CAAb,EAAgBA,IAAI,MAAK/B,KAAL,CAAW6I,MAAX,CAAkB5G,MAAtC,EAA8CF,GAA9C,EAAmD;AAEjD,sBAAK/B,KAAL,CAAW6I,MAAX,CAAkB9G,CAAlB,IAAuB,MAAK/B,KAAL,CAAW6I,MAAX,CAAkB9G,CAAlB,CAAvB;AACD;AACF;AACF;AACF,SAjBD;AAkBD,OArBD,MAqBO;AACL,aAAKyF,OAAL,GAAe,KAAf;AACD;AACF;;2BAKDnM,+BAAW;AACTrB,cAAQiB,GAAR,CAAY,wBAAZ;AACA,UAAIM,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,cAAX,EAA2B;AACvCC,yBAAiB;AADsB,OAA3B,CAAd;;AAKApL,QAAE,KAAKmsB,aAAP,EAAsB3N,gBAAtB,CAAuC;AACrCrN,qBAAa,mBADwB;AAErCH,uBAAe,MAFsB;AAGrC0N,wBAAgB,KAHqB;AAIrCzN,oBAAY,KAJyB;AAKrC/D,gBAAQ,UAL6B;AAMrCgE,mBAAW,CAN0B;AAOrC5M,oBAAY;AACVK,gBAAM,OADI;AAEVwB,2BAAiB,IAFP;AAGVd,qBAAW;AACTC,kBAAM;AACJX,oBAAM,KADF;AAEJY,2BAAa,kBAFT;AAGJC,sBAAQ,mCAHJ;AAIJC,wBAAU,MAJN;AAKJC,yBAAW,EAAEC,iBAAiB,IAAnB,EALP;AAMJwH,mBAAKtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB;AANrB;AADG;AAHD,SAPyB;AAqBrC+N,gBAAQ,gBAAShN,CAAT,EAAY;AAElB,cAAIA,EAAE2L,QAAF,CAAW3C,GAAf,EAAoB;AAClBrN,eAAGyE,KAAH,CAAS6I,MAAT,CAAgBJ,IAAhB,CAAqB7I,EAAE2L,QAAF,CAAW3C,GAAhC;AACD;AACF,SA1BoC;AA2BrCyR,kBAAU,kBAASza,CAAT,EAAY;AAEpB,cAAIA,EAAE2L,QAAF,CAAW3C,GAAf,EAAoB;AAClB,gBAAIgf,MAAMrsB,GAAGyE,KAAH,CAAS6I,MAAT,CAAgBL,OAAhB,CAAwB5I,EAAE2L,QAAF,CAAW3C,GAAnC,CAAV;AACA,gBAAIgf,MAAM,CAAC,CAAX,EAAc;AACZrsB,iBAAGyE,KAAH,CAAS6I,MAAT,CAAgByR,MAAhB,CAAuBsN,GAAvB,EAA4B,CAA5B;AACD;AACF;AACF;;AAnCoC,OAAvC;AAuCD;;2BAIDvX,2BAAS;AAAA;;AACP,WAAK7I,OAAL,GAAe,IAAf;;AAGA,UAAI,KAAKd,MAAT,EAAiB;AACf,aAAK1G,KAAL,CAAW6H,IAAX,GAAkB,KAAKnB,MAAL,CAAYO,OAAZ,GAAsBC,MAAxC;AACD;;AAED,UAAI,KAAKmI,MAAT,EAAiB;AAEf,aAAK7K,MAAL,CACG8L,GADH,kBACsB,KAAKtQ,KAAL,CAAW4I,GADjC,EACwC,KAAK5I,KAD7C,EAEG+F,IAFH,CAEQ,gBAAQ;AACZ,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,gBAAvB;AACD;AACF,SATH;AAUD,OAZD,MAYO;AAEL,aAAKhM,MAAL,CAAY6J,IAAZ,CAAiB,WAAjB,EAA8B,KAAKrO,KAAnC,EAA0C+F,IAA1C,CAA+C,gBAAQ;AACrD,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,gBAAvB;AACD;AACF,SAPD;AAQD;AACF;;2BAKDC,4BAAS;AAAA;;AAKP,WAAKjM,MAAL,CAAYiM,MAAZ,kBAAkC,KAAKzQ,KAAL,CAAW4I,GAA7C,EAAoD7C,IAApD,CAAyD,gBAAQ;AAC/D,eAAKyB,OAAL,GAAe,KAAf;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,iBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,gBAAvB;AACD;AACF,OAPD;AAUD;;;;;;;;;;;;;;;;;;;;;MC9JUqX,sBAAAA,sBADZ;AAQC,yBAAYvhB,IAAZ,EAAkB;AAAA;;AAChB,WAAKA,IAAL,GAAYA,IAAZ;AACD;;0BAEDjL,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,WAAX,EAAwB;AACpCC,yBAAiB,KADmB;;AAGpCC,kBAAU,kBAASC,KAAT,EAAgBC,GAAhB,EAAqB;AAC7B,cAAIxL,GAAGmL,MAAP,EAAe;AACbnL,eAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AACF,SAPmC;;AASpCC,qBAAa,qBAASL,KAAT,EAAgBC,GAAhB,EAAqB;AAChCxL,aAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AAXmC,OAAxB,CAAd;;AAcA,WAAKF,UAAL;AACD;;0BAEDA,iCAAWa,MAAM;AACf7N,cAAQiB,GAAR,CAAY,aAAZ;;AAEA,UAAId,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACEC,wBAAgBC,MAAMC,QAAN,CAAezM,EAAE,WAAF,EAAe0M,IAAf,EAAf,CADlB;AAEElG,iBAAS,CACP;AACEiG,oBAAU,4CADZ;AAEE/H,iBAAO,MAFT;AAGE9F,iBAAO,cAHT;AAIE+N,iBAAO,GAJT;AAKEzI,sBAAY;AACV0I,kBAAM;AACJ0f,6BAAe,KADX;AAEJzf,wBAAU,UAFN;AAGJ0f,kCAAoB;AAHhB;AADI;AALd,SADO,EAcP;AACE7nB,iBAAO,QADT;AAEE9F,iBAAO,QAFT;AAGEsF,sBAAY,KAHd;AAIEuI,oBAAU,kBAASsD,QAAT,EAAmB;AAC3B,gBAAIrD,OAAO,EAAX;AACA,iBAAK,IAAInG,IAAI,CAAb,EAAgBA,IAAIwJ,SAAS1C,MAAT,CAAgB5G,MAApC,EAA4CF,GAA5C,EAAiD;AAC/C,kBAAIwJ,SAAS1C,MAAT,CAAgB9G,CAAhB,CAAJ,EAAwB;AACtBmG,qBAAKO,IAAL,+BAC6B8C,SAAS1C,MAAT,CAAgB9G,CAAhB,EAAmB6G,GADhD,WACwD2C,SAAS1C,MAAT,CAAgB9G,CAAhB,EAAmBnH,IAD3E;AAGD;AACF;AACD,mBAAOsN,KAAKY,IAAL,CAAU,IAAV,CAAP;AACD;AAdH,SAdO;AAFX,OAFW,EAoCXzO,IAAIF,MAAJ,CAAWoF,IApCA,CAAb;;AAwCA,UAAIlF,IAAIC,WAAJ,CAAgBiO,UAAhB,CAA2BC,OAA3B,CAAmC,CAAnC,IAAwC,CAAC,CAA7C,EAAgD;AAC9CrO,eAAOqF,OAAP,CAAeiJ,IAAf,CAAoB;AAClBR,oBAAU;AADQ,SAApB;AAGD;;AAGD9N,aAAO2F,UAAP,CAAkBC,MAAlB,CAAyBC,KAAzB,CAA+BC,MAA/B,GAAwC;AACtCrF,cAAM,EAAEuF,MAAM,QAAR;AADgC,OAAxC;;AAKA,UAAI0H,IAAJ,EAAU;AACR1N,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,EAAExI,OAAO,MAAT,EAAiBmI,UAAU,IAA3B,EAAiC9H,OAAOsH,IAAxC,EAA3B;AACD;;AAED1N,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GAAuCtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,UAA3D;;AAEA,WAAKU,IAAL,GAAY/D,EAAE,cAAF,EAAkBuN,SAAlB,CAA4B5O,MAA5B,CAAZ;AACD;;;;;;;;;;;;;;;;;;;;;MC7FU6tB,iCAAAA,iCADZ;AAQC,oCAAY1hB,IAAZ,EAAkB;AAAA;;AAChB,WAAKA,IAAL,GAAYA,IAAZ;AACD;;qCAEDjL,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,WAAX,EAAwB;AACpCC,yBAAiB,KADmB;;AAGpCC,kBAAU,kBAAUC,KAAV,EAAiBC,GAAjB,EAAsB;AAC9B,cAAIxL,GAAGmL,MAAP,EAAe;AACbnL,eAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AACF,SAPmC;;AASpCC,qBAAa,qBAAUL,KAAV,EAAiBC,GAAjB,EAAsB;AACjCxL,aAAGyL,UAAH,CAAczL,GAAGmL,MAAH,CAAUO,OAAV,GAAoBC,MAAlC;AACD;AAXmC,OAAxB,CAAd;;AAcA,WAAKF,UAAL;AACD;;qCAMDA,iCAAWa,MAAM;AACf7N,cAAQiB,GAAR,CAAY,aAAZ;;AAEA,UAAId,SAASqB,EAAEsM,MAAF,CACX,IADW,EAEX;AACE9F,iBAAS,CACP;AACEiG,oBAAU,0HADZ;AAEE/H,iBAAO,MAFT;AAGE9F,iBAAO,YAHT;AAIEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAJd,SADO,EAWP;AACEJ,oBAAU,2CADZ;AAEE/H,iBAAO,WAFT;AAGE9F,iBAAO;AAHT,SAXO,EAgBP;AACE8F,iBAAO,eADT;AAEE9F,iBAAO,oBAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SAhBO,EAyBP;AACEnI,iBAAO,oBADT;AAEE9F,iBAAO,4BAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SAzBO,EAkCP;AACEnI,iBAAO,eADT;AAEE9F,iBAAO,iBAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SAlCO,EA2CP;AACEnI,iBAAO,kBADT;AAEE9F,iBAAO,oBAFT;AAGEsF,sBAAY;AACV0I,kBAAM;AACJC,wBAAU;AADN;AADI;AAHd,SA3CO;AADX,OAFW,EAyDXhO,IAAIF,MAAJ,CAAWoF,IAzDA,CAAb;;AA4DApF,aAAO0H,SAAP,GAAmB,YAAY,CAE9B,CAFD;;AAKA1H,aAAO2F,UAAP,CAAkBC,MAAlB,CAAyBC,KAAzB,CAA+BC,MAA/B,GAAwC;AACtCrF,cAAM,EAAEuF,MAAM,QAAR;AADgC,OAAxC;;AAKA,UAAI0H,IAAJ,EAAU;AACR1N,eAAO2F,UAAP,CAAkB4I,MAAlB,GAA2B,EAAExI,OAAO,MAAT,EAAiBmI,UAAU,IAA3B,EAAiC9H,OAAOsH,IAAxC,EAA3B;AACD;;AAED1N,aAAO2F,UAAP,CAAkBe,SAAlB,CAA4BC,IAA5B,CAAiC6H,GAAjC,GACEtO,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,8BADtB;;AAGA,WAAKU,IAAL,GAAY/D,EAAE,uBAAF,EAA2BuN,SAA3B,CAAqC5O,MAArC,CAAZ;AACD;;;;;;;;;;;UCxHasK,YAAAA;AAAT,WAASA,SAAT,CAAmBtK,MAAnB,EAA2B,CAEjC;;;;;;;;;;;;;;;;;;MCKY8tB,oBAAAA,oBADZ;AAmBC,uBAAY3hB,IAAZ,EAAkB8I,UAAlB,EAA8BrV,MAA9B,EAAsC;AAAA;;AAAA,WAjBtCyN,OAiBsC,GAjB5B,IAiB4B;AAAA,WAdtCxH,KAcsC,GAd9B;AACN6I,gBAAQ,EADF;AAENN,oBAAY;AAFN,OAc8B;AAAA,WARtC8G,MAQsC,GAR7B,KAQ6B;AAAA,WAFtC8B,QAEsC,GAF3B,EAE2B;;AACpC,WAAK3M,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK8K,QAAL,GAAgBF,UAAhB;AACA,WAAKrV,MAAL,GAAcA,MAAd;;AAGA,WAAKmuB,kBAAL,GAA0B7tB,IAAIF,MAAJ,CAAWoO,UAArC;AACD;;wBAMD1N,6BAASwM,QAAQ;AACfrN,cAAQiB,GAAR,CAAY,qBAAZ;AACD;;wBAKDI,+BAAW;AAAA;;AACTrB,cAAQiB,GAAR,CAAY,qBAAZ;AACA,UAAIM,KAAK,IAAT;AACAvB,cAAQiB,GAAR,CAAY,KAAKlB,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA3C;AACA,UACE,KAAKtN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,IACA,KAAKtN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,CAAsCC,EAFxC,EAGE;AACA,YAAIA,KAAK,KAAKvN,MAAL,CAAYqN,kBAAZ,CAA+BC,MAA/B,CAAsCC,EAA/C;;AAEA,aAAK+H,MAAL,GAAc,IAAd;AACA,aAAK7K,MAAL,CAAYmD,GAAZ,eAA4BL,EAA5B,EAAkCvB,IAAlC,CAAuC,eAAO;AAC5C,gBAAKyB,OAAL,GAAe,KAAf;AACA,cAAII,OAAOA,IAAIhK,IAAf,EAAqB;AACnB,kBAAKoC,KAAL,GAAa4H,IAAIhK,IAAJ,CAAS,CAAT,CAAb;AACA,kBAAKuqB,eAAL;AACD;AACF,SAND;AAOD,OAdD,MAcO;AACL,aAAKA,eAAL;AACA,aAAK3gB,OAAL,GAAe,KAAf;AACD;AACF;;wBAED2gB,6CAAkB;AAChB,UAAI5sB,KAAK,IAAT;;AAEA,WAAK4V,QAAL,CAAcgW,QAAd,GAAyB3rB,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AACpD5a,uBAAe,MADqC;AAEpD0N,wBAAgB,QAFoC;AAGpDpa,oBAAYzF,IAAIF,MAAJ,CAAWgtB,QAH6B;AAIpDze,gBAAQ,UAJ4C;AAKpDyR,iBAAS,IAL2C;AAMpD5Z,eAAOhF,GAAGyE,KAAH,CAASmnB,QAAT,GAAoB5rB,GAAGyE,KAAH,CAASmnB,QAA7B,GAAwC;AANK,OAA7B,CAAzB;;AAUA,WAAKhW,QAAL,CAAc1N,QAAd,GAAyBjI,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AACpDtnB,oBAAYzF,IAAIF,MAAJ,CAAWsJ,QAD6B;AAEpDiF,gBAAQ,UAF4C;AAGpDyR,iBAAS,IAH2C;AAIpD5Z,eAAOhF,GAAGyE,KAAH,CAASyD,QAAT,GAAoBlI,GAAGyE,KAAH,CAASyD,QAA7B,GAAwC;AAJK,OAA7B,CAAzB;;AAQA,WAAK0N,QAAL,CAAcxN,KAAd,GAAsBnI,EAAE,QAAF,EAAY4rB,aAAZ,CAA0B;AAC9CtnB,oBAAYzF,IAAIF,MAAJ,CAAWwJ,KADuB;AAE9C+E,gBAAQ,UAFsC;AAG9CyR,iBAAS,IAHqC;AAI9C5Z,eAAOhF,GAAGyE,KAAH,CAAS2D,KAAT,GAAiBpI,GAAGyE,KAAH,CAAS2D,KAA1B,GAAkC;AAJK,OAA1B,CAAtB;;AAQA,WAAKwN,QAAL,CAAczN,QAAd,GAAyBlI,EAAE,WAAF,EAAe4rB,aAAf,CAA6B;AACpDtnB,oBAAYzF,IAAIF,MAAJ,CAAWuJ,QAD6B;AAEpDgF,gBAAQ,UAF4C;AAGpDyR,iBAAS,IAH2C;AAIpD5Z,eAAOhF,GAAGyE,KAAH,CAASunB,CAAT,GAAahsB,GAAGyE,KAAH,CAAS0D,QAAtB,GAAiC;AAJY,OAA7B,CAAzB;;AAQA,WAAKyN,QAAL,CAAc3N,MAAd,GAAuBhI,EAAE,SAAF,EAAa4rB,aAAb,CAA2B;AAChDtnB,oBAAYzF,IAAIF,MAAJ,CAAWqJ,MADyB;AAEhDkF,gBAAQ,UAFwC;AAGhDyR,iBAAS,IAHuC;AAIhD5Z,eAAOhF,GAAGyE,KAAH,CAASwD,MAAT,GAAkBjI,GAAGyE,KAAH,CAASwD,MAA3B,GAAoC;AAJK,OAA3B,CAAvB;AAMD;;wBAID6M,2BAAS;AAAA;;AACP,WAAK7I,OAAL,GAAe,IAAf;;AAGA,WAAK,IAAI6e,GAAT,IAAgB,KAAKlV,QAArB,EAA+B;AAC7B,aAAKnR,KAAL,CAAWqmB,GAAX,IAAkB,KAAKlV,QAAL,CAAckV,GAAd,EAAmBmB,GAAnB,EAAlB;AACD;;AAED,UAAI,KAAKnY,MAAT,EAAiB;;AAGf,aAAK7K,MAAL,CAAY8L,GAAZ,eAA4B,KAAKtQ,KAAL,CAAW4I,GAAvC,EAA8C,KAAK5I,KAAnD,EAA0D+F,IAA1D,CAA+D,gBAAQ;AACrE,iBAAKyB,OAAL,GAAe,KAAf;;AAEA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,kBAAvB;AACD;AACF,SARD;AASD,OAZD,MAYO;;AAGL,aAAKhM,MAAL,CAAY6J,IAAZ,CAAiB,QAAjB,EAA2B,KAAKrO,KAAhC,EAAuC+F,IAAvC,CAA4C,gBAAQ;AAClD,iBAAKyB,OAAL,GAAe,KAAf;;AAEA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,kBAAvB;AACD;AACF,SARD;AASD;AACF;;wBAKDC,4BAAS;AAAA;;AAKP,WAAKjM,MAAL,CAAYiM,MAAZ,eAA+B,KAAKzQ,KAAL,CAAW4I,GAA1C,EAAiD7C,IAAjD,CAAsD,gBAAQ;AAC5D,eAAKyB,OAAL,GAAe,KAAf;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,iBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,kBAAvB;AACD;AACF,OAPD;AAUD;;;;;;;;;;;;;;;;;;;;;MCpKUrB,qBAAAA,qBADZ;AAeC,wBAAY7I,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAAA,WAb9B5H,OAa8B,GAbpB,IAaoB;AAAA,WAV9BxH,KAU8B,GAVtB;AACNlB,kBAAUzE,IAAIF,MAAJ,CAAW2E;AADf,OAUsB;AAAA,WAL9BuQ,MAK8B,GALrB,KAKqB;;AAC5B,WAAK7K,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK8K,QAAL,GAAgBF,UAAhB;AACD;;yBAMDvU,6BAASwM,QAAQ;AAAA;;AACf,UAAIA,OAAOC,EAAX,EAAe;AAEb,aAAK+H,MAAL,GAAc,IAAd;AACA,aAAK7K,MAAL,CAAYmD,GAAZ,gBAA6BN,OAAOC,EAApC,EAA0CvB,IAA1C,CAA+C,eAAO;AACpD,gBAAKyB,OAAL,GAAe,KAAf;AACA,cAAII,OAAOA,IAAIhK,IAAf,EAAqB;AAEnB,kBAAKoC,KAAL,GAAaxE,EAAEsM,MAAF,CAAS,IAAT,EAAe,MAAK9H,KAApB,EAA2B4H,IAAIhK,IAAJ,CAAS,CAAT,CAA3B,CAAb;;AAEA,kBAAK8I,MAAL,CAAY6I,GAAZ,CAAgB,MAAKvP,KAAL,CAAW6H,IAA3B;;AAEA,gBAAI,MAAK7H,KAAL,CAAWkD,kBAAf,EAAmC;AACjC1H,gBAAE,MAAK0H,kBAAP,EACGtF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWkD,kBAFpB;AAGD;AACD,gBAAI,MAAKlD,KAAL,CAAWoD,qBAAf,EAAsC;AACpC5H,gBAAE,MAAK4H,qBAAP,EACGxF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWoD,qBAFpB;AAGD;AACD,gBAAI,MAAKpD,KAAL,CAAWnC,MAAf,EAAuB;AACrBrC,gBAAE,MAAKqC,MAAP,EAAeD,IAAf,CAAoB,mBAApB,EAAyC2C,KAAzC,CAA+C,MAAKP,KAAL,CAAWnC,MAA1D;AACD;AACD,gBAAI,MAAKmC,KAAL,CAAWwP,aAAf,EAA8B;AAC5BhU,gBAAE,MAAKgU,aAAP,EACG5R,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWwP,aAFpB;AAGD;AACF;AACF,SA3BD;AA4BD,OA/BD,MA+BO;AACL,aAAKhI,OAAL,GAAe,KAAf;AACD;AACF;;yBAKDnM,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,YAAX,EAAyB;AACrCC,yBAAiB;AADoB,OAAzB,CAAd;;AAKApL,QAAE,KAAK0H,kBAAP,EAA2BuM,iBAA3B,CAA6C;AAC3C3P,oBAAYzF,IAAIF,MAAJ,CAAW+I,kBADoB;;AAG3CwM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASkD,kBAAT,GAA8B,KAAK3C,KAAL,EAA9B;AACD;AAN0C,OAA7C;;AASA/E,QAAE,KAAK4H,qBAAP,EAA8BqM,iBAA9B,CAAgD;AAC9C3P,oBAAYzF,IAAIF,MAAJ,CAAWiJ,qBADuB;;AAG9CsM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASoD,qBAAT,GAAiC,KAAK7C,KAAL,EAAjC;AACD;AAN6C,OAAhD;;AASA/E,QAAE,KAAKqC,MAAP,EAAe4R,iBAAf,CAAiC;AAC/B3P,oBAAYzF,IAAIF,MAAJ,CAAWgJ,eADQ;;AAG/BuM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASnC,MAAT,GAAkB,KAAK0C,KAAL,EAAlB;AACD;AAN8B,OAAjC;;AASA/E,QAAE,KAAKgU,aAAP,EAAsBC,iBAAtB,CAAwC;AACtC3P,oBAAYzF,IAAIF,MAAJ,CAAWqV,aADe;;AAGtCE,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASwP,aAAT,GAAyB,KAAKjP,KAAL,EAAzB;AACD;AANqC,OAAxC;AAQD;;yBAMDoP,6CAAiBC,QAAQ;AACvB5V,cAAQiB,GAAR,CAAY,kBAAZ;AACA,UAAI2U,UAAUA,OAAO,CAAP,CAAd,EAAyB;AACvB,YAAIC,QAAQD,OAAO,CAAP,CAAZ;AACA,YAAIE,iBAAJ;;AAEA,gBAAQD,MAAM1P,IAAd;AACA,eAAK,WAAL;AACE2P,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF,eAAK,YAAL;AACEkH,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF;AACE9K,wBAAYC,KAAZ,CAAkB,mCAAlB,EAAuD,IAAvD;AACA;AAXF;AAaA,YAAI+R,YAAY,KAAK9P,KAAL,CAAW4I,GAA3B,EAAgC;AAC9B,cAAIrN,KAAK,IAAT;;AAEA,cAAIwU,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,QAAhB,EAA0BJ,KAA1B,EAAiCC,QAAjC;AACAC,mBAASE,MAAT,CAAgB,KAAhB,EAAuB,KAAKjQ,KAAL,CAAW4I,GAAlC;;AAIA,eAAK0G,QAAL,CACGY,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,cAD7B,EAC6C;AACzC+M,oBAAQ,MADiC;AAEzCxF,kBAAM2J;AAFmC,WAD7C,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ,gBAAInI,IAAJ,EAAU;AACRE,0BAAYC,KAAZ,CAAkB,oCAAlB,EAAwD,IAAxD;AACD;AACF,WAVH,EAWGqS,KAXH,CAWS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAXT;AAYD;AACF,OAvCD,MAuCO;AACLjH,oBAAYC,KAAZ,CAAkB,yBAAlB,EAA6C,IAA7C;AACD;AACF;;yBAKDsS,2BAAS;AAAA;;AACP,WAAK7I,OAAL,GAAe,IAAf;;AAGA,UAAI,KAAKd,MAAT,EAAiB;AACf,aAAK1G,KAAL,CAAW6H,IAAX,GAAkB,KAAKnB,MAAL,CAAYO,OAAZ,GAAsBC,MAAxC;AACD;;AAED,UAAI,KAAKmI,MAAT,EAAiB;AAEf,aAAK7K,MAAL,CAAY8L,GAAZ,gBAA6B,KAAKtQ,KAAL,CAAW4I,GAAxC,EAA+C,KAAK5I,KAApD,EAA2D+F,IAA3D,CAAgE,gBAAQ;AACtE,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD,OAVD,MAUO;AAEL,aAAKhM,MAAL,CAAY6J,IAAZ,CAAiB,SAAjB,EAA4B,KAAKrO,KAAjC,EAAwC+F,IAAxC,CAA6C,gBAAQ;AACnD,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD;AACF;;yBAKDC,4BAAS;AAAA;;AAEP,WAAKjM,MAAL,CAAYiM,MAAZ,gBAAgC,KAAKzQ,KAAL,CAAW4I,GAA3C,EAAkD7C,IAAlD,CAAuD,gBAAQ;AAC7D,eAAKyB,OAAL,GAAe,KAAf;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,iBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,OAPD;AAQD;;;;;;;;;;;;;;;;;;;;;MC7MUrB,qBAAAA,qBADZ;AAeC,wBAAY7I,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAAA,WAb9B5H,OAa8B,GAbpB,IAaoB;AAAA,WAV9BxH,KAU8B,GAVtB;AACNlB,kBAAUzE,IAAIF,MAAJ,CAAW2E;AADf,OAUsB;AAAA,WAL9BuQ,MAK8B,GALrB,KAKqB;;AAC5B,WAAK7K,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK8K,QAAL,GAAgBF,UAAhB;AACD;;yBAMDvU,6BAASwM,QAAQ;AAAA;;AACf,UAAIA,OAAOC,EAAX,EAAe;AAEb,aAAK+H,MAAL,GAAc,IAAd;AACA,aAAK7K,MAAL,CAAYmD,GAAZ,gBAA6BN,OAAOC,EAApC,EAA0CvB,IAA1C,CAA+C,eAAO;AACpD,gBAAKyB,OAAL,GAAe,KAAf;AACA,cAAII,OAAOA,IAAIhK,IAAf,EAAqB;AAEnB,kBAAKoC,KAAL,GAAaxE,EAAEsM,MAAF,CAAS,IAAT,EAAe,MAAK9H,KAApB,EAA2B4H,IAAIhK,IAAJ,CAAS,CAAT,CAA3B,CAAb;;AAEA,kBAAK8I,MAAL,CAAY6I,GAAZ,CAAgB,MAAKvP,KAAL,CAAW6H,IAA3B;;AAEA,gBAAI,MAAK7H,KAAL,CAAWkD,kBAAf,EAAmC;AACjC1H,gBAAE,MAAK0H,kBAAP,EACGtF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWkD,kBAFpB;AAGD;AACD,gBAAI,MAAKlD,KAAL,CAAWoD,qBAAf,EAAsC;AACpC5H,gBAAE,MAAK4H,qBAAP,EACGxF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWoD,qBAFpB;AAGD;AACD,gBAAI,MAAKpD,KAAL,CAAWnC,MAAf,EAAuB;AACrBrC,gBAAE,MAAKqC,MAAP,EAAeD,IAAf,CAAoB,mBAApB,EAAyC2C,KAAzC,CAA+C,MAAKP,KAAL,CAAWnC,MAA1D;AACD;AACD,gBAAI,MAAKmC,KAAL,CAAWwP,aAAf,EAA8B;AAC5BhU,gBAAE,MAAKgU,aAAP,EACG5R,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWwP,aAFpB;AAGD;AACF;AACF,SA3BD;AA4BD,OA/BD,MA+BO;AACL,aAAKhI,OAAL,GAAe,KAAf;AACD;AACF;;yBAKDnM,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,YAAX,EAAyB;AACrCC,yBAAiB;AADoB,OAAzB,CAAd;;AAKApL,QAAE,KAAK0H,kBAAP,EAA2BuM,iBAA3B,CAA6C;AAC3C3P,oBAAYzF,IAAIF,MAAJ,CAAW+I,kBADoB;;AAG3CwM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASkD,kBAAT,GAA8B,KAAK3C,KAAL,EAA9B;AACD;AAN0C,OAA7C;;AASA/E,QAAE,KAAK4H,qBAAP,EAA8BqM,iBAA9B,CAAgD;AAC9C3P,oBAAYzF,IAAIF,MAAJ,CAAWiJ,qBADuB;;AAG9CsM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASoD,qBAAT,GAAiC,KAAK7C,KAAL,EAAjC;AACD;AAN6C,OAAhD;;AASA/E,QAAE,KAAKqC,MAAP,EAAe4R,iBAAf,CAAiC;AAC/B3P,oBAAYzF,IAAIF,MAAJ,CAAWgJ,eADQ;;AAG/BuM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASnC,MAAT,GAAkB,KAAK0C,KAAL,EAAlB;AACD;AAN8B,OAAjC;;AASA/E,QAAE,KAAKgU,aAAP,EAAsBC,iBAAtB,CAAwC;AACtC3P,oBAAYzF,IAAIF,MAAJ,CAAWqV,aADe;;AAGtCE,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASwP,aAAT,GAAyB,KAAKjP,KAAL,EAAzB;AACD;AANqC,OAAxC;AAQD;;yBAMDoP,6CAAiBC,QAAQ;AACvB5V,cAAQiB,GAAR,CAAY,kBAAZ;AACA,UAAI2U,UAAUA,OAAO,CAAP,CAAd,EAAyB;AACvB,YAAIC,QAAQD,OAAO,CAAP,CAAZ;AACA,YAAIE,iBAAJ;;AAEA,gBAAQD,MAAM1P,IAAd;AACA,eAAK,WAAL;AACE2P,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF,eAAK,YAAL;AACEkH,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF;AACE9K,wBAAYC,KAAZ,CAAkB,mCAAlB,EAAuD,IAAvD;AACA;AAXF;AAaA,YAAI+R,YAAY,KAAK9P,KAAL,CAAW4I,GAA3B,EAAgC;AAC9B,cAAIrN,KAAK,IAAT;;AAEA,cAAIwU,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,QAAhB,EAA0BJ,KAA1B,EAAiCC,QAAjC;AACAC,mBAASE,MAAT,CAAgB,KAAhB,EAAuB,KAAKjQ,KAAL,CAAW4I,GAAlC;;AAIA,eAAK0G,QAAL,CACGY,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,cAD7B,EAC6C;AACzC+M,oBAAQ,MADiC;AAEzCxF,kBAAM2J;AAFmC,WAD7C,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ,gBAAInI,IAAJ,EAAU;AACRE,0BAAYC,KAAZ,CAAkB,oCAAlB,EAAwD,IAAxD;AACD;AACF,WAVH,EAWGqS,KAXH,CAWS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAXT;AAYD;AACF,OAvCD,MAuCO;AACLjH,oBAAYC,KAAZ,CAAkB,yBAAlB,EAA6C,IAA7C;AACD;AACF;;yBAKDsS,2BAAS;AAAA;;AACP,WAAK7I,OAAL,GAAe,IAAf;;AAGA,UAAI,KAAKd,MAAT,EAAiB;AACf,aAAK1G,KAAL,CAAW6H,IAAX,GAAkB,KAAKnB,MAAL,CAAYO,OAAZ,GAAsBC,MAAxC;AACD;;AAED,UAAI,KAAKmI,MAAT,EAAiB;AAEf,aAAK7K,MAAL,CAAY8L,GAAZ,gBAA6B,KAAKtQ,KAAL,CAAW4I,GAAxC,EAA+C,KAAK5I,KAApD,EAA2D+F,IAA3D,CAAgE,gBAAQ;AACtE,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD,OAVD,MAUO;AAEL,aAAKhM,MAAL,CAAY6J,IAAZ,CAAiB,SAAjB,EAA4B,KAAKrO,KAAjC,EAAwC+F,IAAxC,CAA6C,gBAAQ;AACnD,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD;AACF;;yBAKDC,4BAAS;AAAA;;AAEP,WAAKjM,MAAL,CAAYiM,MAAZ,gBAAgC,KAAKzQ,KAAL,CAAW4I,GAA3C,EAAkD7C,IAAlD,CAAuD,gBAAQ;AAC7D,eAAKyB,OAAL,GAAe,KAAf;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,iBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,OAPD;AAQD;;;;;;;;;;;;;;;;;;;;;MC7MU4X,kBAAAA,kBADZ;AAeC,qBAAY9hB,IAAZ,EAAkB8I,UAAlB,EAA8B;AAAA;;AAAA,WAb9B5H,OAa8B,GAbpB,IAaoB;AAAA,WAV9BxH,KAU8B,GAVtB;AACNlB,kBAAUzE,IAAIF,MAAJ,CAAW2E;AADf,OAUsB;AAAA,WAL9BuQ,MAK8B,GALrB,KAKqB;;AAC5B,WAAK7K,MAAL,GAAc8B,KAAK9B,MAAnB;AACA,WAAK8K,QAAL,GAAgBF,UAAhB;AACD;;sBAMDvU,6BAASwM,QAAQ;AAAA;;AACf,UAAIA,OAAOC,EAAX,EAAe;AAEb,aAAK+H,MAAL,GAAc,IAAd;AACA,aAAK7K,MAAL,CAAYmD,GAAZ,gBAA6BN,OAAOC,EAApC,EAA0CvB,IAA1C,CAA+C,eAAO;AACpD,gBAAKyB,OAAL,GAAe,KAAf;AACA,cAAII,OAAOA,IAAIhK,IAAf,EAAqB;AAEnB,kBAAKoC,KAAL,GAAaxE,EAAEsM,MAAF,CAAS,IAAT,EAAe,MAAK9H,KAApB,EAA2B4H,IAAIhK,IAAJ,CAAS,CAAT,CAA3B,CAAb;;AAEA,kBAAK8I,MAAL,CAAY6I,GAAZ,CAAgB,MAAKvP,KAAL,CAAW6H,IAA3B;;AAEA,gBAAI,MAAK7H,KAAL,CAAWkD,kBAAf,EAAmC;AACjC1H,gBAAE,MAAK0H,kBAAP,EACGtF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWkD,kBAFpB;AAGD;AACD,gBAAI,MAAKlD,KAAL,CAAWoD,qBAAf,EAAsC;AACpC5H,gBAAE,MAAK4H,qBAAP,EACGxF,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWoD,qBAFpB;AAGD;AACD,gBAAI,MAAKpD,KAAL,CAAWnC,MAAf,EAAuB;AACrBrC,gBAAE,MAAKqC,MAAP,EAAeD,IAAf,CAAoB,mBAApB,EAAyC2C,KAAzC,CAA+C,MAAKP,KAAL,CAAWnC,MAA1D;AACD;AACD,gBAAI,MAAKmC,KAAL,CAAWwP,aAAf,EAA8B;AAC5BhU,gBAAE,MAAKgU,aAAP,EACG5R,IADH,CACQ,mBADR,EAEG2C,KAFH,CAES,MAAKP,KAAL,CAAWwP,aAFpB;AAGD;AACF;AACF,SA3BD;AA4BD,OA/BD,MA+BO;AACL,aAAKhI,OAAL,GAAe,KAAf;AACD;AACF;;sBAKDnM,+BAAW;AACT,UAAIE,KAAK,IAAT;;AAEA,WAAKmL,MAAL,GAAc,IAAIC,MAAJ,CAAW,YAAX,EAAyB;AACrCC,yBAAiB;AADoB,OAAzB,CAAd;;AAKApL,QAAE,KAAK0H,kBAAP,EAA2BuM,iBAA3B,CAA6C;AAC3C3P,oBAAYzF,IAAIF,MAAJ,CAAW+I,kBADoB;;AAG3CwM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASkD,kBAAT,GAA8B,KAAK3C,KAAL,EAA9B;AACD;AAN0C,OAA7C;;AASA/E,QAAE,KAAK4H,qBAAP,EAA8BqM,iBAA9B,CAAgD;AAC9C3P,oBAAYzF,IAAIF,MAAJ,CAAWiJ,qBADuB;;AAG9CsM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASoD,qBAAT,GAAiC,KAAK7C,KAAL,EAAjC;AACD;AAN6C,OAAhD;;AASA/E,QAAE,KAAKqC,MAAP,EAAe4R,iBAAf,CAAiC;AAC/B3P,oBAAYzF,IAAIF,MAAJ,CAAWgJ,eADQ;;AAG/BuM,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASnC,MAAT,GAAkB,KAAK0C,KAAL,EAAlB;AACD;AAN8B,OAAjC;;AASA/E,QAAE,KAAKgU,aAAP,EAAsBC,iBAAtB,CAAwC;AACtC3P,oBAAYzF,IAAIF,MAAJ,CAAWqV,aADe;;AAGtCE,gBAAQ,kBAAW;AAEjBnU,aAAGyE,KAAH,CAASwP,aAAT,GAAyB,KAAKjP,KAAL,EAAzB;AACD;AANqC,OAAxC;AAQD;;sBAMDoP,6CAAiBC,QAAQ;AACvB5V,cAAQiB,GAAR,CAAY,kBAAZ;AACA,UAAI2U,UAAUA,OAAO,CAAP,CAAd,EAAyB;AACvB,YAAIC,QAAQD,OAAO,CAAP,CAAZ;AACA,YAAIE,iBAAJ;;AAEA,gBAAQD,MAAM1P,IAAd;AACA,eAAK,WAAL;AACE2P,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF,eAAK,YAAL;AACEkH,uBAAW,KAAK9P,KAAL,CAAW4I,GAAX,GAAiB,MAA5B;AACA;;AAEF;AACE9K,wBAAYC,KAAZ,CAAkB,mCAAlB,EAAuD,IAAvD;AACA;AAXF;AAaA,YAAI+R,YAAY,KAAK9P,KAAL,CAAW4I,GAA3B,EAAgC;AAC9B,cAAIrN,KAAK,IAAT;;AAEA,cAAIwU,WAAW,IAAIC,QAAJ,EAAf;AACAD,mBAASE,MAAT,CAAgB,QAAhB,EAA0BJ,KAA1B,EAAiCC,QAAjC;AACAC,mBAASE,MAAT,CAAgB,KAAhB,EAAuB,KAAKjQ,KAAL,CAAW4I,GAAlC;;AAIA,eAAK0G,QAAL,CACGY,KADH,CACS7V,IAAIF,MAAJ,CAAW0E,MAAX,GAAoB,cAD7B,EAC6C;AACzC+M,oBAAQ,MADiC;AAEzCxF,kBAAM2J;AAFmC,WAD7C,EAKGhK,IALH,CAKQ;AAAA,mBAAYd,SAASkL,IAAT,EAAZ;AAAA,WALR,EAMGpK,IANH,CAMQ,gBAAQ;AACZ,gBAAInI,IAAJ,EAAU;AACRE,0BAAYC,KAAZ,CAAkB,oCAAlB,EAAwD,IAAxD;AACD;AACF,WAVH,EAWGqS,KAXH,CAWS;AAAA,mBAAStS,YAAYC,KAAZ,CAAkBJ,MAAMoH,OAAxB,EAAiC,IAAjC,CAAT;AAAA,WAXT;AAYD;AACF,OAvCD,MAuCO;AACLjH,oBAAYC,KAAZ,CAAkB,yBAAlB,EAA6C,IAA7C;AACD;AACF;;sBAKDsS,2BAAS;AAAA;;AACP,WAAK7I,OAAL,GAAe,IAAf;;AAGA,UAAI,KAAKd,MAAT,EAAiB;AACf,aAAK1G,KAAL,CAAW6H,IAAX,GAAkB,KAAKnB,MAAL,CAAYO,OAAZ,GAAsBC,MAAxC;AACD;;AAED,UAAI,KAAKmI,MAAT,EAAiB;AAEf,aAAK7K,MAAL,CAAY8L,GAAZ,gBAA6B,KAAKtQ,KAAL,CAAW4I,GAAxC,EAA+C,KAAK5I,KAApD,EAA2D+F,IAA3D,CAAgE,gBAAQ;AACtE,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD,OAVD,MAUO;AAEL,aAAKhM,MAAL,CAAY6J,IAAZ,CAAiB,SAAjB,EAA4B,KAAKrO,KAAjC,EAAwC+F,IAAxC,CAA6C,gBAAQ;AACnD,iBAAKyB,OAAL,GAAe,KAAf;AACA,cAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,wBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,mBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,SAPD;AAQD;AACF;;sBAKDC,4BAAS;AAAA;;AAEP,WAAKjM,MAAL,CAAYiM,MAAZ,gBAAgC,KAAKzQ,KAAL,CAAW4I,GAA3C,EAAkD7C,IAAlD,CAAuD,gBAAQ;AAC7D,eAAKyB,OAAL,GAAe,KAAf;AACA,YAAI5J,QAAQA,KAAKmH,OAAjB,EAA0B;AACxBjH,sBAAYC,KAAZ,CAAkBH,KAAKmH,OAAvB,EAAgC,IAAhC;;AAEAnI,iBAAO2T,QAAP,CAAgBC,IAAhB,GAAuB,cAAvB;AACD;AACF,OAPD;AAQD","file":"app-bundle.js","sourcesContent":["import { Aurelia, inject } from 'aurelia-framework';\r\nimport { Router } from 'aurelia-router';\r\n// import { Router, Redirect } from 'aurelia-router';\r\n// import { AuthContext } from './auth-context';\r\n// import { HttpClient } from 'aurelia-http-client';\r\n\r\n@inject(Aurelia, Router)\r\nexport class Application {\r\n  constructor(aurelia, router) {\r\n    this.aurelia = aurelia;\r\n    this.router = router;\r\n    console.info('App const');\r\n  }\r\n\r\n  configureRouter(config, router) {\r\n    config.title = 'RAZRGEN';\r\n    App.currentUser;\r\n    // var step = new AuthorizeStep;\r\n    // config.addAuthorizeStep(step)\r\n    // config.addPipelineStep('preRender', postRenderStep);\r\n    config.addPipelineStep('postRender', postRenderStep);\r\n    // config.addPipelineStep(' postRender', AuthorizeStep); // Add a route filter to the authorize extensibility point.\r\n    config.map([\r\n      {\r\n        route: 'login',\r\n        moduleId: 'login/login',\r\n        name: 'Login'\r\n      },\r\n      {\r\n        route: ['', 'overview'],\r\n        name: 'overview',\r\n        moduleId: 'overview/overview',\r\n        title: 'Overview'\r\n      },\r\n      {\r\n        route: 'profile',\r\n        name: 'profile',\r\n        moduleId: 'profile/profile',\r\n        title: 'User Profile'\r\n      },\r\n      {\r\n        route: 'administration',\r\n        name: 'administration',\r\n        moduleId: 'administration/administration',\r\n        title: 'Administration'\r\n      },\r\n      {\r\n        route: 'user-admin',\r\n        name: 'user-admin',\r\n        moduleId: 'user-admin/user-admin',\r\n        title: 'User Administration'\r\n      },\r\n      {\r\n        route: 'user-admin/:id',\r\n        name: 'user-admin/:id',\r\n        moduleId: 'user-admin/user-admin',\r\n        title: 'User Administration'\r\n      },\r\n      {\r\n        route: 'asset-list',\r\n        name: 'asset-list',\r\n        moduleId: 'asset-list/asset-list',\r\n        title: 'Assets List'\r\n      },\r\n      {\r\n        route: 'asset-list/:id',\r\n        name: 'asset-list/:id',\r\n        moduleId: 'asset-list/asset-list',\r\n        title: 'Project Asset List'\r\n      },\r\n      {\r\n        route: 'asset-admin',\r\n        name: 'asset-admin',\r\n        moduleId: 'asset-admin/asset-admin',\r\n        title: 'Asset Administration'\r\n      },\r\n      {\r\n        route: 'asset-admin/:id',\r\n        name: 'asset-admin/:id',\r\n        moduleId: 'asset-admin/asset-admin',\r\n        title: 'Asset Administration'\r\n      },\r\n      {\r\n        route: 'project-list',\r\n        name: 'project-list',\r\n        moduleId: 'project-list/project-list',\r\n        title: 'Project List'\r\n      },\r\n      {\r\n        route: 'project-admin',\r\n        name: 'project-admin',\r\n        moduleId: 'project-admin/project-admin',\r\n        title: 'Project Administration'\r\n      },\r\n      {\r\n        route: 'project-admin/:id',\r\n        name: 'project-admin/:id',\r\n        moduleId: 'project-admin/project-admin',\r\n        title: 'Project Administration'\r\n      },\r\n      {\r\n        route: 'asset-details/:id',\r\n        name: 'asset-details',\r\n        moduleId: 'asset-details/asset-details',\r\n        title: 'Assets Details'\r\n      },\r\n      {\r\n        route: 'alarms',\r\n        name: 'alarms',\r\n        moduleId: 'alarms/alarms',\r\n        title: 'Alarms'\r\n      },\r\n      {\r\n        route: 'map',\r\n        name: 'map',\r\n        moduleId: 'map/map',\r\n        title: 'Map'\r\n      },\r\n      {\r\n        route: 'locations',\r\n        name: 'locations',\r\n        moduleId: 'locations/locations',\r\n        title: 'Locations'\r\n      },\r\n      {\r\n        route: 'geofences',\r\n        name: 'geofences',\r\n        moduleId: 'geofences/geofences',\r\n        title: 'Geofences'\r\n      },\r\n      {\r\n        route: 'commands',\r\n        name: 'commands',\r\n        moduleId: 'commands/commands',\r\n        title: 'Commands'\r\n      },\r\n      {\r\n        route: 'report-asset-utilization',\r\n        name: 'report-asset-utilization',\r\n        moduleId: 'report-asset-utilization/report-asset-utilization',\r\n        title: 'Asset Utilization'\r\n      },\r\n      //new pages for 247\r\n      {\r\n        route: 'ad-list',\r\n        name: 'ad-list',\r\n        moduleId: 'ad-list/ad-list',\r\n        title: 'Ads List'\r\n      },\r\n      {\r\n        route: 'ad-admin',\r\n        name: 'ad-admin',\r\n        moduleId: 'ad-admin/ad-admin',\r\n        title: 'Ad Admin'\r\n      }\r\n    ]);\r\n    this.router = router;\r\n  }\r\n\r\n  activate() {\r\n    console.info('app has been activated');\r\n  }\r\n\r\n  created(owningView, myView) {\r\n    console.log('app created');\r\n\r\n    // Invoked once the component is created...\r\n  }\r\n\r\n  bind(bindingContext, overrideContext) {\r\n    console.info('app bind');\r\n\r\n    // Invoked once the databinding is activated...\r\n  }\r\n\r\n  attached(argument) {\r\n    console.info('app attached');\r\n    let me = this;\r\n    // Invoked once the component is attached to the DOM...\r\n\r\n    //Main Left Sidebar Menu\r\n    $('.sidebar-collapse').sideNav(\r\n      {\r\n        // edge: 'left' // Choose the horizontal origin\r\n      }\r\n    );\r\n\r\n    // Materialize Slider\r\n    $('.slider').slider({\r\n      full_width: true\r\n    });\r\n\r\n    // Materialize Dropdown\r\n    $('.dropdown-button').dropdown({\r\n      inDuration: 300,\r\n      outDuration: 125,\r\n      constrain_width: true, // Does not change width of dropdown to that of the activator\r\n      hover: false, // Activate on click\r\n      alignment: 'left', // Aligns dropdown to left or right edge (works with constrain_width)\r\n      gutter: 0, // Spacing from edge\r\n      belowOrigin: true // Displays dropdown below the button\r\n    });\r\n\r\n    //collapsibles\r\n    $('.collapsible').collapsible();\r\n\r\n    $('.chat-close-collapse').click(function() {\r\n      $('.chat-collapse').sideNav('hide');\r\n    });\r\n\r\n    $('.chat-collapsible').collapsible({\r\n      accordion: false // A setting that changes the collapsible behavior to expandable instead of the default accordion style\r\n    });\r\n\r\n    // Perfect Scrollbar\r\n    $('select').not('.disabled').material_select();\r\n    let leftnav = $('.page-topbar').height();\r\n    let leftnavHeight = window.innerHeight - leftnav;\r\n    $('.leftside-navigation').height(leftnavHeight).perfectScrollbar({\r\n      suppressScrollX: true\r\n    });\r\n    let righttnav = $('#chat-out').height();\r\n    $('.rightside-navigation').height(righttnav).perfectScrollbar({\r\n      suppressScrollX: true\r\n    });\r\n\r\n    //kendo strip\r\n    $('#tabstrip').kendoTabStrip({\r\n      animation: {\r\n        open: {\r\n          effects: 'fadeIn'\r\n        }\r\n      }\r\n    });\r\n\r\n    //tooltips\r\n    $('.tooltipped').tooltip({ delay: 50 });\r\n\r\n    //Ajax Prefilters for the widgets\r\n    $.ajaxPrefilter(function(options, originalOptions, jqXHR) {\r\n      options.error = function(data) {\r\n        switch (data.status) {\r\n        case 0:\r\n          Materialize.toast(\r\n              'Server is not reachable. Please contact the system administrator',\r\n              5000\r\n            );\r\n          break;\r\n\r\n        case 401:\r\n          localStorage.removeItem('currentUser');\r\n          delete App.currentUser;\r\n          me.aurelia.setRoot('login/login');\r\n          Materialize.toast('User is Unathorized', 5000);\r\n          break;\r\n\r\n        case 413:\r\n          Materialize.toast('File size is too large', 5000);\r\n          break;\r\n\r\n        default:\r\n          if (data.statusText) {\r\n            Materialize.toast(data.statusText, 3000);\r\n          }\r\n          break;\r\n        }\r\n      };\r\n    });\r\n  }\r\n\r\n  detached(argument) {\r\n    console.info('app detached');\r\n\r\n    // Invoked when component is detached from the dom\r\n  }\r\n\r\n  unbind(argument) {\r\n    console.log('app unbind');\r\n\r\n    // Invoked when component is unbound...\r\n  }\r\n}\r\n\r\n// class AuthorizeStep {\r\n//   run(navigationInstruction, next) {\r\n//     console.warn('AuthorizeStep');\r\n//     if (\r\n//       navigationInstruction\r\n//         .getAllInstructions()\r\n//         .some(i => i.config.settings.auth)\r\n//     ) {\r\n//       console.log('AuthorizeStep');\r\n//       // let isLoggedIn = false;\r\n//       // console.log(isLoggedIn);\r\n//       // if (!isLoggedIn) {\r\n//       //   return next.cancel(new Redirect('login'));\r\n//       // }\r\n//     }\r\n//     return next();\r\n//   }\r\n// }\r\n\r\nclass postRenderStep {\r\n  run(navigationInstruction, next) {\r\n    //Main Left Sidebar Menu\r\n    $('.sidebar-collapse').sideNav({\r\n      edge: 'left' // Choose the horizontal origin\r\n    });\r\n\r\n    //Main Left Sidebar Chat\r\n    $('.chat-collapse').sideNav({\r\n      menuWidth: 240,\r\n      edge: 'right'\r\n    });\r\n\r\n    return next();\r\n  }\r\n}\r\n","export class AppState {\r\n  constructor() {\r\n    let me = this;\r\n    this.loggedInUser = null;\r\n    /**\r\n     * Application configuration\r\n     */\r\n    this.config = {\r\n      apiUrl: 'http://localhost:8080',\r\n      // apiUrl: window.location.origin,\r\n      features: {\r\n        engineStatus: {\r\n          enabled: true\r\n        },\r\n        inUse: {\r\n          enabled: true\r\n        },\r\n        nonReport: {\r\n          enabled: true,\r\n          alarmFeature: true,\r\n          threshold: 10\r\n        },\r\n        hasMapPosition: {\r\n          enabled: true\r\n        },\r\n        powerOutputKW: {\r\n          enabled: true\r\n        }\r\n      },\r\n      grid: {\r\n        toolbar: ['excel', 'pdf'],\r\n        excel: {\r\n          filterable: true\r\n        },\r\n        // mobile: true,\r\n        filterMenuInit: function(e) {\r\n          if (\r\n            e.sender.dataSource.options.schema.model.fields[e.field] &&\r\n            e.sender.dataSource.options.schema.model.fields[e.field].type ==\r\n              'date'\r\n          ) {\r\n            let beginOperator = e.container\r\n              .find('[data-role=dropdownlist]:eq(0)')\r\n              .data('kendoDropDownList');\r\n            beginOperator.value('gte');\r\n            beginOperator.trigger('change');\r\n            beginOperator.readonly();\r\n\r\n            let logicOperator = e.container\r\n              .find('[data-role=dropdownlist]:eq(1)')\r\n              .data('kendoDropDownList');\r\n            logicOperator.readonly();\r\n\r\n            let endOperator = e.container\r\n              .find('[data-role=dropdownlist]:eq(2)')\r\n              .data('kendoDropDownList');\r\n            endOperator.value('lte');\r\n            endOperator.trigger('change');\r\n            beginOperator.readonly();\r\n          }\r\n        },\r\n        columnMenu: true,\r\n        dataSource: {\r\n          type: 'odata',\r\n          transport: {\r\n            read: {\r\n              type: 'GET',\r\n              contentType: 'application/json',\r\n              accept: 'application/json, text/plain, */*',\r\n              dataType: 'json',\r\n              xhrFields: { withCredentials: true }\r\n            },\r\n            error: function(e) {\r\n              void 0;\r\n            }\r\n          },\r\n          schema: {\r\n            data: 'data.docs',\r\n            total: 'data.total',\r\n            model: {\r\n              fields: {\r\n                eventTime: { type: 'date' },\r\n                createdTime: { type: 'date' },\r\n                updated_at: { type: 'date' },\r\n                created_at: { type: 'date' }\r\n              }\r\n            }\r\n          },\r\n          pageSize: 25,\r\n          serverPaging: true,\r\n          serverFiltering: true,\r\n          serverSorting: true\r\n        },\r\n        dataBound: function() {\r\n          let grid = this;\r\n          setTimeout(function() {\r\n            for (let i = 0; i < grid.columns.length; i++) {\r\n              grid.autoFitColumn(i);\r\n            }\r\n          }, 1);\r\n        },\r\n        height: 800,\r\n        groupable: true,\r\n        reorderable: true,\r\n        resizable: true,\r\n        sortable: true,\r\n        pageable: {\r\n          refresh: true,\r\n          pageSizes: true,\r\n          buttonCount: 5\r\n        },\r\n        filterable: {\r\n          extra: false,\r\n          operators: {\r\n            string: {\r\n              contains: 'Contains'\r\n            },\r\n            date: {\r\n              gte: 'Begin Date',\r\n              lte: 'End Date'\r\n            }\r\n          }\r\n        }\r\n      },\r\n      /**\r\n   * Generator Frequency\r\n   */\r\n      generatorFrequency: [50, 60],\r\n      generatorStatus: [\r\n        'Deployed',\r\n        'Maintenance',\r\n        'Decommissioned',\r\n        'Ready for deployment'\r\n      ],\r\n      /**\r\n   * Generator Engine Rating\r\n   */\r\n      generatorEngineRating: ['Prime', 'Continuous', 'Standby'],\r\n\r\n      //location types\r\n      locationTypes: [\r\n        'construction-site',\r\n        'address',\r\n        'bank',\r\n        'border crossing',\r\n        'building',\r\n        'city',\r\n        'clinic',\r\n        'collection-site',\r\n        'compost-plant',\r\n        'country',\r\n        'customer',\r\n        'customer service center',\r\n        'depot',\r\n        'distribution center'\r\n      ],\r\n      //geofence types\r\n      geofenceTypes: ['inclusive', 'exclusive'],\r\n      /**\r\n   * User profile Settings\r\n   */\r\n      userRole: ['Administrator', 'Operator'],\r\n      volume: ['l', 'gal'],\r\n      distance: ['km', 'mi'],\r\n      pressure: ['psi', 'bar'],\r\n      speed: ['km/hr', 'mi/hr'],\r\n      temperature: ['Celsius', 'Fahrenheit'],\r\n      dateTimeFormat: [\r\n        'D/MM/YYYY h:mm:ss a',\r\n        'MM/D/YYYY h:mm:ss a',\r\n        'YYYY-MM-DD h:mm:ss a',\r\n        'YYYY-MM-DD h:mm:ss a',\r\n        'YYYY-MM-DD HH:mm:ss Z'\r\n      ],\r\n      dateFormat: ['D/MM/YYYY', 'MM/D/YYYY', 'YYYY-MM-DD'],\r\n      timeFormat: ['h:mm:ss a', 'HH:mm:ss']\r\n    };\r\n  }\r\n}\r\n","export class AuthContext {\r\n    constructor() { }\r\n}","export class AuthGuard {\r\n    constructor(){\r\n        console.log('auth guard const');\r\n    }\r\n    activate() {\r\n        console.info('auth guard was called');\r\n        let active;\r\n        if (localStorage.getItem('currentUser')) {\r\n            console.warn('user is logged in');\r\n\r\n        } else {\r\n            console.log('user is not logged in');\r\n        }\r\n    }\r\n}","export default {\r\n  debug: true,\r\n  testing: false\r\n};\r\n","import { Aurelia, inject } from 'aurelia-framework';\r\nimport { HttpClient } from 'aurelia-http-client';\r\nimport { Router } from 'aurelia-router';\r\n\r\n@inject(Aurelia, HttpClient, Router)\r\nexport class Http {\r\n  constructor(aurelia, client, router) {\r\n    let me = this;\r\n    this.client = client;\r\n    this.aurelia = aurelia;\r\n    this.router = router;\r\n    console.log('client contructor');\r\n\r\n    this.client.configure(x => {\r\n      x.withBaseUrl(App.config.apiUrl);\r\n      x\r\n        .withHeader('Access-Control-Allow-Credentials', 'application/json')\r\n        .withHeader('content-type', 'application/json')\r\n        .withHeader('Accept', 'application/json, text/plain, */*')\r\n        .withCredentials(true)\r\n        .withInterceptor({\r\n          request(message) {\r\n            // console.log('request');\r\n            return message;\r\n          },\r\n\r\n          requestError(error) {\r\n            // console.log('requestError');\r\n            throw error;\r\n          },\r\n\r\n          response(message) {\r\n            // console.log('response');\r\n            return JSON.parse(message.response);\r\n          },\r\n\r\n          responseError(error) {\r\n            // console.log('responseError');\r\n            me.handleHttpErrors(error);\r\n          }\r\n        });\r\n    });\r\n  }\r\n\r\n  handleHttpErrors(error) {\r\n    let me = this;\r\n    console.log('error: ', error);\r\n    switch (error.statusCode) {\r\n    case 0:\r\n      Materialize.toast(\r\n          'Server is not reachable. Please contact the system administrator',\r\n          5000\r\n        );\r\n      break;\r\n\r\n    case 401:\r\n      localStorage.removeItem('currentUser');\r\n      delete App.currentUser;\r\n      me.aurelia.setRoot('login/login');\r\n      Materialize.toast('User is Unathorized', 5000);\r\n      break;\r\n\r\n    case 413:\r\n      Materialize.toast('File size is too large', 5000);\r\n      break;\r\n\r\n    default:\r\n      error.responseType === 'json'\r\n          ? Materialize.toast(JSON.stringify(error.response), 5000)\r\n          : Materialize.toast(error.response, 5000);\r\n      break;\r\n    }\r\n  }\r\n}\r\n","import environment from './environment';\r\n\r\nexport function configure(aurelia) {\r\n  aurelia.use\r\n    .standardConfiguration()\r\n    .feature('resources');\r\n\r\n  if (environment.debug) {\r\n    aurelia.use.developmentLogging();\r\n  }\r\n\r\n  if (environment.testing) {\r\n    aurelia.use.plugin('aurelia-testing');\r\n  }\r\n\r\n  //initialise\r\n  aurelia.start().then(a => {\r\n    let rootComponent = isLoggedIn() ? 'app' : 'login/login';\r\n    a.setRoot(rootComponent, document.body);\r\n  });\r\n}\r\n\r\nfunction isLoggedIn() {\r\n\r\n  if (localStorage.getItem('currentUser')) {\r\n    return true\r\n  } else {\r\n    return false;\r\n  }\r\n}","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { Chart } from 'chart.js';\r\n\r\nimport { Router } from 'aurelia-router';\r\n\r\n@inject(Http, Router)\r\nexport class AdList {\r\n  http;\r\n  user;\r\n\r\n  //project object\r\n  project = {};\r\n\r\n  //widgets\r\n  grid;\r\n  tagger;\r\n  cards = {};\r\n\r\n  constructor(http, router) {\r\n    this.http = http;\r\n    this.router = router;\r\n    this.user = App.currentUser;\r\n  }\r\n\r\n  /**\r\n   * Run once DOM is attached\r\n   */\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('list-tags', {\r\n      allowDuplicates: false,\r\n      //on addition of tags\r\n      onTagAdd: function(event, tag) {\r\n        if (me.tagger) {\r\n          me.renderGrid(me.tagger.getTags().values);\r\n        }\r\n      },\r\n      //on removal of tag\r\n      onTagRemove: function(event, tag) {\r\n        me.renderGrid(me.tagger.getTags().values);\r\n      }\r\n    });\r\n\r\n    //check if it's a project view\r\n    if (\r\n      this.router.currentInstruction.params &&\r\n      this.router.currentInstruction.params.id\r\n    ) {\r\n      let id = this.router.currentInstruction.params.id;\r\n      this.getProject(id, () => {\r\n        this.loading = false;\r\n        this.deferred();\r\n      });\r\n    } else {\r\n      this.deferred();\r\n    }\r\n  }\r\n\r\n  deferred() {\r\n    let me = this;\r\n    //render all assets grid\r\n    me.renderGrid();\r\n\r\n    //render engine rating pie\r\n    // me.renderEngineRatingChart();\r\n\r\n    //render genset capacity graph\r\n    // me.renderCapacityChart();\r\n  }\r\n\r\n  /**\r\n     * Get the asset model\r\n     * @param {*} id Asset _id\r\n     */\r\n  getProject(id, callback) {\r\n    this.http.client.get(`/project/id/${id}`).then(res => {\r\n      if (res && res.data) {\r\n        this.project = res.data[0];\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render grid listing all assets\r\n   * @param {*} tags\r\n   */\r\n  renderGrid(tags) {\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        detailTemplate: kendo.template($('#template').html()),\r\n        columns: [\r\n          {\r\n            template: \"<a href='\\\\#asset-details/#:_id#'>#:name#</a>\",\r\n            field: 'name',\r\n            title: 'Asset Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'model',\r\n            title: 'Model Name',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'manufacturer',\r\n            title: 'Manufacturer',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'controlPanelManufacturer',\r\n            title: 'Control Panel Manufacturer',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'updated_at',\r\n            title: 'Modified Time',\r\n            template: '#: App.util.format.dateTime(data.updated_at, App.currentUser.dateTimeFormat) #',\r\n            filterable: {\r\n              extra: 'true',\r\n              messages: {\r\n                info: 'Show items between dates:'\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //check for asset admin access(1)\r\n    if (App.currentUser.privileges.indexOf(1) > -1) {\r\n      config.toolbar.push({\r\n        template: '<a class=\"k-button\" href=\"\\\\#/asset-admin\"><span class=\"k-icon k-i-plus-outline\"></span> Create New</a>'\r\n      });\r\n    }\r\n\r\n    //set the data types\r\n    // config.dataSource.schema.model.fields = {\r\n    //   name: { type: 'string' },\r\n\r\n    // };\r\n\r\n    //extend to include tags\r\n    if (tags) {\r\n      config.dataSource.filter = { field: 'tags', operator: 'eq', value: tags };\r\n    }\r\n\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/asset';\r\n    //get project filter\r\n    if (this.project._id && this.project.assets) {\r\n      config.dataSource.filter = $.extend(config.dataSource.filter, {\r\n        field: 'ids',\r\n        operator: 'eq',\r\n        value: this.project.assets.join(',')\r\n      });\r\n    }\r\n\r\n    this.grid = $('#assetGrid').kendoGrid(config);\r\n  }\r\n  /**\r\n   * Render Engine Rating Pie Chart\r\n   */\r\n  renderEngineRatingChart() {\r\n    let me = this;\r\n    let url = this.project._id\r\n      ? `/statistics/generatorenginerating/${this.project._id}`\r\n      : '/statistics/generatorenginerating/';\r\n    //add mask\r\n    this.loadingEngineRatingChart = true;\r\n    this.http.client.get(url).then(res => {\r\n      me.noEngineRatingChart = false;\r\n      //remove mask\r\n      me.loadingEngineRatingChart = false;\r\n      if (res && res.data.length && res.data[0].generatorEngineRating) {\r\n        let engineRating = res.data[0].generatorEngineRating;\r\n        me.cards.engineRatingChart = new Chart(me.engineRatingChart, {\r\n          type: 'pie',\r\n          data: {\r\n            labels: ['Prime', 'Continous', 'Stand-by'],\r\n            datasets: [\r\n              {\r\n                data: [\r\n                  engineRating.prime,\r\n                  engineRating.continuous,\r\n                  engineRating.standby\r\n                ],\r\n                backgroundColor: ['#00838f', '#00acc1', '#b2ebf2', '#e0f7fa'],\r\n                hoverBackgroundColor: ['#00838f', '#00acc1', '#b2ebf2', '#e0f7fa']\r\n              }\r\n            ]\r\n          }\r\n        });\r\n      } else {\r\n        //hide element\r\n        me.noEngineRatingChart = true;\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * Render Capcity Bar Chart\r\n   */\r\n  renderCapacityChart() {\r\n    let me = this;\r\n    let url = this.project._id\r\n      ? `/statistics/generatorcapacity/${this.project._id}`\r\n      : '/statistics/generatorcapacity/';\r\n    //add mask\r\n    this.loadingCapacityChart = true;\r\n    this.http.client.get(url).then(res => {\r\n      //remove mask\r\n      me.loadingCapacityChart = false;\r\n      if (res && res.data.length && res.data[0].generatorCapacity) {\r\n        me.noCapacityChart = false;\r\n        let data = [];\r\n        let categories = [];\r\n        let generatorCapacity = res.data[0].generatorCapacity;\r\n        for (let rating in generatorCapacity) {\r\n          data.push(generatorCapacity[rating]);\r\n          categories.push(rating);\r\n        }\r\n        //render chart\r\n        $(this.capacityChart).kendoChart({\r\n          title: {\r\n            text: 'Genset Capacity Statistics'\r\n          },\r\n          theme: 'material',\r\n          legend: {\r\n            position: 'top'\r\n          },\r\n          seriesDefaults: {\r\n            type: 'column'\r\n          },\r\n          seriesColors: ['#00838f', '#0097a7', '#00acc1', '#00bcd4', '#26c6da', '#4dd0e1', '#80deea', '#b2ebf2', '#e0f7fa'],\r\n          series: [\r\n            {\r\n              name: 'Generators',\r\n              data: data\r\n            }\r\n          ],\r\n          valueAxis: {\r\n            labels: {\r\n              format: '{0}'\r\n            },\r\n            line: {\r\n              visible: true\r\n            },\r\n            axisCrossingValue: 0\r\n          },\r\n          categoryAxis: {\r\n            categories: categories,\r\n            line: {\r\n              visible: false\r\n            }\r\n\r\n            // labels: {\r\n\r\n            //     padding: { top: 135 }\r\n\r\n            // }\r\n          },\r\n          tooltip: {\r\n            visible: true,\r\n            format: '{0} kVA',\r\n            template: '#= series.name #: #= value #'\r\n          }\r\n        });\r\n      } else {\r\n        //hide element\r\n        me.noCapacityChart = true;\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Http)\r\nexport class Alarms {\r\n  constructor(http) {\r\n    this.http = http;\r\n  }\r\n\r\n  attached() {\r\n    App.currentView = this;\r\n    //render all active alarms grid\r\n    this.renderAlarms();\r\n  }\r\n\r\n  /**\r\n  * Render Active Alarms List\r\n  */\r\n  renderAlarms() {\r\n    let me = this;\r\n\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            field: '_asset.name',\r\n            title: 'Asset',\r\n            template: \"# if (_asset) { # <a href='\\\\#asset-details/#:_asset._id#'>#:_asset.name#</a> #}#\"\r\n          },\r\n          { field: 'name', title: 'Alarm' },\r\n          {\r\n            field: 'triggerTime',\r\n            title: 'Trigger Time',\r\n            template: '#: App.util.format.dateTime(data.triggerTime, App.currentUser.dateTimeFormat) #'\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //don't auto adjust\r\n    config.dataBound = function() {\r\n      //do nothing\r\n    };\r\n\r\n    // check if geofence admins is active for the user\r\n    if (App.currentUser.privileges.indexOf(5) > -1) {\r\n      config.columns.push(\r\n        {\r\n          command: { text: 'Reset', click: me.acknowledgeAlarm },\r\n          title: 'Command',\r\n          width: '100px'\r\n        }\r\n      );\r\n    }\r\n\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/alarm';\r\n\r\n    //filter only the triggered alarms\r\n    config.dataSource.filter = { field: 'triggered', operator: 'eq', value: true };\r\n\r\n    this.grid = $('#alarms').kendoGrid(config);\r\n\r\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n  }\r\n\r\n  /**\r\n  * Acknowledge alarm\r\n  * @param {*} e an click event on the grid\r\n  */\r\n  acknowledgeAlarm(e) {\r\n    e.preventDefault();\r\n\r\n    let dataItem = this.dataItem($(e.currentTarget).closest('tr'));\r\n\r\n    kendo.prompt('Please, enter a comment', '').then(\r\n      function(data) {\r\n        $.ajax({\r\n          method: 'PUT',\r\n          url: App.config.apiUrl + '/alarm/reset',\r\n          data: { _id: dataItem._id, msg: data, alarm: dataItem.toJSON() },\r\n          success: function(res) {\r\n            kendo.alert('Acknowledgement sucessful');\r\n            //re-render the active alarms grid\r\n            App.currentView.renderAlarms();\r\n          },\r\n          error: function(err) {\r\n            me.renderAlarms();\r\n          }\r\n        });\r\n      },\r\n      function() {\r\n        kendo.alert('Acknowledgement cancelled');\r\n      }\r\n    );\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Http)\r\nexport class Administration {\r\n  constructor(http) {\r\n    this.http = http;\r\n\r\n    // teamfnol@247homerescue.co.uk\r\n    // auth.smtp.1and1.co.uk\r\n    // port 25\r\n    // password: hassan123\r\n    // host: 'smtp.gmail.com',\r\n    // port: 465,\r\n    // secure: true, // secure:true for port 465, secure:false for port 587\r\n    // auth: {\r\n    // user: 'thepropertybuyingcompanyae@gmail.com',\r\n    // pass: 'onlyvimal1'\r\n    // }\r\n  }\r\n\r\n  attached() {\r\n    App.currentView = this;\r\n\r\n    //tab strip\r\n    $('.tabstrip').kendoTabStrip({\r\n      animation: {\r\n        open: {\r\n          effects: 'fadeIn'\r\n        }\r\n      }\r\n    });\r\n\r\n    //render all active alarms grid\r\n    this.renderUsers();\r\n  }\r\n\r\n  /**\r\n   * Render grid listing all assets\r\n   * @param {*} tags\r\n   */\r\n  renderUsers(tags) {\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        detailTemplate: kendo.template($('#template').html()),\r\n        columns: [\r\n          {\r\n            field: 'loginName',\r\n            title: 'Login Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'name',\r\n            title: 'Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'firstName',\r\n            title: 'First Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'lastName',\r\n            title: 'Last Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'phoneNo',\r\n            title: 'Phone Number',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'updated_at',\r\n            title: 'Modified Time',\r\n            template: \"# if (updated_at){# #: moment(updated_at).format('DD/M/YYYY h:mm:ss a') # #}#\",\r\n            filterable: {\r\n              extra: 'true',\r\n              messages: {\r\n                info: 'Show items between dates:'\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    config.toolbar.push({\r\n      template: '<a class=\"k-button\" href=\"\\\\#/user-admin\"><span class=\"k-icon k-i-plus-outline\"></span> Create New</a>'\r\n    });\r\n\r\n    //set the data types\r\n    // config.dataSource.schema.model.fields = {\r\n    //   name: { type: 'string' },\r\n\r\n    // };\r\n\r\n    //extend to include tags\r\n    if (tags) {\r\n      config.dataSource.filter = { field: 'tags', operator: 'eq', value: tags };\r\n    }\r\n\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/user';\r\n\r\n    this.grid = $('#appUsers').kendoGrid(config);\r\n  }\r\n\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Router } from 'aurelia-router';\r\n\r\n@inject(Router)\r\nexport class AppHeader\r\n{\r\n  constructor(router) {\r\n    this.router = router;\r\n  }\r\n\r\n  /**\r\n   * Once the header dom is attached\r\n   */\r\n  attached() {\r\n    this.renderUniversalSearch();\r\n  }\r\n\r\n  /**\r\n   * Render Universal Search box\r\n   */\r\n  renderUniversalSearch() {\r\n    let me = this;\r\n    //create AutoComplete UI component\r\n    $('#universal-search').kendoAutoComplete({\r\n      dataTextField: 'name',\r\n      ignoreCase: false,\r\n      filter: 'contains',\r\n      minLength: 3,\r\n      placeholder: 'Search...',\r\n      dataSource: {\r\n        type: 'odata',\r\n        serverFiltering: true,\r\n        transport: {\r\n          read: {\r\n            type: 'GET',\r\n            contentType: 'application/json',\r\n            accept: 'application/json, text/plain, */*',\r\n            dataType: 'json',\r\n            xhrFields: { withCredentials: true },\r\n            url: App.config.apiUrl + '/misc/find/'\r\n          }\r\n        }\r\n      },\r\n      template: '# if(data.objectType==\"Asset\"){ # <i class=\"mdi-image-flash-on tiny\"></i> # } else {# <i class=\"mdi-communication-business tiny\"></i> #}# #: data.name #',\r\n      select: function(e) {\r\n        //navigate to object\r\n        if (e.dataItem.objectType) {\r\n          console.log(e.dataItem.objectType);\r\n          switch (e.dataItem.objectType) {\r\n          case 'Asset':\r\n            me.router.navigateToRoute('asset-details', {id: e.dataItem._id});\r\n            break;\r\n          case 'Project':\r\n            me.router.navigateToRoute('asset-list/:id', {id: e.dataItem._id});\r\n            break;\r\n          default:\r\n          //do nothing\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n    // Fullscreen\r\n  toggleFullScreen() {\r\n    console.log(document);\r\n    if ((document.fullScreenElement && document.fullScreenElement !== null) ||\r\n            (!document.mozFullScreen && !document.webkitIsFullScreen)) {\r\n      if (document.documentElement.requestFullScreen) {\r\n        document.documentElement.requestFullScreen();\r\n      } else if (document.documentElement.mozRequestFullScreen) {\r\n        document.documentElement.mozRequestFullScreen();\r\n      } else if (document.documentElement.webkitRequestFullScreen) {\r\n        document.documentElement.webkitRequestFullScreen();\r\n      }\r\n    } else {\r\n      if (document.cancelFullScreen) {\r\n        document.cancelFullScreen();\r\n      } else if (document.mozCancelFullScreen) {\r\n        document.mozCancelFullScreen();\r\n      } else if (document.webkitCancelFullScreen) {\r\n        document.webkitCancelFullScreen();\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Aurelia, inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n\r\n@inject(Aurelia, Http)\r\nexport class AppNavbar {\r\n  loading = true;\r\n  user = {};\r\n  alarmsCount = 0;\r\n\r\n  constructor(aurelia, http) {\r\n    let me = this;\r\n    this.aurelia = aurelia;\r\n    this.http = http;\r\n\r\n    //once\r\n    // me.getAlarmsCount();\r\n    // //setup a poller\r\n    // this.alarmCountPoller = setInterval(() => {\r\n    //   if (App.currentUser) {\r\n    //     //  me.getAlarmsCount();\r\n    //   }\r\n    // }, 10 * 1000);\r\n  }\r\n\r\n  /**\r\n   * Once DOM is attached\r\n   */\r\n  attached() {\r\n    console.info('navbar activate');\r\n    let userData = localStorage.getItem('currentUser');\r\n\r\n    if (!userData) {\r\n      this.aurelia.setRoot('login/login');\r\n    } else {\r\n      App.currentUser = this.user = JSON.parse(userData);\r\n    }\r\n    this.loading = false;\r\n\r\n\r\n    //create support dialog box\r\n    $('#supportDialog').kendoDialog({\r\n      width: '800rem',\r\n      title: 'Contact Support',\r\n      closable: true,\r\n      modal: true,\r\n      content: `<iframe title=\"Feedback Form\" class=\"freshwidget-embedded-form\" \r\n      id=\"freshwidget-embedded-form\" src=\"https://razrlab.freshdesk.com/widgets/feedback_widget/new?&widgetType=embedded&screenshot=no\" \r\n      scrolling=\"no\" height=\"500px\" width=\"100%\" frameborder=\"0\" ></iframe>`\r\n    });\r\n\r\n    $(this.supportDialog).data('kendoDialog') &&\r\n      $(this.supportDialog).data('kendoDialog').close();\r\n  }\r\n\r\n  /**\r\n   * Get Alarms Count\r\n   */\r\n  getAlarmsCount() {\r\n    let me = this;\r\n    this.http.client.get('/alarm/count').then(res => {\r\n      if (res) {\r\n        me.alarmsCount = res.data;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * User logout function\r\n   */\r\n  logout() {\r\n    console.info('user logout');\r\n    //login user\r\n    this.http.client.post('/user/logout', this.model).then(res => {\r\n      this.loading = false;\r\n      if (res) {\r\n        localStorage.removeItem('currentUser');\r\n        delete App.currentUser;\r\n        this.aurelia.setRoot('login/login');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Diplay Help and Support Dialog\r\n   */\r\n  showSupportDialog() {\r\n    $(this.supportDialog).data('kendoDialog') &&\r\n      $(this.supportDialog).data('kendoDialog').open();\r\n  }\r\n\r\n  deattached() {\r\n    console.log('navbar deattached');\r\n    //clear out the poller\r\n    clearInterval(this.alarmCountPoller);\r\n  }\r\n}\r\n","export class AppFooter {\r\n    constructor() { }\r\n}","import { Aurelia, inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Aurelia, Http)\r\nexport class AppNotifications {\r\n\r\n  App = App;\r\n\r\n\r\n  alarms = []\r\n  notifications = []\r\n\r\n  constructor(aurelia, http) {\r\n    this.aurelia = aurelia;\r\n    this.http = http;\r\n    this.App = App;\r\n  }\r\n  attached() {\r\n    console.log('notification bar');\r\n    //Main Left Sidebar Menu\r\n    $('.sidebar-collapse').sideNav({\r\n      edge: 'left' // Choose the horizontal origin\r\n    });\r\n\r\n    //Main Left Sidebar Chat\r\n    $('.chat-collapse').sideNav({\r\n      menuWidth: 240,\r\n      edge: 'right'\r\n    });\r\n    $('.chat-close-collapse').click(function() {\r\n      $('.chat-collapse').sideNav('hide');\r\n    });\r\n    $('.chat-collapsible').collapsible({\r\n      accordion: false // A setting that changes the collapsible behavior to expandable instead of the default accordion style\r\n    });\r\n\r\n    // Perfect Scrollbar\r\n    $('select').not('.disabled').material_select();\r\n    let leftnav = $('.page-topbar').height();\r\n    let leftnavHeight = window.innerHeight - leftnav;\r\n    $('.leftside-navigation').height(leftnavHeight).perfectScrollbar({\r\n      suppressScrollX: true\r\n    });\r\n    let righttnav = $('#chat-out').height();\r\n    $('.rightside-navigation').height(righttnav).perfectScrollbar({\r\n      suppressScrollX: true\r\n    });\r\n\r\n    this.getNotifications();\r\n\r\n    //get user notifications\r\n    setInterval(() => {\r\n      this.getNotifications();\r\n    }, 30000);\r\n  }\r\n\r\n  /**\r\n   * Get notifications for the user\r\n   */\r\n  getNotifications() {\r\n    // let me = this;\r\n    this.alarms = [];\r\n    this.notifications = [];\r\n    if (App.currentUser && App.currentUser._id) {\r\n      this.http.client.get(`/user/notifications/${App.currentUser._id}`).then(res => {\r\n        if (res) {\r\n          let cache = res.data.notificationCache;\r\n          //loop through the notifications\r\n          for (let i = 0; i < cache.length; i++) {\r\n            if (cache[i].objectType) {\r\n              switch (cache[i].objectType) {\r\n              case 'Alarm':\r\n                this.alarms.push(cache[i]);\r\n                break;\r\n              default:\r\n                  //do nothing\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Dismiss a specific user notification\r\n   * @param {*} id\r\n   */\r\n  dismissNotification(id) {\r\n    let me = this;\r\n    if (App.currentUser && App.currentUser._id) {\r\n      this.http.client.post(`/user/notifications/dismiss/${App.currentUser._id}`, {\r\n        id: id\r\n      }).then(res => {\r\n        if (res && res.message) {\r\n          Materialize.toast(res.message, 3000);\r\n        }\r\n        me.getNotifications();\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class AssetAdmin {\r\n  loading = true;\r\n\r\n  //asset model\r\n  model = {\r\n    features: App.config.features\r\n  };\r\n\r\n  //creating (false) or updating flag (true)\r\n  update = false;\r\n\r\n  //asset tags\r\n  tagger;\r\n\r\n  constructor(http, httpClient) {\r\n    this.client = http.client;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  /**\r\n     * Once the component is activated\r\n     * @param {string} params asset _id\r\n     */\r\n  activate(params) {\r\n    if (params.id) {\r\n      //updating\r\n      this.update = true;\r\n      this.client.get(`/asset/id/${params.id}`).then(res => {\r\n        this.loading = false;\r\n        if (res && res.data) {\r\n          //set the asset model\r\n          this.model = $.extend(true, this.model, res.data[0]);\r\n          //add tags\r\n          this.tagger.add(this.model.tags);\r\n          //set Generator Frequency Value\r\n          if (this.model.generatorFrequency) {\r\n            $(this.generatorFrequency)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorFrequency);\r\n          }\r\n          if (this.model.generatorEngineRating) {\r\n            $(this.generatorEngineRating)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorEngineRating);\r\n          }\r\n          if (this.model.status) {\r\n            $(this.status).data('kendoDropDownList').value(this.model.status);\r\n          }\r\n          if (this.model.interfaceType) {\r\n            $(this.interfaceType)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.interfaceType);\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Once the DOM is attached\r\n     */\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('admin-tags', {\r\n      allowDuplicates: false\r\n    });\r\n\r\n    //create generator Frequency dropdown\r\n    $(this.generatorFrequency).kendoDropDownList({\r\n      dataSource: App.config.generatorFrequency,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorFrequency = this.value();\r\n      }\r\n    });\r\n    //generator engine rating dropdown\r\n    $(this.generatorEngineRating).kendoDropDownList({\r\n      dataSource: App.config.generatorEngineRating,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorEngineRating = this.value();\r\n      }\r\n    });\r\n    //generator status dropdown\r\n    $(this.status).kendoDropDownList({\r\n      dataSource: App.config.generatorStatus,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.status = this.value();\r\n      }\r\n    });\r\n    //mailbox types\r\n    $(this.interfaceType).kendoDropDownList({\r\n      dataSource: App.config.interfaceType,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.interfaceType = this.value();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Uploading an avatar\r\n   * @param {*} images\r\n   */\r\n  uploadAssetImage(images) {\r\n    console.log('uploadAssetImage');\r\n    if (images && images[0]) {\r\n      let image = images[0];\r\n      let filename;\r\n\r\n      switch (image.type) {\r\n      case 'image/png':\r\n        filename = this.model._id + '.png';\r\n        break;\r\n\r\n      case 'image/jpeg':\r\n        filename = this.model._id + '.jpg';\r\n        break;\r\n\r\n      default:\r\n        Materialize.toast('Please upload a .jpg or .png file', 3000);\r\n        break;\r\n      }\r\n      if (filename && this.model._id) {\r\n        let me = this;\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('images', image, filename);\r\n        formData.append('_id', this.model._id);\r\n\r\n        //use FETCH API to POST image\r\n\r\n        this.fetchAPI\r\n          .fetch(App.config.apiUrl + '/asset/photo', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            if (data) {\r\n              Materialize.toast('Asset image uploaded successfully.', 3000);\r\n            }\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload an image.', 2000);\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Create or Update Asset\r\n     */\r\n  submit() {\r\n    this.loading = true;\r\n\r\n    //get tags\r\n    if (this.tagger) {\r\n      this.model.tags = this.tagger.getTags().values;\r\n    }\r\n\r\n    if (this.update) {\r\n      //update\r\n      this.client.put(`/asset/id/${this.model._id}`, this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    } else {\r\n      //create\r\n      this.client.post('/asset/', this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete the asset\r\n   */\r\n  delete() {\r\n    //create\r\n    this.client.delete(`/asset/id/${this.model._id}`).then(data => {\r\n      this.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //go to the list\r\n        window.location.hash = '#/asset-list';\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\nimport { Chart } from 'chart.js';\r\n\r\n@inject(Http)\r\nexport class AssetDetails {\r\n  loading = true;\r\n  http;\r\n  model = {};\r\n  poller;\r\n\r\n  //bounds\r\n  latlngBounds;\r\n  //persisting the map refresher\r\n  refresher;\r\n  //map controls object\r\n  mapControl = {\r\n    refreshInterval: 20000,\r\n    autoRefresh: true,\r\n    autoPan: true,\r\n    autoZoom: false,\r\n    autoCluster: true\r\n  };\r\n  //model for marker binding\r\n  markers = [];\r\n  //clusterer\r\n  markerCluster;\r\n\r\n  pieChart;\r\n\r\n  stats = {\r\n    controls: {\r\n      averagePowerOutput: false,\r\n      averageFuelConsumed: false\r\n    },\r\n    averagePowerOutput: '43 kVA/Hr',\r\n    averageFuelConsumed: '5 L/Hr',\r\n    data: {\r\n      averagePowerOutput: {\r\n        false: '43 kVA/Hr',\r\n        true: '282 kVA/Day'\r\n      },\r\n      averageFuelConsumed: {\r\n        false: '5 L/Hr',\r\n        true: '40 L/Day'\r\n      }\r\n    }\r\n  };\r\n\r\n  constructor(http) {\r\n    App.currentView = this;\r\n    this.http = http;\r\n  }\r\n\r\n  activate(params) {\r\n    if (params && params.id) {\r\n      this.getAsset(params.id, () => {\r\n        this.loading = false;\r\n        this.deferred();\r\n      });\r\n    }\r\n  }\r\n\r\n  attached() {\r\n    //for menu tab\r\n    $('#tabstrip').kendoTabStrip({\r\n      animation: {\r\n        open: {\r\n          effects: 'fadeIn'\r\n        }\r\n      }\r\n    });\r\n\r\n    //collapsible\r\n    $('.collapsible').collapsible();\r\n\r\n    //set command status\r\n    this.setCommandStatuses();\r\n  }\r\n\r\n  /**\r\n     * Get the asset model\r\n     * @param {*} id Asset _id\r\n     */\r\n  getAsset(id, callback) {\r\n    this.http.client.get(`/asset/id/${id}`).then(res => {\r\n      if (res && res.data) {\r\n        this.model = res.data[0];\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  deferred() {\r\n    let me = this;\r\n\r\n    this.renderLine();\r\n    this.renderFuelLevelGauge();\r\n\r\n    //start the poller\r\n\r\n\r\n    this.initMap(() => {\r\n      //stupid hacky workaround :(\r\n      setTimeout( () => {\r\n        google.maps.event.trigger(me.googleMap, 'resize');\r\n      }, 500);\r\n      //for demo let's not do this\r\n      this.renderAssetMarker(() => { });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initialize Map\r\n   * @param {*} callback\r\n   */\r\n  initMap(callback) {\r\n    console.log('initMap');\r\n\r\n    //create bounds instance\r\n    this.latlngBounds = new google.maps.LatLngBounds();\r\n    //create map instance\r\n    this.googleMap = new google.maps.Map(\r\n      document.getElementById('assetOverviewMap'),\r\n      {\r\n        zoom: 3,\r\n        center: { lat: 25, lng: 55 },\r\n        // mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n        mapTypeId: 'satellite',\r\n        mapTypeControl: true,\r\n        scrollwheel: true,\r\n        draggable: true,\r\n        mapTypeControlOptions: {\r\n          style: google.maps.MapTypeControlStyle.DROPDOWN_MENU\r\n        },\r\n        navigationControl: false,\r\n        navigationControlOptions: {\r\n          style: google.maps.NavigationControlStyle.SMALL\r\n        }\r\n      }\r\n    );\r\n\r\n    //render legend\r\n    this.renderLegend(this.googleMap);\r\n\r\n    callback();\r\n  }\r\n\r\n  /**\r\n  * Render Map Legend\r\n  */\r\n  renderLegend(map) {\r\n    let legend = this.legend;\r\n    legend.innerHTML = `\r\n        <div class='card map-legend'>\r\n          <h7>Legend</h7>\r\n          <ul>\r\n            <li><img src=\"/images/map/icons/on-sm.png\"> ON</li>\r\n            <li><img src=\"/images/map/icons/off-sm.png\"> OFF</li>\r\n            <li><img src=\"/images/map/icons/alert-sm.png\"> Alarmed</li>\r\n            <li><img src=\"/images/map/icons/maintenance-sm.png\"> Maintenance</li>\r\n            <li><img src=\"/images/map/icons/unknown-sm.png\"> Unknown</li>\r\n            <li><img src=\"/images/map/icons/decommissioned-sm.png\"> Decommissioned</li>\r\n          </ul>\r\n        </div>\r\n        `;\r\n    map.controls[google.maps.ControlPosition.RIGHT_TOP].push(legend);\r\n  }\r\n\r\n  /**\r\n    * Rendering Asset Markers on Map\r\n    * @param {*} callback\r\n    */\r\n  renderAssetMarker(callback) {\r\n    let me = this;\r\n    if (this.markerCluster) {\r\n      this.removeCluster();\r\n    }\r\n    //clean up the markers\r\n    this.markers = [];\r\n    //load all assets on map\r\n    this.http.client.get(`/map/assets/?ids=${this.model._id}`).then(res => {\r\n      if (res) {\r\n        for (let i = 0; i < res.data.length; i++) {\r\n          let markerInfo = res.data[i];\r\n          let infowindow = new google.maps.InfoWindow({\r\n            content: `\r\n                            <div id=\"map-tabstrip\">\r\n                            <ul>\r\n                                <li class=\"k-state-active\">\r\n                                    Event Info\r\n                                </li>\r\n                                <li>\r\n                                    Asset Info\r\n                                </li>\r\n                            </ul>\r\n                            <div>\r\n                               <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Name</b></td>\r\n                                            <td><a href='#asset-details/${markerInfo._asset._id}'>${markerInfo._asset.name}</a></td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Status</b></td>\r\n                                            <td>${markerInfo._asset.status || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Event Type</b></td>\r\n                                            <td>${markerInfo.eventType}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                           <td><b>Event Time</b></td>\r\n                                            <td>${App.util.format.dateTime(markerInfo.eventTime, App.currentUser.dateTimeFormat)}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Position</b></td>\r\n                                            <td>${markerInfo.latitude}, ${markerInfo.longitude}</td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                            <div>\r\n                                <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Engine Status</b></td>\r\n                                            <td>${markerInfo.engineStatus || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Engine Hour Meter</b></td>\r\n                                            <td>${markerInfo.engineHourMeter || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Supply Voltage</b></td>\r\n                                            <td>${markerInfo.powerSupplyVoltage || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Coolant Temperature</b></td>\r\n                                            <td>${App.util.format.item(markerInfo.engineCoolantTemperature, 'temperature') || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Oil Pressure</b></td>\r\n                                            <td>${App.util.format.item(markerInfo.oilPressure, 'pressure') || '-'}</td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                        </div>\r\n                                    `\r\n          });\r\n\r\n          // asset map icon\r\n          let iconUrl = '/images/map/icons/unknown.png';\r\n          if (\r\n            markerInfo._asset.status && markerInfo._asset.status !== 'Deployed'\r\n          ) {\r\n            switch (markerInfo._asset.status) {\r\n            case 'Maintenance':\r\n              iconUrl = '/images/map/icons/maintenance.png';\r\n              break;\r\n\r\n            case 'Decommissioned':\r\n              iconUrl = '/images/map/icons/decommissioned.png';\r\n              break;\r\n\r\n            default:\r\n                //do nothing\r\n              break;\r\n            }\r\n          } else {\r\n            if (markerInfo._asset && markerInfo._asset.features.engineStatus) {\r\n              switch (markerInfo._asset.features.engineStatus.value) {\r\n              case 'on':\r\n                iconUrl = '/images/map/icons/on.png';\r\n                break;\r\n\r\n              case 'off':\r\n                iconUrl = '/images/map/icons/off.png';\r\n                break;\r\n\r\n              default:\r\n                  //do nothing\r\n                break;\r\n              }\r\n            }\r\n          }\r\n\r\n          //create marker object\r\n          let marker = new google.maps.Marker({\r\n            position: {\r\n              lat: parseFloat(markerInfo.latitude),\r\n              lng: parseFloat(markerInfo.longitude)\r\n            },\r\n            title: markerInfo.assetName,\r\n            icon: iconUrl,\r\n            map: me.googleMap,\r\n            id: markerInfo._id\r\n          });\r\n\r\n          //add listener for the map infoWindow click\r\n          marker.addListener('click', function() {\r\n            infowindow.open(me.googleMap, marker);\r\n          });\r\n\r\n          google.maps.event.addListener(infowindow, 'domready', function(e) {\r\n            //intialize tabstrips.\r\n            $('#map-tabstrip').kendoTabStrip({\r\n              animation: {\r\n                open: {\r\n                  effects: 'fadeIn'\r\n                }\r\n              }\r\n            });\r\n            // Reference to the DIV which receives the contents of the infowindow using jQuery\r\n            let iwOuter = $('.gm-style-iw');\r\n            let iwBackground = iwOuter.prev();\r\n            // Remove the background shadow DIV\r\n            iwBackground.children(':nth-child(2)').css({ display: 'none' });\r\n            // Remove the white background DIV\r\n            iwBackground.children(':nth-child(4)').css({ display: 'none' });\r\n          });\r\n\r\n          //push the marker to class\r\n          me.markers.push(marker);\r\n\r\n          //extend bounds\r\n          me.latlngBounds.extend({\r\n            lat: parseFloat(markerInfo.latitude),\r\n            lng: parseFloat(markerInfo.longitude)\r\n          });\r\n        }\r\n\r\n        //auto pan if option is selected\r\n        if (me.mapControl.autoPan) {\r\n          me.autoPan();\r\n        }\r\n\r\n        //add clustering\r\n        if (me.mapControl.autoCluster) {\r\n          me.addClusters();\r\n        }\r\n\r\n        //return\r\n        callback && callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Auto Pan Map to Markers\r\n   */\r\n  autoPan() {\r\n    let len = this.markers.length;\r\n    for (let i = 0; i < len; i++) {\r\n      //extend bounds\r\n      this.markers[i].map && this.latlngBounds.extend(this.markers[i].position);\r\n    }\r\n    //now fit the map to the newly inclusive bounds\r\n    this.googleMap.fitBounds(this.latlngBounds);\r\n  }\r\n\r\n  /**\r\n     * Adding clustering\r\n     */\r\n  addClusters() {\r\n    this.markerClusterer = new MarkerClusterer(this.googleMap, this.markers, {\r\n      imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'\r\n    });\r\n  }\r\n\r\n  renderChart() {\r\n    let ctx = document.getElementById('myChart');\r\n    this.pieChart = new Chart(ctx, {\r\n      type: 'pie',\r\n      data: {\r\n        labels: ['Red', 'Blue', 'Yellow'],\r\n        datasets: [\r\n          {\r\n            data: [300, 50, 100],\r\n            backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56'],\r\n            hoverBackgroundColor: ['#FF6384', '#36A2EB', '#FFCE56']\r\n          }\r\n        ]\r\n      }\r\n\r\n      // options: options\r\n    });\r\n  }\r\n\r\n  renderLine() {\r\n    let canvas = document.getElementById('powerOutputLine');\r\n    let data = {\r\n      labels: [],\r\n      datasets: [\r\n        {\r\n          label: 'Power Output in kVA',\r\n          fill: true,\r\n          fillColor: '#fff',\r\n          bodyFontColor: '#fff',\r\n          lineTension: 0.3,\r\n          pointBorderColor: 'rgba(75,192,192,1)',\r\n          pointBackgroundColor: '#fff',\r\n          pointBorderWidth: 1,\r\n          pointHoverRadius: 5,\r\n          pointHoverBackgroundColor: 'rgba(75,192,192,1)',\r\n          pointHoverBorderColor: 'rgba(220,220,220,1)',\r\n          pointHoverBorderWidth: 2,\r\n          pointRadius: 5,\r\n          pointHitRadius: 10,\r\n          data: []\r\n        }\r\n      ]\r\n    };\r\n\r\n    function adddata() {\r\n      myLineChart.data.datasets[0].data.push(\r\n        Math.floor(Math.random() * 10) + 35\r\n      );\r\n      myLineChart.data.labels.push(\r\n        moment(new Date()).format('DD/M/YYYY h:mm:ss a')\r\n      );\r\n      myLineChart.update();\r\n    }\r\n\r\n    let option = {\r\n      showLines: true,\r\n      legend: { labels: { fontColor: 'white' } },\r\n      scales: {\r\n        yAxes: [\r\n          {\r\n            ticks: {\r\n              fontColor: 'white',\r\n              beginAtZero: true\r\n            }\r\n          }\r\n        ],\r\n        xAxes: [\r\n          {\r\n            ticks: {\r\n              fontColor: 'white'\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    };\r\n    let myLineChart = Chart.Line(canvas, {\r\n      data: data,\r\n      options: option\r\n    });\r\n\r\n    setInterval(() => {\r\n      adddata();\r\n    }, 10000);\r\n  }\r\n\r\n  /**\r\n   * Render Asset Event History Grid\r\n   */\r\n  renderEvents() {\r\n    let me = this;\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        height: 700,\r\n        columns: [\r\n          {\r\n            field: 'eventType',\r\n            title: 'Event Type',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'eventTime',\r\n            title: 'Event Time',\r\n            template: \"#: App.util.format.dateTime(data.eventTime, App.currentUser.dateTimeFormat)|| '-' #\",\r\n            filterable: {\r\n              extra: 'true',\r\n              messages: {\r\n                info: 'Show items between dates:'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'createdTime',\r\n            title: 'Created Time',\r\n            template: \"#: App.util.format.dateTime(data.createdTime, App.currentUser.dateTimeFormat)|| '-' #\",\r\n            filterable: {\r\n              extra: 'true',\r\n              messages: {\r\n                info: 'Show items between dates:'\r\n              }\r\n            }\r\n            // hidden: true\r\n          },\r\n          {\r\n            field: 'latitude',\r\n            title: 'Latitude'\r\n\r\n            // width: 100\r\n          },\r\n          {\r\n            field: 'longitude',\r\n            title: 'Longitude'\r\n\r\n            // width: 100\r\n          },\r\n          {\r\n            field: 'payload',\r\n            title: 'Payload',\r\n            width: 100,\r\n            hidden: true\r\n          },\r\n          {\r\n            field: 'engineHourMeter',\r\n            title: 'Engine Hour Meter'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'powerOutputKW',\r\n            title: 'Power Output In KW'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'engineCoolantTemperature',\r\n            title: 'Engine Coolant Temperature',\r\n            template: \"#: App.util.format.item(data.engineCoolantTemperature,\\\"temperature\\\", true)|| '-' #\"\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'engineFrequency',\r\n            title: 'Engine Frequency'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'averageLineToLineVoltage',\r\n            title: 'Average Line To Line Voltage'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'averageLineToNeutralVoltage',\r\n            title: 'Average Line To Neutral Voltage'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'averageAcRmsCurrent',\r\n            title: 'Average Ac Rms Current'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'phaseBCurrent',\r\n            title: 'Phase B Current'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'phaseCCurrent',\r\n            title: 'Phase C Current'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'oilPressure',\r\n            title: 'Oil Pressure',\r\n            template: \"# App.util.format.item(data.oilPressure,\\\"pressure\\\", true)|| '-' #\"\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'averageFuelConsumptionnRate',\r\n            title: 'Fuel Consumption Rate'\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'fuelUsed',\r\n            title: 'fuel Used',\r\n            template: \"# App.util.format.item(data.fuelUsed,\\\"volume\\\", true)|| '-' #\"\r\n\r\n            // width: 150\r\n          },\r\n          {\r\n            field: 'currentFuelLevel',\r\n\r\n            title: 'Fuel Level',\r\n\r\n            template: \"#: App.util.format.item(data.currentFuelLevel,\\\"volume\\\") || '-' #\"\r\n\r\n            // width: 150\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //set the access url\r\n    config.dataSource.transport.read.url =\r\n      App.config.apiUrl + '/sensormessageevent';\r\n    //filter the data\r\n    config.dataSource.filter = [\r\n      {\r\n        field: '_asset',\r\n        operator: 'eq',\r\n        value: me.model._id\r\n      }\r\n    ];\r\n\r\n    //render the grid\r\n    this.grid = $('#eventGrid').kendoGrid(config);\r\n  }\r\n  /**\r\n   * render asset alarms for asset with controls\r\n   */\r\n  renderAssetAlarms() {\r\n    let me = this;\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          { field: '_asset.name', title: 'Asset' },\r\n          { field: 'name', title: 'Alarm' },\r\n          {\r\n            field: 'triggerDate',\r\n            title: 'Trigger Date',\r\n            template: '#:App.util.format.dateTime(data.triggerTime, App.currentUser.dateTimeFormat) #'\r\n          },\r\n          {\r\n            command: { text: 'Reset', click: me.acknowledgeAlarm },\r\n            title: 'Command',\r\n            width: '100px'\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //set the access url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/alarm';\r\n    //filter the data\r\n    config.dataSource.filter = [\r\n      {\r\n        field: '_asset',\r\n        operator: 'eq',\r\n        value: me.model._id\r\n      },\r\n      {\r\n        field: 'triggered',\r\n        operator: 'eq',\r\n        value: true\r\n      }\r\n    ];\r\n\r\n    //render the grid\r\n    this.grid = $(this.assetAlarms).kendoGrid(config);\r\n  }\r\n\r\n  /**\r\n  * Acknowledge alarm\r\n  * @param {*} e an click event on the grid\r\n  */\r\n  acknowledgeAlarm(e) {\r\n    e.preventDefault();\r\n\r\n    let dataItem = this.dataItem($(e.currentTarget).closest('tr'));\r\n\r\n    kendo.prompt('Please, enter a comment', '').then(\r\n      function(data) {\r\n        $.ajax({\r\n          method: 'PUT',\r\n          url: App.config.apiUrl + '/alarm/reset',\r\n          data: { _id: dataItem._id, msg: data, alarm: dataItem.toJSON() },\r\n          success: function(res) {\r\n            kendo.alert('Acknowledgement sucessful');\r\n            //re-render the active alarms grid\r\n            App.currentView.renderAssetAlarms();\r\n          },\r\n          error: function(err) {\r\n            me.renderAssetAlarms();\r\n          }\r\n        });\r\n      },\r\n      function() {\r\n        kendo.alert('Acknowledgement cancelled');\r\n      }\r\n    );\r\n  }\r\n\r\n  toggleStats(str) {\r\n    this.stats.controls[str] = !this.stats.controls[str];\r\n    this.stats[str] = this.stats.data[str][this.stats.controls[str]];\r\n  }\r\n\r\n  renderFuelLevelGauge() {\r\n    $('#gauge').kendoRadialGauge({\r\n      theme: 'material',\r\n      pointer: {\r\n        value: App.util.format.item(64, 'volume')\r\n      },\r\n      scale: {\r\n        minorUnit: 5,\r\n        startAngle: -30,\r\n        endAngle: 210,\r\n        labels: {\r\n          // labels template\r\n          template: \"#= App.util.format.item(value,'volume') #%\"\r\n        },\r\n        max: 100,\r\n        ranges: [\r\n          {\r\n            from: 0,\r\n            to: 20,\r\n            color: '#ff3d00'\r\n          },\r\n          {\r\n            from: 20,\r\n            to: 50,\r\n            color: '#ffff00'\r\n          },\r\n          {\r\n            from: 50,\r\n            to: 100,\r\n            color: '#00c853'\r\n          }\r\n        ]\r\n      }\r\n    });\r\n  }\r\n\r\n  // acknowledgeAlarm() {\r\n  //   let dialog = $('#acknowledgeDialog');\r\n  //   if (dialog.data('kendoDialog')) {\r\n  //     dialog.data('kendoDialog').open();\r\n  //   } else {\r\n  //     dialog.kendoDialog({\r\n  //       width: '400px',\r\n  //       title: 'Acknowledge Alarm',\r\n  //       closable: true,\r\n  //       modal: false,\r\n  //       content: `\r\n  //           <p>Are you sure you want to acknowledge this alarm?</p>\r\n  //           `,\r\n  //       actions: [{ text: 'Acknowledge', primary: true }, { text: 'Cancel' }],\r\n  //       close: onClose\r\n  //     });\r\n  //   }\r\n  //   function onClose() {\r\n  //     // undo.fadeIn();\r\n  //   }\r\n  // }\r\n\r\n  commands = {\r\n    remoteStartStop: {\r\n      status: 'ON',\r\n      timestamp: '6/5/2017 04:31:33 am'\r\n    },\r\n    ping: {\r\n      timestamp: '1/4/2017 04:31:33 am'\r\n    }\r\n  };\r\n\r\n  remotePingCommand() {\r\n    this.commands.ping.timestamp = moment(Date()).format('DD/M/YYYY h:mm:ss a');\r\n  }\r\n\r\n  setCommandStatuses() {\r\n    if (this.commands.remoteStartStop.status === 'ON') {\r\n      $(this.remoteStart).addClass('disabled');\r\n    } else {\r\n      $(this.remoteStop).addClass('disabled');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remote Stop Command\r\n   */\r\n  sendRemoteCommand(cmd) {\r\n    let me = this;\r\n    if (me.model) {\r\n      this.http.client.post('/asset/command', {\r\n        imei: me.model.sensor,\r\n        command: cmd,\r\n        interfaceType: me.model.interfaceType\r\n      }).then((res) => {\r\n        if (res) {\r\n          console.log(res);\r\n          Materialize.toast(res.message, 5000);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Http)\r\nexport class Commands {\r\n  imeis = [];\r\n  interfaceMap = [];\r\n\r\n  //btn flags\r\n  btnText = 'Send Command';\r\n  btnDisable = false;\r\n\r\n  rawCommand;\r\n  constructor(http) {\r\n    this.http = http;\r\n  }\r\n\r\n  attached() {\r\n    let me = this;\r\n    App.currentView = this;\r\n\r\n    //initialize multiselect for assets\r\n    $('#command-multiselect').kendoMultiSelect({\r\n      autoBind: true,\r\n      dataTextField: 'name',\r\n      dataValueField: 'name',\r\n      filter: 'contains',\r\n      suggest: true,\r\n      index: 3,\r\n      select: function(data) {\r\n        me.imeis.push(data.dataItem.sensor);\r\n        me.interfaceMap.push(data.dataItem.interfaceType);\r\n      },\r\n      deselect: function(data) {\r\n        console.log('deselect');\r\n        let index = me.imeis.indexOf(data.dataItem.sensor);\r\n        if (index > -1) {\r\n          me.imeis.splice(index, 1);\r\n          me.interfaceMap.splice(index, 1);\r\n        }\r\n      },\r\n      dataSource: {\r\n        type: 'odata',\r\n        serverFiltering: false,\r\n        transport: {\r\n          read: {\r\n            url: App.config.apiUrl + '/asset',\r\n            type: 'GET',\r\n            contentType: 'application/json',\r\n            accept: 'application/json, text/plain, */*',\r\n            dataType: 'json',\r\n            xhrFields: { withCredentials: true }\r\n          }\r\n        },\r\n        schema: {\r\n          data: 'data.docs',\r\n          total: 'data.total',\r\n          model: {\r\n            fields: {\r\n              eventTime: { type: 'date' },\r\n              createdTime: { type: 'date' },\r\n              updated_at: { type: 'date' },\r\n              created_at: { type: 'date' }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  //send commands to selected list of assets\r\n  sendCommand() {\r\n    this.btnText = 'Sending';\r\n    this.btnDisable = true;\r\n\r\n    this.http.client.post('/asset/rawcommand', {\r\n      imeis: this.imeis,\r\n      interfaceMap: this.interfaceMap,\r\n      command: this.rawCommand\r\n    }).then((res) => {\r\n      this.btnText = 'Send Command';\r\n      this.btnDisable = false;\r\n      if (res && res.message) {\r\n        Materialize.toast(res.message, 3000);\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { Chart } from 'chart.js';\r\n\r\nimport { Router } from 'aurelia-router';\r\n\r\n@inject(Http, Router)\r\nexport class AssetList {\r\n  http;\r\n  user;\r\n\r\n  //project object\r\n  project = {};\r\n\r\n  //widgets\r\n  grid;\r\n  tagger;\r\n  cards = {};\r\n\r\n  constructor(http, router) {\r\n    this.http = http;\r\n    this.router = router;\r\n    this.user = App.currentUser;\r\n  }\r\n\r\n  /**\r\n   * Run once DOM is attached\r\n   */\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('list-tags', {\r\n      allowDuplicates: false,\r\n      //on addition of tags\r\n      onTagAdd: function(event, tag) {\r\n        if (me.tagger) {\r\n          me.renderGrid(me.tagger.getTags().values);\r\n        }\r\n      },\r\n      //on removal of tag\r\n      onTagRemove: function(event, tag) {\r\n        me.renderGrid(me.tagger.getTags().values);\r\n      }\r\n    });\r\n\r\n    //check if it's a project view\r\n    if (\r\n      this.router.currentInstruction.params &&\r\n      this.router.currentInstruction.params.id\r\n    ) {\r\n      let id = this.router.currentInstruction.params.id;\r\n      this.getProject(id, () => {\r\n        this.loading = false;\r\n        this.deferred();\r\n      });\r\n    } else {\r\n      this.deferred();\r\n    }\r\n  }\r\n\r\n  deferred() {\r\n    let me = this;\r\n    //render all assets grid\r\n    me.renderGrid();\r\n\r\n    //render engine rating pie\r\n    me.renderEngineRatingChart();\r\n\r\n    //render genset capacity graph\r\n    me.renderCapacityChart();\r\n  }\r\n\r\n  /**\r\n     * Get the asset model\r\n     * @param {*} id Asset _id\r\n     */\r\n  getProject(id, callback) {\r\n    this.http.client.get(`/project/id/${id}`).then(res => {\r\n      if (res && res.data) {\r\n        this.project = res.data[0];\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render grid listing all assets\r\n   * @param {*} tags\r\n   */\r\n  renderGrid(tags) {\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        detailTemplate: kendo.template($('#template').html()),\r\n        columns: [\r\n          {\r\n            template: \"<a href='\\\\#asset-details/#:_id#'>#:name#</a>\",\r\n            field: 'name',\r\n            title: 'Asset Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'model',\r\n            title: 'Model Name',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'manufacturer',\r\n            title: 'Manufacturer',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'controlPanelManufacturer',\r\n            title: 'Control Panel Manufacturer',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'updated_at',\r\n            title: 'Modified Time',\r\n            template: '#: App.util.format.dateTime(data.updated_at, App.currentUser.dateTimeFormat) #',\r\n            filterable: {\r\n              extra: 'true',\r\n              messages: {\r\n                info: 'Show items between dates:'\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //check for asset admin access(1)\r\n    if (App.currentUser.privileges.indexOf(1) > -1) {\r\n      config.toolbar.push({\r\n        template: '<a class=\"k-button\" href=\"\\\\#/asset-admin\"><span class=\"k-icon k-i-plus-outline\"></span> Create New</a>'\r\n      });\r\n    }\r\n\r\n    //set the data types\r\n    // config.dataSource.schema.model.fields = {\r\n    //   name: { type: 'string' },\r\n\r\n    // };\r\n\r\n    //extend to include tags\r\n    if (tags) {\r\n      config.dataSource.filter = { field: 'tags', operator: 'eq', value: tags };\r\n    }\r\n\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/asset';\r\n    //get project filter\r\n    if (this.project._id && this.project.assets) {\r\n      config.dataSource.filter = $.extend(config.dataSource.filter, {\r\n        field: 'ids',\r\n        operator: 'eq',\r\n        value: this.project.assets.join(',')\r\n      });\r\n    }\r\n\r\n    this.grid = $('#assetGrid').kendoGrid(config);\r\n  }\r\n  /**\r\n   * Render Engine Rating Pie Chart\r\n   */\r\n  renderEngineRatingChart() {\r\n    let me = this;\r\n    let url = this.project._id\r\n      ? `/statistics/generatorenginerating/${this.project._id}`\r\n      : '/statistics/generatorenginerating/';\r\n    //add mask\r\n    this.loadingEngineRatingChart = true;\r\n    this.http.client.get(url).then(res => {\r\n      me.noEngineRatingChart = false;\r\n      //remove mask\r\n      me.loadingEngineRatingChart = false;\r\n      if (res && res.data.length && res.data[0].generatorEngineRating) {\r\n        let engineRating = res.data[0].generatorEngineRating;\r\n        me.cards.engineRatingChart = new Chart(me.engineRatingChart, {\r\n          type: 'pie',\r\n          data: {\r\n            labels: ['Prime', 'Continous', 'Stand-by'],\r\n            datasets: [\r\n              {\r\n                data: [\r\n                  engineRating.prime,\r\n                  engineRating.continuous,\r\n                  engineRating.standby\r\n                ],\r\n                backgroundColor: ['#00838f', '#00acc1', '#b2ebf2', '#e0f7fa'],\r\n                hoverBackgroundColor: ['#00838f', '#00acc1', '#b2ebf2', '#e0f7fa']\r\n              }\r\n            ]\r\n          }\r\n        });\r\n      } else {\r\n        //hide element\r\n        me.noEngineRatingChart = true;\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * Render Capcity Bar Chart\r\n   */\r\n  renderCapacityChart() {\r\n    let me = this;\r\n    let url = this.project._id\r\n      ? `/statistics/generatorcapacity/${this.project._id}`\r\n      : '/statistics/generatorcapacity/';\r\n    //add mask\r\n    this.loadingCapacityChart = true;\r\n    this.http.client.get(url).then(res => {\r\n      //remove mask\r\n      me.loadingCapacityChart = false;\r\n      if (res && res.data.length && res.data[0].generatorCapacity) {\r\n        me.noCapacityChart = false;\r\n        let data = [];\r\n        let categories = [];\r\n        let generatorCapacity = res.data[0].generatorCapacity;\r\n        for (let rating in generatorCapacity) {\r\n          data.push(generatorCapacity[rating]);\r\n          categories.push(rating);\r\n        }\r\n        //render chart\r\n        $(this.capacityChart).kendoChart({\r\n          title: {\r\n            text: 'Genset Capacity Statistics'\r\n          },\r\n          theme: 'material',\r\n          legend: {\r\n            position: 'top'\r\n          },\r\n          seriesDefaults: {\r\n            type: 'column'\r\n          },\r\n          seriesColors: ['#00838f', '#0097a7', '#00acc1', '#00bcd4', '#26c6da', '#4dd0e1', '#80deea', '#b2ebf2', '#e0f7fa'],\r\n          series: [\r\n            {\r\n              name: 'Generators',\r\n              data: data\r\n            }\r\n          ],\r\n          valueAxis: {\r\n            labels: {\r\n              format: '{0}'\r\n            },\r\n            line: {\r\n              visible: true\r\n            },\r\n            axisCrossingValue: 0\r\n          },\r\n          categoryAxis: {\r\n            categories: categories,\r\n            line: {\r\n              visible: false\r\n            }\r\n\r\n            // labels: {\r\n\r\n            //     padding: { top: 135 }\r\n\r\n            // }\r\n          },\r\n          tooltip: {\r\n            visible: true,\r\n            format: '{0} kVA',\r\n            template: '#= series.name #: #= value #'\r\n          }\r\n        });\r\n      } else {\r\n        //hide element\r\n        me.noCapacityChart = true;\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class Geofences {\r\n  constructor(http, httpClient) {\r\n    this.http = http;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  attached() {\r\n    App.currentView = this;\r\n\r\n    //render all active alarms grid\r\n    this.renderGeofences();\r\n  }\r\n\r\n  /**\r\n     * Render Active Alarms List\r\n     */\r\n  renderGeofences() {\r\n    let me = this;\r\n\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            field: 'name',\r\n            title: 'Geofence'\r\n          },\r\n          {\r\n            field: 'type',\r\n            title: 'Geofence Type'\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //don't auto adjust\r\n    config.dataBound = function() {\r\n      //do nothing\r\n    };\r\n\r\n    // check if geofence admins is active for the user\r\n    if (App.currentUser.privileges.indexOf(4) > -1) {\r\n      config.columns.push(\r\n        {\r\n          command: { text: 'Delete', click: me.deleteGeofence },\r\n          title: 'Command',\r\n          width: '100px'\r\n        }\r\n      );\r\n    }\r\n\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/geofence';\r\n\r\n    this.grid = $('#geofences').kendoGrid(config);\r\n  }\r\n\r\n  /**\r\n     * Acknowledge alarm\r\n     * @param {*} e an click event on the grid\r\n     */\r\n  deleteGeofence(e) {\r\n    e.preventDefault();\r\n\r\n    let dataItem = this.dataItem($(e.currentTarget).closest('tr'));\r\n\r\n    kendo.confirm('Are you sure you want to delete?').then(\r\n      function(data) {\r\n        $.ajax({\r\n          method: 'DELETE',\r\n          url: App.config.apiUrl + '/geofence/',\r\n          data: { _id: dataItem._id },\r\n          success: function(res) {\r\n            kendo.alert('Deletion sucessful');\r\n            //re-render the active alarms grid\r\n            App.currentView.renderGeofences();\r\n          },\r\n          error: function(err) {\r\n            me.renderGeofences();\r\n          }\r\n        });\r\n      },\r\n      function() {\r\n        kendo.alert('Deletion cancelled');\r\n      }\r\n    );\r\n  }\r\n\r\n  /**\r\n * Mass upload locations\r\n */\r\n  massUpload(files) {\r\n    console.log('upload file');\r\n    if (files && files[0]) {\r\n      let file = files[0];\r\n      let filename;\r\n\r\n      //set the file name\r\n      if (file.name.match('.csv')) {\r\n        filename = App.currentUser._id + '_' + Date.now() + '.csv';\r\n      } else if (file.name.match('.json')) {\r\n        filename = App.currentUser._id + '_' + Date.now() + '.json';\r\n      } else {\r\n        Materialize.toast('Please upload a .csv or .json file', 3000);\r\n      }\r\n      if (filename) {\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('files', file, filename);\r\n        //use FETCH API to POST file\r\n\r\n        this.fetchAPI\r\n          .fetch(App.config.apiUrl + '/geofence/upload', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            if (data) {\r\n              Materialize.toast('File uploaded successfully', 3000);\r\n            }\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload a file.', 2000);\r\n    }\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class Alarms {\r\n  constructor(http, httpClient) {\r\n    this.http = http;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  attached() {\r\n    App.currentView = this;\r\n\r\n    //render all active alarms grid\r\n    this.renderLocations();\r\n  }\r\n\r\n  /**\r\n     * Render Active Alarms List\r\n     */\r\n  renderLocations() {\r\n    let me = this;\r\n\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            field: 'name',\r\n            title: 'POI'\r\n          },\r\n          {\r\n            field: 'type',\r\n            title: 'POI Type'\r\n          },\r\n          {\r\n            field: 'latitude',\r\n            title: 'Latitude'\r\n          },\r\n          {\r\n            field: 'longitude',\r\n            title: 'Longitude'\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //don't auto adjust\r\n    config.dataBound = function() {\r\n      //do nothing\r\n    };\r\n\r\n    // check if geofence admins is active for the user\r\n    if (App.currentUser.privileges.indexOf(3) > -1) {\r\n      config.columns.push(\r\n        {\r\n          command: { text: 'Delete', click: me.deleteLocation },\r\n          title: 'Command',\r\n          width: '100px'\r\n        }\r\n      );\r\n    }\r\n\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/location';\r\n\r\n    this.grid = $('#locations').kendoGrid(config);\r\n  }\r\n\r\n  /**\r\n     * Acknowledge alarm\r\n     * @param {*} e an click event on the grid\r\n     */\r\n  deleteLocation(e) {\r\n    // e.preventDefault();\r\n\r\n    let dataItem = this.dataItem($(e.currentTarget).closest('tr'));\r\n\r\n    kendo.confirm('Are you sure you want to delete?').then(\r\n      function(data) {\r\n        let me = this;\r\n        $.ajax({\r\n          method: 'DELETE',\r\n          url: App.config.apiUrl + '/location/',\r\n          data: { _id: dataItem._id },\r\n          success: function(res) {\r\n            kendo.alert('Deletion sucessful');\r\n            //re-render the active alarms grid\r\n            App.currentView.renderLocations();\r\n          },\r\n          error: function(err) {\r\n            me.renderLocations();\r\n            me.close();\r\n          }\r\n        });\r\n      },\r\n      function() {\r\n        kendo.alert('Deletion cancelled');\r\n        me.close();\r\n      }\r\n    );\r\n  }\r\n  /**\r\n   * Mass upload locations\r\n   */\r\n  massUpload(files) {\r\n    console.log('upload file');\r\n    if (files && files[0]) {\r\n      let file = files[0];\r\n      let filename;\r\n\r\n      //set the file name\r\n      if (file.name.match('.csv')) {\r\n        filename = App.currentUser._id + '_' + Date.now() + '.csv';\r\n      } else if (file.name.match('.json')) {\r\n        filename = App.currentUser._id + '_' + Date.now() + '.json';\r\n      } else {\r\n        Materialize.toast('Please upload a .csv or .json file', 3000);\r\n      }\r\n      if (filename) {\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('files', file, filename);\r\n        //use FETCH API to POST file\r\n\r\n        this.fetchAPI\r\n          .fetch(App.config.apiUrl + '/location/upload', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            if (data) {\r\n              Materialize.toast('File uploaded successfully', 3000);\r\n            }\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload a file.', 2000);\r\n    }\r\n  }\r\n}\r\n","export class ForgotPassword{\r\n    \r\n}","export class Login {\r\n\r\n    configureRouter(config, router) {\r\n        config.map([\r\n            {\r\n                route: '', name: 'user-password',\r\n                moduleId: './user-password',\r\n                title: 'Sign In'\r\n            },\r\n            {\r\n                route: 'forgot-password',\r\n                name: 'forgot-password',\r\n                moduleId: './forgot-password',\r\n                title: 'Forgot Password?'\r\n            }\r\n        ]);\r\n        config.mapUnknownRoutes(instruction => {\r\n            //check instruction.fragment\r\n            return './user-password';\r\n        });\r\n\r\n        this.router = router;\r\n    }\r\n\r\n    attached() {\r\n        particlesJS('particles-js',\r\n\r\n            {\r\n                \"particles\": {\r\n                    \"number\": {\r\n                        \"value\": 80,\r\n                        \"density\": {\r\n                            \"enable\": true,\r\n                            \"value_area\": 800\r\n                        }\r\n                    },\r\n                    \"color\": {\r\n                        \"value\": \"#ffffff\"\r\n                    },\r\n                    \"shape\": {\r\n                        \"type\": \"circle\",\r\n                        \"stroke\": {\r\n                            \"width\": 0,\r\n                            \"color\": \"#000000\"\r\n                        },\r\n                        \"polygon\": {\r\n                            \"nb_sides\": 5\r\n                        },\r\n                        \"image\": {\r\n                            \"src\": \"img/github.svg\",\r\n                            \"width\": 100,\r\n                            \"height\": 100\r\n                        }\r\n                    },\r\n                    \"opacity\": {\r\n                        \"value\": 0.5,\r\n                        \"random\": false,\r\n                        \"anim\": {\r\n                            \"enable\": false,\r\n                            \"speed\": 1,\r\n                            \"opacity_min\": 0.1,\r\n                            \"sync\": false\r\n                        }\r\n                    },\r\n                    \"size\": {\r\n                        \"value\": 5,\r\n                        \"random\": true,\r\n                        \"anim\": {\r\n                            \"enable\": false,\r\n                            \"speed\": 40,\r\n                            \"size_min\": 0.1,\r\n                            \"sync\": false\r\n                        }\r\n                    },\r\n                    \"line_linked\": {\r\n                        \"enable\": true,\r\n                        \"distance\": 150,\r\n                        \"color\": \"#ffffff\",\r\n                        \"opacity\": 0.4,\r\n                        \"width\": 1\r\n                    },\r\n                    \"move\": {\r\n                        \"enable\": true,\r\n                        \"speed\": 6,\r\n                        \"direction\": \"none\",\r\n                        \"random\": false,\r\n                        \"straight\": false,\r\n                        \"out_mode\": \"out\",\r\n                        \"attract\": {\r\n                            \"enable\": false,\r\n                            \"rotateX\": 600,\r\n                            \"rotateY\": 1200\r\n                        }\r\n                    }\r\n                },\r\n                \"interactivity\": {\r\n                    \"detect_on\": \"canvas\",\r\n                    \"events\": {\r\n                        \"onhover\": {\r\n                            \"enable\": true,\r\n                            \"mode\": \"repulse\"\r\n                        },\r\n                        \"onclick\": {\r\n                            \"enable\": true,\r\n                            \"mode\": \"push\"\r\n                        },\r\n                        \"resize\": true\r\n                    },\r\n                    \"modes\": {\r\n                        \"grab\": {\r\n                            \"distance\": 400,\r\n                            \"line_linked\": {\r\n                                \"opacity\": 1\r\n                            }\r\n                        },\r\n                        \"bubble\": {\r\n                            \"distance\": 400,\r\n                            \"size\": 40,\r\n                            \"duration\": 2,\r\n                            \"opacity\": 8,\r\n                            \"speed\": 3\r\n                        },\r\n                        \"repulse\": {\r\n                            \"distance\": 200\r\n                        },\r\n                        \"push\": {\r\n                            \"particles_nb\": 4\r\n                        },\r\n                        \"remove\": {\r\n                            \"particles_nb\": 2\r\n                        }\r\n                    }\r\n                },\r\n                \"retina_detect\": true,\r\n                \"config_demo\": {\r\n                    \"hide_card\": false,\r\n                    \"background_color\": \"#0000\",\r\n                    \"background_image\": \"\",\r\n                    \"background_position\": \"50% 50%\",\r\n                    \"background_repeat\": \"no-repeat\",\r\n                    \"background_size\": \"cover\"\r\n                }\r\n            }\r\n\r\n        );\r\n    }\r\n\r\n}","import { Aurelia, inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Aurelia, Http)\r\nexport class UserPassword {\r\n  loading = false;\r\n  loginBtnText = 'Login';\r\n\r\n  model = {\r\n    loginName: '',\r\n    password: ''\r\n  }\r\n\r\n  constructor(aurelia, http) {\r\n    this.aurelia = aurelia;\r\n    this.client = http.client;\r\n  }\r\n\r\n  login() {\r\n    let me = this;\r\n    this.loading = true;\r\n    this.loginBtnText = 'Logging in...';\r\n\r\n    //login user\r\n    this.client.post('/user/logon', this.model)\r\n      .then(res => {\r\n        me.loading = false;\r\n        if (res) {\r\n          localStorage.setItem('currentUser', JSON.stringify(res.data));\r\n          this.aurelia.setRoot('app');\r\n        }\r\n      });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Http)\r\nexport class Map {\r\n  loading = true;\r\n  locationCreation = false;\r\n  //bounds\r\n  latlngBounds;\r\n  //persisting the map refresher\r\n  refresher;\r\n  //map controls object\r\n  mapControl = {\r\n    refreshInterval: 20000,\r\n    autoRefresh: true,\r\n    autoPan: true,\r\n    autoZoom: false,\r\n    autoCluster: true\r\n  };\r\n  //model for marker binding\r\n  markers = [];\r\n  //clusterer\r\n  markerCluster;\r\n  //dropped pin\r\n  dropMarker = null;\r\n  //current InfoWindow\r\n  currentInfoWindow;\r\n  //markerSelect\r\n  markerSelect;\r\n  //marker selection array\r\n  markerSelected = [];\r\n\r\n  //locations\r\n  locationMarkers = [];\r\n\r\n  //geofences\r\n  geofenceMarkers = [];\r\n\r\n  //new Location\r\n  newLocation = {};\r\n\r\n  constructor(http) {\r\n    this.client = http.client;\r\n  }\r\n\r\n  /**\r\n     * Component attached to DOM\r\n     */\r\n  attached() {\r\n    App.currentView = this;\r\n    let me = this;\r\n\r\n    this.loading = false;\r\n    $('ul.tabs').tabs();\r\n\r\n\r\n    //collapsible\r\n    $('.collapsible').collapsible();\r\n\r\n    //location types\r\n    $(this.locationTypes).kendoDropDownList({\r\n      dataSource: App.config.locationTypes,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.newLocation.type = this.value();\r\n      }\r\n    });\r\n\r\n    //geofence types\r\n    $(this.geofenceTypes).kendoDropDownList({\r\n      dataSource: App.config.geofenceTypes,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.newGeofence.type = this.value();\r\n      }\r\n    });\r\n\r\n\r\n    //asset list multiselect\r\n    $(this.geofenceLocation).kendoMultiSelect({\r\n      placeholder: 'Search...',\r\n      dataTextField: 'name',\r\n      dataValueField: '_id',\r\n      maxSelectedItems: 1,\r\n      ignoreCase: false,\r\n      filter: 'contains',\r\n      // minLength: 3,\r\n      dataSource: {\r\n        type: 'odata',\r\n        serverFiltering: true,\r\n        transport: {\r\n          read: {\r\n            type: 'GET',\r\n            contentType: 'application/json',\r\n            accept: 'application/json, text/plain, */*',\r\n            dataType: 'json',\r\n            xhrFields: { withCredentials: true },\r\n            url: App.config.apiUrl + '/misc/find/location'\r\n          }\r\n        }\r\n      },\r\n      select: function(e) {\r\n        //navigate to object\r\n        if (e.dataItem._id) {\r\n          me.newGeofence._location = e.dataItem._id;\r\n        }\r\n      },\r\n      deselect: function(e) {\r\n        //navigate to object\r\n        me.newGeofence._location =  null;\r\n      }\r\n\r\n      //  value: []\r\n    });\r\n\r\n    //get asset markers\r\n    this.initMap(() => {\r\n      //stupid hacky workaround :(\r\n      setTimeout(function() {\r\n        google.maps.event.trigger(me.googleMap, 'resize');\r\n      }, 200);\r\n\r\n      //render tabs for asset marker infowindow\r\n      this.renderAssetMarkers(() => {\r\n        $('ul.tabs').tabs();\r\n\r\n        //create marker select box\r\n        this.initMarkerSelect();\r\n\r\n        //load locations tree\r\n        this.renderLocationsTree();\r\n\r\n        //load geofences tree\r\n        this.renderGeofencesTree();\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n     * Initialize Map\r\n     * @param {*} callback\r\n     */\r\n  initMap(callback) {\r\n    console.log('initMap');\r\n    let me = this;\r\n    //create bounds instance\r\n    this.latlngBounds = new google.maps.LatLngBounds();\r\n    //create map instance\r\n    App.googleMap = this.googleMap = new google.maps.Map(document.getElementById('map'), {\r\n      zoom: 4,\r\n      center: { lat: 25, lng: 55 },\r\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n      mapTypeControl: true,\r\n      scrollwheel: true,\r\n      draggable: true,\r\n      mapTypeControlOptions: {\r\n        style: google.maps.MapTypeControlStyle.DROPDOWN_MENU\r\n      },\r\n      navigationControl: false,\r\n      navigationControlOptions: {\r\n        style: google.maps.NavigationControlStyle.SMALL\r\n      }\r\n    });\r\n\r\n     //render legend\r\n    this.renderLegend(this.googleMap);\r\n\r\n    callback();\r\n  }\r\n\r\n   /**\r\n   * Render Map Legend\r\n   */\r\n  renderLegend(map) {\r\n    let legend = this.legend;\r\n    legend.innerHTML = `\r\n        <div class='card map-legend'>\r\n          <h7>Legend</h7>\r\n          <ul>\r\n            <li><img src=\"/images/map/icons/on-sm.png\"> ON</li>\r\n            <li><img src=\"/images/map/icons/off-sm.png\"> OFF</li>\r\n            <li><img src=\"/images/map/icons/alert-sm.png\"> Alarmed</li>\r\n            <li><img src=\"/images/map/icons/maintenance-sm.png\"> Maintenance</li>\r\n            <li><img src=\"/images/map/icons/unknown-sm.png\"> Unknown</li>\r\n            <li><img src=\"/images/map/icons/decommissioned-sm.png\"> Decommissioned</li>\r\n          </ul>\r\n        </div>\r\n        `;\r\n    map.controls[google.maps.ControlPosition.RIGHT_TOP].push(legend);\r\n  }\r\n\r\n  /**\r\n     * Initialize the Marker Select Control\r\n     */\r\n  initMarkerSelect() {\r\n    let dataSource = [];\r\n    for (let i = 0; i < this.markers.length; i++) {\r\n      let marker = this.markers[i];\r\n      dataSource.push({\r\n        id: marker.id\r\n      });\r\n    }\r\n\r\n    this.markerSelect = $('#markerSelect')\r\n      .kendoMultiSelect({\r\n        autoClose: false,\r\n        dataSource: dataSource,\r\n        dataTextField: 'id',\r\n        dataValueField: 'id'\r\n      })\r\n      .data('kendoMultiSelect');\r\n  }\r\n\r\n  /**\r\n     * Rendering Asset Markers on Map\r\n     * @param {*} callback\r\n     */\r\n  renderAssetMarkers(callback) {\r\n    let me = this;\r\n    if (this.markerCluster) {\r\n      this.removeCluster();\r\n      this.markerClusterer.clearMarkers();\r\n    }\r\n    //clean up the markers\r\n    this.removeMarkers();\r\n    this.markers = [];\r\n    //load all assets on map\r\n    this.client.get('/map/assets').then(res => {\r\n      if (res && res.data) {\r\n        console.info('map');\r\n        for (let i = 0; i < res.data.length; i++) {\r\n          let markerInfo = res.data[i];\r\n          let infowindow = new google.maps.InfoWindow({\r\n            content: `\r\n                               <div id=\"tabstrip\">\r\n                            <ul>\r\n                                <li class=\"k-state-active\">\r\n                                    Event Info\r\n                                </li>\r\n                                <li>\r\n                                    Asset Info\r\n                                </li>\r\n                            </ul>\r\n                            <div>\r\n                               <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Name</b></td>\r\n                                              <td><a href='#asset-details/${markerInfo._asset._id}'>${markerInfo._asset.name}</a></td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Status</b></td>\r\n                                            <td>${markerInfo._asset.status || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Event Type</b></td>\r\n                                            <td>${markerInfo.eventType}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Event Time</b></td>\r\n                                            <td>${App.util.format.dateTime(markerInfo.eventTime, App.currentUser.dateTimeFormat)}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Position</b></td>\r\n                                            <td>${markerInfo.latitude}, ${markerInfo.longitude}</td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                            <div>\r\n                                <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Engine Status</b></td>\r\n                                            <td>${markerInfo.engineStatus || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Engine Hour Meter</b></td>\r\n                                            <td>${markerInfo.engineHourMeter || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Supply Voltage</b></td>\r\n                                            <td>${markerInfo.powerSupplyVoltage || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Coolant Temperature</b></td>\r\n                                            <td>${App.util.format.item(markerInfo.engineCoolantTemperature, 'temperature') || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Oil Pressure</b></td>\r\n                                            <td>${App.util.format.item(markerInfo.oilPressure, 'pressure') || '-'}</td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                        </div>\r\n                                    `\r\n          });\r\n\r\n          // asset map icon\r\n          let iconUrl = '/images/map/icons/unknown.png';\r\n          if (\r\n            markerInfo._asset.status && markerInfo._asset.status !== 'Deployed'\r\n          ) {\r\n            switch (markerInfo._asset.status) {\r\n            case 'Maintenance':\r\n              iconUrl = '/images/map/icons/maintenance.png';\r\n              break;\r\n\r\n            case 'Decommissioned':\r\n              iconUrl = '/images/map/icons/decommissioned.png';\r\n              break;\r\n\r\n            default:\r\n                //do nothing\r\n              break;\r\n            }\r\n          } else {\r\n            if (markerInfo._asset && markerInfo._asset.features.engineStatus) {\r\n              switch (markerInfo._asset.features.engineStatus.value) {\r\n              case 'on':\r\n                iconUrl = '/images/map/icons/on.png';\r\n                break;\r\n\r\n              case 'off':\r\n                iconUrl = '/images/map/icons/off.png';\r\n                break;\r\n\r\n              default:\r\n                  //do nothing\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          //create marker object\r\n          let marker = new google.maps.Marker({\r\n            position: {\r\n              lat: parseFloat(markerInfo.latitude),\r\n              lng: parseFloat(markerInfo.longitude)\r\n            },\r\n            title: markerInfo.assetName,\r\n            icon: iconUrl,\r\n            map: me.googleMap,\r\n            id: markerInfo._asset.name\r\n          });\r\n\r\n          //add listener for the map infoWindow click\r\n          marker.addListener('click', function() {\r\n            infowindow.open(me.googleMap, marker);\r\n          });\r\n\r\n          google.maps.event.addListener(infowindow, 'domready', function(e) {\r\n            //intialize tabstrips.\r\n            $('#tabstrip').kendoTabStrip({\r\n              animation: {\r\n                open: {\r\n                  effects: 'fadeIn'\r\n                }\r\n              }\r\n            });\r\n\r\n            // Reference to the DIV which receives the contents of the infowindow using jQuery\r\n            let iwOuter = $('.gm-style-iw');\r\n            let iwBackground = iwOuter.prev();\r\n            // Remove the background shadow DIV\r\n            iwBackground.children(':nth-child(2)').css({ display: 'none' });\r\n            // Remove the white background DIV\r\n            iwBackground.children(':nth-child(4)').css({ display: 'none' });\r\n          });\r\n\r\n          //push the marker to class\r\n          me.markers.push(marker);\r\n\r\n          //extend bounds\r\n          me.latlngBounds.extend({\r\n            lat: parseFloat(markerInfo.latitude),\r\n            lng: parseFloat(markerInfo.longitude)\r\n          });\r\n        }\r\n\r\n        //auto pan if option is selected\r\n        if (me.mapControl.autoPan) {\r\n          me.autoPan();\r\n        }\r\n\r\n        //add clustering\r\n        if (me.mapControl.autoCluster) {\r\n          me.addClusters();\r\n        }\r\n\r\n        //return\r\n        callback && callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Remove Asset Markers\r\n   */\r\n  removeMarkers() {\r\n    let markers = this.markers;\r\n\r\n    for (let i = 0; i < markers.length; i++) {\r\n      markers[i].setMap(null);\r\n    }\r\n  }\r\n\r\n  // A function to create the marker and set up the event window function\r\n  createDropMarker(latlng, name, html) {\r\n    // let infowindow = new google.maps.InfoWindow({\r\n    //   size: new google.maps.Size(150, 50)\r\n    // });\r\n\r\n    // let contentString = html;\r\n    let marker = new google.maps.Marker({\r\n      position: latlng,\r\n      icon: '/images/map/icons/dropmarker.png',\r\n      map: this.googleMap,\r\n      zIndex: Math.round(latlng.lat() * -100000) << 5\r\n    });\r\n\r\n    // google.maps.event.addListener(marker, 'click', function() {\r\n    //   infowindow.setContent(contentString);\r\n    //   infowindow.open(this.googleMap, marker);\r\n    // });\r\n    // google.maps.event.trigger(marker, 'click');\r\n    return marker;\r\n  }\r\n\r\n  /**\r\n   * Start Map Refresher\r\n   */\r\n  startRefresher() {\r\n    console.info('map refresher started');\r\n    this.refresher = setInterval(() => {\r\n      this.getAssetMarkers(null);\r\n    }, this.mapControl.refreshInterval);\r\n  }\r\n\r\n  /**\r\n     * Stop Map Refresher\r\n     */\r\n  stopRefresher() {\r\n    console.info('map refresher stopped');\r\n    clearInterval(this.refresher);\r\n  }\r\n\r\n  /**\r\n      * Toggle Refresher\r\n      * @param e Event Element\r\n      */\r\n  toggleRefresher(e) {\r\n    if (e.srcElement.checked) {\r\n      this.startRefresher();\r\n    } else {\r\n      this.stopRefresher();\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Auto Pan Map to Markers\r\n     */\r\n  autoPan() {\r\n    let len = this.markers.length;\r\n    for (let i = 0; i < len; i++) {\r\n      //extend bounds\r\n      this.markers[i].map && this.latlngBounds.extend(this.markers[i].position);\r\n    }\r\n    //now fit the map to the newly inclusive bounds\r\n    this.googleMap.fitBounds(this.latlngBounds);\r\n  }\r\n\r\n  /**\r\n     * Adding clustering\r\n     */\r\n  addClusters() {\r\n    this.markerClusterer = new MarkerClusterer(this.googleMap, this.markers, {\r\n      imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'\r\n    });\r\n  }\r\n\r\n  /**\r\n     * Remove marker clustering\r\n     */\r\n  removeCluster() {\r\n    this.markerClusterer.clearMarkers();\r\n    this.renderAssetMarkers(() => {});\r\n  }\r\n\r\n  /**\r\n     * Toggle Clusterer\r\n     * @param e Event Element\r\n     */\r\n  toggleClusterer(e) {\r\n    if (e.srcElement.checked) {\r\n      this.addClusters();\r\n    } else {\r\n      this.removeCluster();\r\n    }\r\n  }\r\n\r\n  filterMarkers() {\r\n    this.removeMarkers();\r\n    this.markerClusterer.clearMarkers();\r\n    let selectedValues = this.markerSelect.value();\r\n\r\n    if (selectedValues && selectedValues.length > 0) {\r\n      let selectedLen = selectedValues.length;\r\n      let markersLen = this.markers.length;\r\n\r\n      this.markerSelected = [];\r\n\r\n      for (let i = 0; i < selectedLen; i++) {\r\n        for (let j = 0; j < markersLen; j++) {\r\n          if (selectedValues[i] === this.markers[j].id) {\r\n            this.markerSelected.push(this.markers[j]);\r\n\r\n            //set missing markers back\r\n            if (!this.markers[j].getMap()) {\r\n              this.markers[j].setMap(this.googleMap);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.autoPan();\r\n      this.mapControl.autoRefresh = false;\r\n    } else {\r\n      this.renderAssetMarkers();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Location selection handler (checkbox)\r\n   */\r\n  selectGeofence() {\r\n    let geofencesToShow = [];\r\n    let grid = $('#geofence-tree').data('kendoGrid');\r\n    let ds = grid.dataSource.view();\r\n\r\n    //select locations to display\r\n    for (let i = 0; i < ds.length; i++) {\r\n      for (let j = 0; j < ds[i].items.length; j++) {\r\n        let row = grid.table.find(\"tr[data-uid='\" + ds[i].items[j].uid + \"']\");\r\n        let checkbox = $(row).find('.geofence-node');\r\n        if (checkbox.is(':checked')) {\r\n          geofencesToShow.push(ds[i].items[j]);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (geofencesToShow.length) {\r\n      this.showGeofences(geofencesToShow);\r\n    } else {\r\n      this.removeGeofences();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Show selected locations\r\n   */\r\n  showGeofences(geofences) {\r\n    console.log('geofences: ', geofences);\r\n    let me = this;\r\n\r\n    this.removeGeofences();\r\n\r\n      //loop and show all selected geofences\r\n    for (let i = 0; i < geofences.length; i++) {\r\n      this.renderGeofence(geofences[i]);\r\n    }\r\n\r\n\r\n    //loop and show all selected locations\r\n    // for (let i = 0; i < locations.length; i++) {\r\n    //   let markerInfo = locations[i];\r\n    //   //create marker object\r\n    //   let marker = new google.maps.Marker({\r\n    //     position: {\r\n    //       lat: parseFloat(markerInfo.latitude),\r\n    //       lng: parseFloat(markerInfo.longitude)\r\n    //     },\r\n    //     title: markerInfo.name,\r\n    //     icon: `/images/map/locations/${markerInfo.type}.png`,\r\n    //     map: me.googleMap,\r\n    //     id: markerInfo._id\r\n    //   });\r\n\r\n    //   let infowindow = new google.maps.InfoWindow({\r\n    //     content: `\r\n    //                            <div id=\"tabstrip\">\r\n    //                         <ul>\r\n    //                             <li class=\"k-state-active\">\r\n    //                                 Location Info\r\n    //                             </li>\r\n    //                         </ul>\r\n    //                         <div>\r\n    //                            <table>\r\n    //                                     <tbody>\r\n    //                                         <tr>\r\n    //                                         <td><b>Name</b></td>\r\n    //                                         <td>${markerInfo.name}${i}</td>\r\n    //                                         </tr>\r\n    //                                         <tr>\r\n    //                                         <td><b>Event Type</b></td>\r\n    //                                         <td>${markerInfo.type}</td>\r\n    //                                         </tr>\r\n    //                                         <tr>\r\n    //                                         <td><b>Position</b></td>\r\n    //                                         <td>${markerInfo.latitude}, ${markerInfo.longitude}</td>\r\n    //                                         </tr>>\r\n    //                                     </tbody>\r\n    //                                 </table>\r\n    //                         </div>\r\n    //                     </div>\r\n    //                                 `\r\n    //   });\r\n\r\n    //   //add listener for the map infoWindow click\r\n    //   marker.addListener('click', function() {\r\n    //     infowindow.open(me.googleMap, marker);\r\n    //   });\r\n\r\n    //   //intialize tabs\r\n    //   google.maps.event.addListener(infowindow, 'domready', function(e) {\r\n    //     //intialize tabstrips.\r\n    //     $('#tabstrip').kendoTabStrip({\r\n    //       animation: {\r\n    //         open: {\r\n    //           effects: 'fadeIn'\r\n    //         }\r\n    //       }\r\n    //     });\r\n    //   });\r\n\r\n    //   //extend bounds\r\n      // me.latlngBounds.extend({\r\n      //   lat: parseFloat(markerInfo.latitude),\r\n      //   lng: parseFloat(markerInfo.longitude)\r\n      // });\r\n    // }\r\n\r\n    //auto pan if option is selected\r\n    if (me.mapControl.autoPan) {\r\n      me.autoPan();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render Geofence\r\n   * @param {*} geofence a geofence object\r\n   */\r\n  renderGeofence(geofence) {\r\n    let me = this;\r\n    let geofenceMarker;\r\n\r\n    //set the color\r\n    let strokeColor = '#FF0000';\r\n    let fillColor = '#FF0000';\r\n\r\n    if (geofence.type === 'inclusive') {\r\n      strokeColor = '#78F576';\r\n      fillColor = '#78F576';\r\n    }\r\n\r\n    //render the shape\r\n    switch (geofence.geoShape.type) {\r\n    case 'circle':\r\n      geofenceMarker = new google.maps.Circle({\r\n        strokeColor: strokeColor,\r\n        strokeOpacity: 0.8,\r\n        strokeWeight: 2,\r\n        fillColor: fillColor,\r\n        fillOpacity: 0.35,\r\n        map: me.googleMap,\r\n        center: geofence.geoShape.center,\r\n        radius: geofence.geoShape.radius\r\n      });\r\n      break;\r\n    case 'polygon':\r\n      geofenceMarker = new google.maps.Polygon({\r\n        strokeColor: strokeColor,\r\n        strokeOpacity: 0.8,\r\n        strokeWeight: 2,\r\n        fillColor: fillColor,\r\n        fillOpacity: 0.35,\r\n        map: me.googleMap,\r\n        paths: geofence.geoShape.path.toJSON()\r\n      });\r\n      break;\r\n    case 'rectangle':\r\n      geofenceMarker = new google.maps.Polygon({\r\n        strokeColor: strokeColor,\r\n        strokeOpacity: 0.8,\r\n        strokeWeight: 2,\r\n        fillColor: fillColor,\r\n        fillOpacity: 0.35,\r\n        map: me.googleMap,\r\n        bounds: geofence.geoShape.bounds\r\n      });\r\n      break;\r\n    default:\r\n      break;\r\n    }\r\n    this.geofenceMarkers.push(geofenceMarker);\r\n  }\r\n\r\n  /**\r\n   * Hide all locations\r\n   */\r\n  removeGeofences() {\r\n    let geofences = this.geofenceMarkers;\r\n\r\n    for (let i = 0; i < geofences.length; i++) {\r\n      geofences[i].setMap(null);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Rendering locations aka POI\r\n   */\r\n  renderLocationsTree() {\r\n    //GET all locations\r\n\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            field: 'name',\r\n            title: 'Location',\r\n            template: '<img src=\"/images/map/locations/#= type #.png\" width=\"16\" height=\"16\"> #= name #'\r\n          },\r\n          {\r\n            template: '<p> <input type=\"checkbox\"  class=\"filled-in location-node\" id=\"#:_id#\" /><label for=\"#:_id#\"></label></p>'\r\n          },\r\n          {\r\n            field: 'type',\r\n            title: 'Type',\r\n            groupHeaderTemplate: '#= value # (#= count#)',\r\n            hidden: true\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //remove the necessary bit\r\n    config.toolbar = null;\r\n    config.sortable = false;\r\n    config.scrollable = false;\r\n    config.pageable = false;\r\n    config.groupable = false;\r\n\r\n    config.height = 'auto';\r\n\r\n    //try and load all locations\r\n    config.dataSource.pageSize = 1000;\r\n\r\n    //grouping and aggregation\r\n    config.dataSource.group = {\r\n      field: 'type',\r\n      dir: 'asc',\r\n      aggregates: [{ field: 'type', aggregate: 'count' }]\r\n    };\r\n\r\n    //set the access url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/location';\r\n\r\n    //render the grid\r\n    this.grid = $('#location-tree').kendoGrid(config);\r\n  }\r\n\r\n  /**\r\n   * Location selection handler (checkbox)\r\n   */\r\n  selectLocation() {\r\n    let locationsToShow = [];\r\n    let grid = $('#location-tree').data('kendoGrid');\r\n    let ds = grid.dataSource.view();\r\n\r\n    //select locations to display\r\n    for (let i = 0; i < ds.length; i++) {\r\n      for (let j = 0; j < ds[i].items.length; j++) {\r\n        let row = grid.table.find(\"tr[data-uid='\" + ds[i].items[j].uid + \"']\");\r\n        let checkbox = $(row).find('.location-node');\r\n        if (checkbox.is(':checked')) {\r\n          locationsToShow.push(ds[i].items[j]);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (locationsToShow.length) {\r\n      this.showLocations(locationsToShow);\r\n    } else {\r\n      this.removeLocations();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Show selected locations\r\n   */\r\n  showLocations(locations) {\r\n    let me = this;\r\n\r\n    this.removeLocations();\r\n\r\n    //loop and show all selected locations\r\n    for (let i = 0; i < locations.length; i++) {\r\n      let markerInfo = locations[i];\r\n      //create marker object\r\n      let marker = new google.maps.Marker({\r\n        position: {\r\n          lat: parseFloat(markerInfo.latitude),\r\n          lng: parseFloat(markerInfo.longitude)\r\n        },\r\n        title: markerInfo.name,\r\n        icon: `/images/map/locations/${markerInfo.type}.png`,\r\n        map: me.googleMap,\r\n        id: markerInfo._id\r\n      });\r\n\r\n      let infowindow = new google.maps.InfoWindow({\r\n        content: `\r\n                               <div id=\"tabstrip\">\r\n                            <ul>\r\n                                <li class=\"k-state-active\">\r\n                                    Location Info\r\n                                </li>\r\n                            </ul>\r\n                            <div>\r\n                               <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Name</b></td>\r\n                                            <td>${markerInfo.name}${i}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Event Type</b></td>\r\n                                            <td>${markerInfo.type}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Position</b></td>\r\n                                            <td>${markerInfo.latitude}, ${markerInfo.longitude}</td>\r\n                                            </tr>>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                        </div>\r\n                                    `\r\n      });\r\n\r\n      //add listener for the map infoWindow click\r\n      marker.addListener('click', function() {\r\n        infowindow.open(me.googleMap, marker);\r\n      });\r\n\r\n      //intialize tabs\r\n      google.maps.event.addListener(infowindow, 'domready', function(e) {\r\n        //intialize tabstrips.\r\n        $('#tabstrip').kendoTabStrip({\r\n          animation: {\r\n            open: {\r\n              effects: 'fadeIn'\r\n            }\r\n          }\r\n        });\r\n      });\r\n\r\n      //push the marker to class\r\n      me.locationMarkers.push(marker);\r\n\r\n      //extend bounds\r\n      me.latlngBounds.extend({\r\n        lat: parseFloat(markerInfo.latitude),\r\n        lng: parseFloat(markerInfo.longitude)\r\n      });\r\n    }\r\n\r\n    //auto pan if option is selected\r\n    if (me.mapControl.autoPan) {\r\n      me.autoPan();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Hide all locations\r\n   */\r\n  removeLocations() {\r\n    let locations = this.locationMarkers;\r\n\r\n    for (let i = 0; i < locations.length; i++) {\r\n      locations[i].setMap(null);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render all locations on the map\r\n   */\r\n  showAllLocations() {\r\n    // this.client.get('/location/?$limit=1000').then(res => {\r\n    //   if (res) {\r\n    //   }\r\n    // });\r\n  }\r\n\r\n  /**\r\n   * Display Location Creation Model\r\n   */\r\n  showLocationCreationModel() {\r\n    let me = this;\r\n    this.locationCreation = true;\r\n\r\n    this.newLocation = {};\r\n\r\n    //set the Google map dom listener\r\n    this.dropMarkerListener = google.maps.event.addListener(\r\n      this.googleMap,\r\n      'click',\r\n      function(event) {\r\n        $('ul.tabs').tabs();\r\n        //call function to create marker\r\n        if (me.dropMarker) {\r\n          me.dropMarker.setMap(null);\r\n          me.dropMarker = null;\r\n        }\r\n        //set the DOM elements\r\n        me.newLocation.latitude = event.latLng.lat().toPrecision(6);\r\n        me.newLocation.longitude = event.latLng.lng().toPrecision(6);\r\n\r\n        //create the pin\r\n        me.dropMarker = me.createDropMarker(\r\n          event.latLng,\r\n          'name',\r\n          `\r\n           <button id=\"primaryTextButton\" class=\"k-primary\">Create a location</button>\r\n        `\r\n        );\r\n      }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Hide Location Creation Model\r\n   */\r\n  hideLocationCreationModel() {\r\n    this.locationCreation = false;\r\n    //remove marker\r\n    this.dropMarker.setMap(null);\r\n    //remove the listener\r\n    google.maps.event.removeListener(this.dropMarkerListener);\r\n  }\r\n\r\n  /**\r\n   * Create a location\r\n   */\r\n  createLocation() {\r\n    let me = this;\r\n    console.log('createLocation');\r\n    if (!this.newLocation.type) {\r\n      this.newLocation.type = App.config.locationTypes[0];\r\n    }\r\n    if (\r\n      this.newLocation.name &&\r\n      this.newLocation.latitude &&\r\n      this.newLocation.longitude\r\n    ) {\r\n      this.client\r\n        .post('/location', {\r\n          name: me.newLocation.name,\r\n          type: me.newLocation.type,\r\n          latitude: me.newLocation.latitude,\r\n          longitude: me.newLocation.longitude\r\n        })\r\n        .then(res => {\r\n          if (res) {\r\n            this.renderLocationsTree();\r\n            this.hideLocationCreationModel();\r\n          }\r\n        });\r\n    } else {\r\n      Materialize.toast('Please fill in all the necessary fields', 3000);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Display Geofence Creation Model\r\n   */\r\n  showGeofenceCreationModel() {\r\n    this.geofenceCreation = true;\r\n    this.newGeofence = {};\r\n\r\n    //show controls\r\n    this.showGeofenceCreationOverlay();\r\n  }\r\n\r\n  /**\r\n   * Hide Geofence Creation Model\r\n   */\r\n  hideGeofenceCreationModel() {\r\n    this.geofenceCreation = false;\r\n    //remove marker\r\n    this.deleteAllShape();\r\n    //hide controls\r\n    this.hideGeofenceCreationOverlay();\r\n  }\r\n\r\n  /**\r\n   * Create a geofence\r\n   */\r\n  createGeofence() {\r\n    let me = this;\r\n\r\n    if (!this.newGeofence.type) {\r\n      this.newGeofence.type = App.config.geofenceTypes[0];\r\n    }\r\n    if (this.newGeofence._location &&\r\n      this.newGeofence.name &&\r\n      this.newGeofence.geoShape\r\n    ) {\r\n      console.log(this.newGeofence);\r\n      this.client\r\n        .post('/geofence', me.newGeofence)\r\n        .then(res => {\r\n          if (res) {\r\n            this.renderGeofencesTree();\r\n            this.hideGeofenceCreationModel();\r\n          }\r\n        });\r\n    } else {\r\n      Materialize.toast('Please fill in all the necessary fields', 3000);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Rendering geofences\r\n   */\r\n  renderGeofencesTree() {\r\n    //GET all geofences\r\n\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            field: 'name',\r\n            title: 'Geofence',\r\n            template: '<img src=\"/images/map/geofences/#= data.type #.png\" width=\"16\" height=\"16\"> #= data.name #'\r\n          },\r\n          {\r\n            template: '<p> <input type=\"checkbox\"  class=\"filled-in geofence-node\" id=\"#:data._id#\" /><label for=\"#:data._id#\"></label></p>'\r\n          },\r\n          {\r\n            field: 'type',\r\n            title: 'Type',\r\n            groupHeaderTemplate: '#= value # (#= count#)',\r\n            hidden: true\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //remove the necessary bit\r\n    config.toolbar = null;\r\n    config.sortable = false;\r\n    config.scrollable = false;\r\n    config.pageable = false;\r\n    config.groupable = false;\r\n\r\n    config.height = 'auto';\r\n\r\n    //try and load all locations\r\n    config.dataSource.pageSize = 1000;\r\n\r\n    //grouping and aggregation\r\n    config.dataSource.group = {\r\n      field: 'type',\r\n      dir: 'asc',\r\n      aggregates: [{ field: 'type', aggregate: 'count' }]\r\n    };\r\n\r\n    //set the access url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/geofence';\r\n\r\n    //render the grid\r\n    this.grid = $('#geofence-tree').kendoGrid(config);\r\n  }\r\n\r\n\r\n  /**\r\n   * Geofence creation overlay\r\n   */\r\n  showGeofenceCreationOverlay() {\r\n    let me = this;\r\n    if (this.drawingManager) {\r\n      //set the drawing control to map\r\n      this.drawingManager.setMap(this.googleMap);\r\n    } else {\r\n      me.all_overlays = [];\r\n      let selectedShape;\r\n      this.drawingManager = new google.maps.drawing.DrawingManager({\r\n      // drawingMode: google.maps.drawing.OverlayType.MARKER,\r\n        drawingControl: true,\r\n        drawingControlOptions: {\r\n          position: google.maps.ControlPosition.TOP_CENTER,\r\n          drawingModes: [\r\n          // google.maps.drawing.OverlayType.MARKER,\r\n            google.maps.drawing.OverlayType.CIRCLE,\r\n            google.maps.drawing.OverlayType.POLYGON,\r\n            google.maps.drawing.OverlayType.RECTANGLE\r\n          ]\r\n        },\r\n        circleOptions: {\r\n          fillColor: '#ffff00',\r\n          fillOpacity: 0.2,\r\n          strokeWeight: 3,\r\n          clickable: false,\r\n          editable: true,\r\n          zIndex: 1\r\n        },\r\n        polygonOptions: {\r\n          clickable: true,\r\n          draggable: true,\r\n          editable: true,\r\n          fillColor: '#ffff00',\r\n          fillOpacity: 1\r\n\r\n        },\r\n        rectangleOptions: {\r\n          clickable: true,\r\n          draggable: true,\r\n          editable: true,\r\n          fillColor: '#ffff00',\r\n          fillOpacity: 0.5\r\n        }\r\n      });\r\n\r\n      function clearSelection() {\r\n        if (selectedShape) {\r\n          selectedShape.setEditable(false);\r\n          selectedShape = null;\r\n        }\r\n      }\r\n\r\n      function setSelection(shape) {\r\n        console.log('setSelection');\r\n        clearSelection();\r\n        selectedShape = shape;\r\n        shape.setEditable(true);\r\n            // google.maps.event.addListener(selectedShape.getPath(), 'insert_at', getPolygonCoords(shape));\r\n            // google.maps.event.addListener(selectedShape.getPath(), 'set_at', getPolygonCoords(shape));\r\n      }\r\n\r\n      function deleteSelectedShape() {\r\n        if (selectedShape) {\r\n          selectedShape.setMap(null);\r\n        }\r\n      }\r\n\r\n\r\n      function CenterControl(controlDiv, map) {\r\n                // Set CSS for the control border.\r\n        let controlUI = document.createElement('div');\r\n        controlUI.style.backgroundColor = '#fff';\r\n        controlUI.style.border = '2px solid #fff';\r\n        controlUI.style.borderRadius = '3px';\r\n        controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';\r\n        controlUI.style.cursor = 'pointer';\r\n        controlUI.style.marginBottom = '22px';\r\n        controlUI.style.textAlign = 'center';\r\n        controlUI.title = 'Select to delete the shape';\r\n        controlDiv.appendChild(controlUI);\r\n\r\n                // Set CSS for the control interior.\r\n        let controlText = document.createElement('div');\r\n        controlText.style.color = 'rgb(25,25,25)';\r\n        controlText.style.fontFamily = 'Roboto,Arial,sans-serif';\r\n        controlText.style.fontSize = '16px';\r\n        controlText.style.lineHeight = '38px';\r\n        controlText.style.paddingLeft = '5px';\r\n        controlText.style.paddingRight = '5px';\r\n        controlText.innerHTML = 'Delete Selected Area';\r\n        controlUI.appendChild(controlText);\r\n\r\n                // Setup the click event listeners: simply set the map to Chicago.\r\n        controlUI.addEventListener('click', function() {\r\n          deleteSelectedShape();\r\n        });\r\n      }\r\n    //set the drawing control to map\r\n      this.drawingManager.setMap(me.googleMap);\r\n\r\n      let getPolygonCoords = function(newShape) {\r\n        console.log('We are one');\r\n        let len = newShape.getPath().getLength();\r\n        for (let i = 0; i < len; i++) {\r\n          console.log(newShape.getPath().getAt(i).toUrlValue(6));\r\n        }\r\n      };\r\n\r\n      google.maps.event.addListener(this.drawingManager, 'polygoncomplete', function(event) {\r\n        event.getPath().getLength();\r\n        if (event.type === 'polygon') {\r\n          me.newGeofence.geoShape = {};\r\n          me.newGeofence.geoShape.type = event.type;\r\n          me.pathToCoords(event.getPath(), (coords)=>{\r\n            me.newGeofence.geoShape.path = coords;\r\n          });\r\n        }\r\n        google.maps.event.addListener(event.getPath(), 'insert_at', function() {\r\n          me.pathToCoords(event.getPath(), (coords)=>{\r\n            me.newGeofence.geoShape.path = coords;\r\n          });\r\n        });\r\n        google.maps.event.addListener(event.getPath(), 'set_at', function() {\r\n          me.pathToCoords(event.getPath(), (coords)=>{\r\n            me.newGeofence.geoShape.path = coords;\r\n          });\r\n        // for (let i = 0; i < len; i++) {\r\n        //   console.log(event.getPath().getAt(i).toUrlValue(5));\r\n        // }\r\n        });\r\n      });\r\n\r\n      google.maps.event.addListener(this.drawingManager, 'overlaycomplete', function(event) {\r\n        me.all_overlays.push(event);\r\n        //circle\r\n        if (event.type === 'circle') {\r\n          me.newGeofence.geoShape = {};\r\n          me.newGeofence.geoShape.type = event.type;\r\n          me.newGeofence.geoShape.center = event.overlay.getCenter();\r\n          me.newGeofence.geoShape.radius = event.overlay.getRadius();\r\n          //rectange\r\n        } else if (event.type === 'rectangle') {\r\n          me.newGeofence.geoShape = {};\r\n          me.newGeofence.geoShape.type = event.type;\r\n          me.newGeofence.geoShape.bounds = event.overlay.getBounds();\r\n        }\r\n        if (event.type !== google.maps.drawing.OverlayType.MARKER) {\r\n          me.drawingManager.setDrawingMode(null);\r\n                    //Write code to select the newly selected object.\r\n\r\n          let newShape = event.overlay;\r\n          newShape.type = event.type;\r\n          google.maps.event.addListener(newShape, 'click', function() {\r\n            setSelection(newShape);\r\n          });\r\n\r\n          setSelection(newShape);\r\n        }\r\n      });\r\n\r\n\r\n      let centerControlDiv = document.createElement('div');\r\n      let centerControl = new CenterControl(centerControlDiv, me.googleMap);\r\n\r\n      centerControlDiv.index = 1;\r\n      me.googleMap.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(centerControlDiv);\r\n    }\r\n  }\r\n\r\n  deleteAllShape() {\r\n    for (let i = 0; i < this.all_overlays.length; i++) {\r\n      this.all_overlays[i].overlay.setMap(null);\r\n    }\r\n    this.all_overlays = [];\r\n  }\r\n\r\n  hideGeofenceCreationOverlay() {\r\n    //set the drawing control to map\r\n    this.drawingManager.setMap(null);\r\n  }\r\n\r\n  /**\r\n   * Convert path object to lat and lng coordinates\r\n   * @param {*} path\r\n   */\r\n  pathToCoords(path, callback) {\r\n    let len = path.length;\r\n    let coords = [];\r\n    for (let i = 0; i < len; i++) {\r\n      coords.push({\r\n        lat: path.getAt(i).lat(),\r\n        lng: path.getAt(i).lng()\r\n      });\r\n    }\r\n\r\n    callback && callback(coords);\r\n  }\r\n\r\n  /**\r\n   * Once dom is deattached\r\n   */\r\n  deattached() {\r\n    console.info('map deattached');\r\n    this.stopRefresher();\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { Chart } from 'chart.js';\r\nimport { AppState } from '../appState';\r\n\r\n@inject(Http, AppState)\r\nexport class Overview {\r\n  //app\r\n  App = App;\r\n  //loader\r\n  loading = true;\r\n  //bounds\r\n  latlngBounds;\r\n  //persisting the map refresher\r\n  refresher;\r\n  //map controls object\r\n  mapControl = {\r\n    refreshInterval: 20000,\r\n    autoRefresh: true,\r\n    autoPan: true,\r\n    autoZoom: false,\r\n    autoCluster: true\r\n  };\r\n  //model for marker binding\r\n  markers = [];\r\n  //clusterer\r\n  markerCluster;\r\n  //dropped pin\r\n  dropMarker = null;\r\n  //current InfoWindow\r\n  currentInfoWindow;\r\n  //markerSelect\r\n  markerSelect;\r\n  //marker selection array\r\n  markerSelected = [];\r\n\r\n  //live operational statistics\r\n  opStatistics = {};\r\n\r\n  cards = {};\r\n\r\n  constructor(http, appState) {\r\n    this.client = http.client;\r\n    this.appState = appState;\r\n  }\r\n\r\n  attached() {\r\n    let me = this;\r\n\r\n    // this.renderPowerOutputBar();\r\n    // this.renderliveOperationalStatisticsPie();\r\n    // this.renderMiniAlarms();\r\n    // this.initMap(() => {\r\n    //   //stupid hacky workaround :(\r\n    //   setTimeout(function() {\r\n    //     google.maps.event.trigger(me.googleMap, 'resize');\r\n    //   }, 500);\r\n    //   this.renderAssetMarkers(() => {\r\n    //     //do something more\r\n    //     this.loadingMap = false;\r\n    //   });\r\n    // });\r\n  }\r\n\r\n  /**\r\n     * Initialize Map\r\n     * @param {*} callback\r\n     */\r\n  initMap(callback) {\r\n    console.log('initMap');\r\n    // let me = this;\r\n    //create bounds instance\r\n    this.latlngBounds = new google.maps.LatLngBounds();\r\n    //create map instance\r\n    this.googleMap = new google.maps.Map(\r\n      document.getElementById('overviewMap'),\r\n      {\r\n        zoom: 10,\r\n        center: { lat: 25, lng: 55 },\r\n        mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n        mapTypeControl: true,\r\n        scrollwheel: false,\r\n        draggable: true,\r\n        styles: [\r\n          {\r\n            featureType: 'landscape.natural',\r\n            elementType: 'geometry.fill',\r\n            stylers: [{ visibility: 'on' }, { color: '#e0efef' }]\r\n          },\r\n          {\r\n            featureType: 'poi',\r\n            elementType: 'geometry.fill',\r\n            stylers: [\r\n              { visibility: 'on' },\r\n              { hue: '#1900ff' },\r\n              { color: '#c0e8e8' }\r\n            ]\r\n          },\r\n          {\r\n            featureType: 'road',\r\n            elementType: 'geometry',\r\n            stylers: [{ lightness: 100 }, { visibility: 'simplified' }]\r\n          },\r\n          {\r\n            featureType: 'road',\r\n            elementType: 'labels',\r\n            stylers: [{ visibility: 'off' }]\r\n          },\r\n          {\r\n            featureType: 'transit.line',\r\n            elementType: 'geometry',\r\n            stylers: [{ visibility: 'on' }, { lightness: 700 }]\r\n          },\r\n          {\r\n            featureType: 'water',\r\n            elementType: 'all',\r\n            stylers: [{ color: '#7dcdcd' }]\r\n          }\r\n        ],\r\n        mapTypeControlOptions: {\r\n          style: google.maps.MapTypeControlStyle.DROPDOWN_MENU\r\n        },\r\n        navigationControl: false,\r\n        navigationControlOptions: {\r\n          style: google.maps.NavigationControlStyle.SMALL\r\n        }\r\n      }\r\n    );\r\n\r\n    //render legend\r\n    this.renderLegend(this.googleMap);\r\n    // google.maps.event.addListener(this.googleMap, 'click', function (event) {\r\n    //     //call function to create marker\r\n    //     if (me.dropMarker) {\r\n    //         me.dropMarker.setMap(null);\r\n    //         me.dropMarker = null;\r\n    //     }\r\n\r\n    //     me.dropMarker = me.createDropMarker(event.latLng, \"name\", \"<b>Positions</b><br>\" + event.latLng);\r\n    // });\r\n\r\n    callback();\r\n  }\r\n\r\n  /**\r\n  * Render Map Legend\r\n  */\r\n  renderLegend(map) {\r\n    let legend = this.legend;\r\n    legend.innerHTML = `\r\n        <div class='card map-legend'>\r\n          <h7>Legend</h7>\r\n          <ul>\r\n            <li><img src=\"/images/map/icons/on-sm.png\"> ON</li>\r\n            <li><img src=\"/images/map/icons/off-sm.png\"> OFF</li>\r\n            <li><img src=\"/images/map/icons/alert-sm.png\"> Alarmed</li>\r\n            <li><img src=\"/images/map/icons/maintenance-sm.png\"> Maintenance</li>\r\n            <li><img src=\"/images/map/icons/unknown-sm.png\"> Unknown</li>\r\n            <li><img src=\"/images/map/icons/decommissioned-sm.png\"> Decommissioned</li>\r\n          </ul>\r\n        </div>\r\n        `;\r\n    map.controls[google.maps.ControlPosition.RIGHT_TOP].push(legend);\r\n  }\r\n\r\n  /**\r\n    * Rendering Asset Markers on Map\r\n    * @param {*} callback\r\n    */\r\n  renderAssetMarkers(callback) {\r\n    let me = this;\r\n    this.loadingMap = true;\r\n    if (this.markerCluster) {\r\n      this.removeCluster();\r\n    }\r\n    //clean up the markers\r\n    this.markers = [];\r\n    //load all assets on map\r\n    this.client.get('/map/assets').then(res => {\r\n      if (res && res.data) {\r\n        console.info('map');\r\n        for (let i = 0; i < res.data.length; i++) {\r\n          let markerInfo = res.data[i];\r\n          let infowindow = new google.maps.InfoWindow({\r\n            content: `\r\n                               <div id=\"tabstrip\">\r\n                            <ul>\r\n                                <li class=\"k-state-active\">\r\n                                    Event Info\r\n                                </li>\r\n                                <li>\r\n                                    Asset Info\r\n                                </li>\r\n                            </ul>\r\n                            <div>\r\n                               <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Name</b></td>\r\n                                            <td><a href='#asset-details/${markerInfo._asset._id}'>${markerInfo._asset.name}</a></td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Status</b></td>\r\n                                            <td>${markerInfo._asset.status || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Event Type</b></td>\r\n                                            <td>${markerInfo.eventType}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Event Time</b></td>\r\n                                            <td>${App.util.format.dateTime(markerInfo.eventTime, App.currentUser.dateTimeFormat)}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Position</b></td>\r\n                                            <td>${markerInfo.latitude}, ${markerInfo.longitude}</td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                            <div>\r\n                                <table>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                            <td><b>Engine Status</b></td>\r\n                                            <td>${markerInfo.engineStatus || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Engine Hour Meter</b></td>\r\n                                            <td>${markerInfo.engineHourMeter || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Supply Voltage</b></td>\r\n                                            <td>${markerInfo.powerSupplyVoltage || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                          <td><b>Coolant Temperature</b></td>\r\n                                            <td>${App.util.format.item(markerInfo.engineCoolantTemperature, 'temperature') || '-'}</td>\r\n                                            </tr>\r\n                                            <tr>\r\n                                            <td><b>Oil Pressure</b></td>\r\n                                            <td>${App.util.format.item(markerInfo.oilPressure, 'pressure') || '-'}</td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                            </div>\r\n                        </div>\r\n                                    `\r\n          });\r\n\r\n          // asset map icon\r\n          let iconUrl = '/images/map/icons/unknown.png';\r\n          if (\r\n            markerInfo._asset.status && markerInfo._asset.status !== 'Deployed'\r\n          ) {\r\n            switch (markerInfo._asset.status) {\r\n            case 'Maintenance':\r\n              iconUrl = '/images/map/icons/maintenance.png';\r\n              break;\r\n\r\n            case 'Decommissioned':\r\n              iconUrl = '/images/map/icons/decommissioned.png';\r\n              break;\r\n\r\n            default:\r\n                //do nothing\r\n              break;\r\n            }\r\n          } else {\r\n            if (markerInfo._asset && markerInfo._asset.features.engineStatus) {\r\n              switch (markerInfo._asset.features.engineStatus.value) {\r\n              case 'on':\r\n                iconUrl = '/images/map/icons/on.png';\r\n                break;\r\n\r\n              case 'off':\r\n                iconUrl = '/images/map/icons/off.png';\r\n                break;\r\n\r\n              default:\r\n                  //do nothing\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          //create marker object\r\n          let marker = new google.maps.Marker({\r\n            position: {\r\n              lat: parseFloat(markerInfo.latitude),\r\n              lng: parseFloat(markerInfo.longitude)\r\n            },\r\n            title: markerInfo.assetName,\r\n            icon: iconUrl,\r\n            map: me.googleMap,\r\n            id: markerInfo.assetName\r\n          });\r\n\r\n          //add listener for the map infoWindow click\r\n          marker.addListener('click', function() {\r\n            infowindow.open(me.googleMap, marker);\r\n          });\r\n\r\n          google.maps.event.addListener(infowindow, 'domready', function(e) {\r\n            //intialize tabstrips.\r\n            $('#tabstrip').kendoTabStrip({\r\n              animation: {\r\n                open: {\r\n                  effects: 'fadeIn'\r\n                }\r\n              }\r\n            });\r\n            // Reference to the DIV which receives the contents of the infowindow using jQuery\r\n            let iwOuter = $('.gm-style-iw');\r\n            let iwBackground = iwOuter.prev();\r\n            // Remove the background shadow DIV\r\n            iwBackground.children(':nth-child(2)').css({ display: 'none' });\r\n            // Remove the white background DIV\r\n            iwBackground.children(':nth-child(4)').css({ display: 'none' });\r\n          });\r\n\r\n          //push the marker to class\r\n          me.markers.push(marker);\r\n\r\n          //extend bounds\r\n          me.latlngBounds.extend({\r\n            lat: parseFloat(markerInfo.latitude),\r\n            lng: parseFloat(markerInfo.longitude)\r\n          });\r\n        }\r\n\r\n        //auto pan if option is selected\r\n        if (me.mapControl.autoPan) {\r\n          me.autoPan();\r\n        }\r\n\r\n        //add clustering\r\n        if (me.mapControl.autoCluster) {\r\n          me.addClusters();\r\n        }\r\n\r\n        //return\r\n        callback && callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Auto Pan Map to Markers\r\n   */\r\n  autoPan() {\r\n    let len = this.markers.length;\r\n    for (let i = 0; i < len; i++) {\r\n      //extend bounds\r\n      this.markers[i].map && this.latlngBounds.extend(this.markers[i].position);\r\n    }\r\n    //now fit the map to the newly inclusive bounds\r\n    this.googleMap.fitBounds(this.latlngBounds);\r\n  }\r\n\r\n  /**\r\n     * Adding clustering\r\n     */\r\n  addClusters() {\r\n    this.markerClusterer = new MarkerClusterer(this.googleMap, this.markers, {\r\n      imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'\r\n    });\r\n  }\r\n\r\n  /**\r\n   *  Render daily power output bar chart\r\n   */\r\n  renderPowerOutputBar() {\r\n    let dataSource = {};\r\n    let categories = [];\r\n    let series = [];\r\n    this.loadingPowerOutputBar = true;\r\n    this.client\r\n      .get('/statistics/projectUtilization/poweroutputkwdaily')\r\n      .then(res => {\r\n        if (res && res.data) {\r\n          for (let i = 0; i < res.data.length; i++) {\r\n            let day = moment(new Date()).format('dddd');\r\n            categories.push(res.data[i]._project.name);\r\n            if (!dataSource[day]) {\r\n              dataSource[day] = [res.data[i].powerOutputKW];\r\n            } else {\r\n              dataSource[day].push(res.data[i].powerOutputKW);\r\n            }\r\n          }\r\n          for (let key in dataSource) {\r\n            series.push({\r\n              name: key,\r\n              data: dataSource[key]\r\n            });\r\n          }\r\n\r\n          //render bar chart\r\n          $('#powerOutputBar').kendoChart({\r\n            title: {\r\n              text: 'Daily Output Generated'\r\n            },\r\n            theme: 'material',\r\n            legend: {\r\n              position: 'top'\r\n            },\r\n            seriesDefaults: {\r\n              type: 'column'\r\n            },\r\n            seriesColors: ['#00838f', '#0097a7', '#00acc1', '#00bcd4', '#26c6da', '#4dd0e1', '#80deea', '#b2ebf2', '#e0f7fa'],\r\n            series: series,\r\n            valueAxis: {\r\n              labels: {\r\n                format: '{0} kVA'\r\n              },\r\n              line: {\r\n                visible: true\r\n              },\r\n              axisCrossingValue: 0\r\n            },\r\n            categoryAxis: {\r\n              categories: categories,\r\n              line: {\r\n                visible: false\r\n              }\r\n            },\r\n            tooltip: {\r\n              visible: true,\r\n              format: '{0} kVA',\r\n              template: '#= series.name #: #= value # kVA'\r\n            }\r\n          });\r\n          this.loadingPowerOutputBar = false;\r\n        }\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Render live operational statistics pie chart\r\n   */\r\n  renderliveOperationalStatisticsPie() {\r\n    let me = this;\r\n    this.loadingliveOperationalStatistics = true;\r\n    this.loadingliveOperationalStatisticsPie = true;\r\n    this.client.get('/statistics/liveoperationalstatistic').then(res => {\r\n      if (res) {\r\n        if (res.data) {\r\n          this.opStatistics = res.data.current;\r\n          this.opStatisticsPrevious = res.data.previous\r\n            ? res.data.previous\r\n            : null;\r\n          //render pie chart\r\n          let ctx = document.getElementById('operationalPie');\r\n          me.cards.liveoperationalstatistics = new Chart(ctx, {\r\n            type: 'pie',\r\n            data: {\r\n              labels: ['Not Operational', 'Operational', 'Unknown'],\r\n              datasets: [\r\n                {\r\n                  data: [\r\n                    me.opStatistics.notOperational,\r\n                    me.opStatistics.operational,\r\n                    me.opStatistics.unknown\r\n                  ],\r\n                  backgroundColor: ['#00838f', '#00acc1', '#b2ebf2', '#e0f7fa'],\r\n                  hoverBackgroundColor: ['#00838f', '#00acc1', '#b2ebf2', '#e0f7fa']\r\n                }\r\n              ]\r\n            }\r\n          });\r\n        }\r\n      }\r\n      this.loadingliveOperationalStatisticsPie = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render Mini Alarms Widget\r\n   */\r\n  renderMiniAlarms() {\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            field: '_asset.name',\r\n            title: 'Asset',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            },\r\n            template: \"<a href='\\\\#asset-details/#:_asset._id#'>#:_asset.name#</a>\"\r\n          },\r\n          {\r\n            field: 'name',\r\n            title: 'Alarm',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'triggerDate',\r\n            title: 'Trigger Date',\r\n            template: '#if(triggerTime){# #: App.util.format.dateTime(triggerTime, App.currentUser.dateTimeFormat) # #}#'\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //avoid auto-sizing the columns\r\n    config.dataBound = function() {\r\n      //do nothing\r\n    };\r\n\r\n    //remove toolbar\r\n    config.toolbar = null;\r\n    //remove grouping\r\n    config.groupable = false;\r\n    //set the access url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/alarm';\r\n    //select the columns\r\n    config.dataSource.transport.read.data = {\r\n      values: 'name,triggerTime,_asset'\r\n    };\r\n    //filter the data\r\n    config.dataSource.filter = [\r\n      {\r\n        field: 'triggered',\r\n        operator: 'eq',\r\n        value: true\r\n      }\r\n    ];\r\n\r\n    //render the grid\r\n    this.grid = $('#miniAlarms').kendoGrid(config);\r\n  }\r\n\r\n  /**\r\n   * Once dom is deattached\r\n   */\r\n  deattached() {\r\n    console.info('overview deattached');\r\n    // this.stopRefresher();\r\n  }\r\n}\r\n","import { Aurelia, inject } from 'aurelia-framework';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\nimport { Http } from '../http';\r\n\r\n@inject(Aurelia, Http, HttpClient)\r\nexport class Profile {\r\n  loading = true;\r\n  //user model\r\n  model;\r\n\r\n  //list of non-aurelia based controls\r\n  controls = {};\r\n\r\n  constructor(aurelia, http, httpclient) {\r\n    this.client = http.client;\r\n    this.httpclient = httpclient;\r\n    this.aurelia = aurelia;\r\n  }\r\n\r\n  /**\r\n   * Load user profile data\r\n   */\r\n  activate() {\r\n    //get the user from local storage\r\n    this.model = JSON.parse(localStorage.getItem('currentUser'));\r\n    this.loading = false;\r\n  }\r\n\r\n  /**\r\n   * DOM attachment\r\n   */\r\n  attached() {\r\n    let me = this;\r\n\r\n    console.log(me.model);\r\n\r\n    //create the timezone selector with the value\r\n    this.controls.timezone = $('#timezone').kendoComboBox({\r\n      dataSource: moment.tz.names(),\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.timezone ? me.model.timezone : 'Asia/Dubai'\r\n    });\r\n\r\n    //create the distance selector with the value\r\n    this.controls.distance = $('#distance').kendoComboBox({\r\n      dataSource: App.config.distance,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.distance ? me.model.distance : 'km'\r\n    });\r\n\r\n    //create the distance selector with the value\r\n    this.controls.speed = $('#speed').kendoComboBox({\r\n      dataSource: App.config.speed,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.speed ? me.model.speed : 'km/hr'\r\n    });\r\n\r\n    //create the pressure selector with the value\r\n    this.controls.pressure = $('#pressure').kendoComboBox({\r\n      dataSource: App.config.pressure,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.v ? me.model.pressure : 'psi'\r\n    });\r\n\r\n    //create the distance selector with the value\r\n    this.controls.volume = $('#volume').kendoComboBox({\r\n      dataSource: App.config.volume,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.volume ? me.model.volume : 'l'\r\n    });\r\n\r\n    //create the temperature selector with the value\r\n    this.controls.temperature = $('#temperature').kendoComboBox({\r\n      dataSource: App.config.temperature,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.temperature ? me.model.temperature : 'Celsius'\r\n    });\r\n\r\n    //create the dateTime selector with the value\r\n    this.controls.dateTimeFormat = $('#dateTime').kendoComboBox({\r\n      dataSource: App.config.dateTimeFormat,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.dateTimeFormat\r\n        ? me.model.dateTimeFormat\r\n        : 'D/MM/YYYY h:mm:ss a'\r\n    });\r\n\r\n    //create the date selector with the value\r\n    this.controls.dateFormat = $('#date').kendoComboBox({\r\n      dataSource: App.config.dateFormat,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.dateFormat ? me.model.dateFormat : 'D/MM/YYYY'\r\n    });\r\n\r\n    //create the time selector with the value\r\n    this.controls.timeFormat = $('#time').kendoComboBox({\r\n      dataSource: App.config.timeFormat,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.timeFormat ? me.model.timeFormat : 'h:mm:ss a'\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Submit profile changes\r\n   */\r\n  submit() {\r\n    let me = this;\r\n    this.loading = true;\r\n\r\n    //get all third  party control values\r\n    for (let key in this.controls) {\r\n      this.model[key] = this.controls[key].val();\r\n    }\r\n\r\n    this.client.put(`/user/${this.model.loginName}`, this.model).then(data => {\r\n      me.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //logout user\r\n        localStorage.removeItem('currentUser');\r\n        this.aurelia.setRoot('login/login');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Uploading an avatar\r\n   * @param {*} images\r\n   */\r\n  uploadAvatar(images) {\r\n    if (images && images[0]) {\r\n      let image = images[0];\r\n      let filename;\r\n\r\n      console.log(images[0]);\r\n\r\n      switch (image.type) {\r\n      case 'image/png':\r\n        filename = this.model.loginName + '.png';\r\n        break;\r\n\r\n      case 'image/jpeg':\r\n        filename = this.model.loginName + '.jpg';\r\n        break;\r\n\r\n      default:\r\n        Materialize.toast('Please upload a .jpg or .png file', 3000);\r\n        break;\r\n      }\r\n\r\n      //if filename exists\r\n      if (filename) {\r\n        let me = this;\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('images', image, filename);\r\n        formData.append('user', this.model.loginName);\r\n\r\n        //use FETCH API to POST image\r\n\r\n        this.httpclient\r\n          .fetch(App.config.apiUrl + '/user/photo', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            localStorage.removeItem('currentUser');\r\n            me.aurelia.setRoot('login/login');\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload an image.', 2000);\r\n    }\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class ProjectAdmin {\r\n  loading = true;\r\n\r\n  //asset model\r\n  model = {\r\n    assets: []\r\n  };\r\n\r\n  //creating (false) or updating flag (true)\r\n  update = false;\r\n\r\n  //asset tags\r\n  tagger;\r\n\r\n  constructor(http, httpClient) {\r\n    this.client = http.client;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  /**\r\n     * Once the component is activated\r\n     * @param {string} params asset _id\r\n     */\r\n  activate(params) {\r\n    console.log('project admin activate');\r\n    if (params.id) {\r\n      //updating\r\n      this.update = true;\r\n      this.client.get(`/project/id/${params.id}`).then(res => {\r\n        this.loading = false;\r\n        if (res && res.data) {\r\n          this.model = res.data[0];\r\n          this.tagger.add(this.model.tags);\r\n          //set the value\r\n          if (this.model.assets.length) {\r\n            $(this.projectAssets)\r\n              .data('kendoMultiSelect')\r\n              .value(this.model.assets);\r\n            //redo the assets list\r\n            for (let i = 0; i < this.model.assets.length; i++) {\r\n              // this.model.assets[i] = this.model.assets[i]._id;\r\n              this.model.assets[i] = this.model.assets[i];\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Once the DOM is attached\r\n     */\r\n  attached() {\r\n    console.log('project admin attached');\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('project-tags', {\r\n      allowDuplicates: false\r\n    });\r\n\r\n    //asset list multiselect\r\n    $(this.projectAssets).kendoMultiSelect({\r\n      placeholder: 'Select gensets...',\r\n      dataTextField: 'name',\r\n      dataValueField: '_id',\r\n      ignoreCase: false,\r\n      filter: 'contains',\r\n      minLength: 3,\r\n      dataSource: {\r\n        type: 'odata',\r\n        serverFiltering: true,\r\n        transport: {\r\n          read: {\r\n            type: 'GET',\r\n            contentType: 'application/json',\r\n            accept: 'application/json, text/plain, */*',\r\n            dataType: 'json',\r\n            xhrFields: { withCredentials: true },\r\n            url: App.config.apiUrl + '/misc/find/'\r\n          }\r\n        }\r\n      },\r\n      select: function(e) {\r\n        //navigate to object\r\n        if (e.dataItem._id) {\r\n          me.model.assets.push(e.dataItem._id);\r\n        }\r\n      },\r\n      deselect: function(e) {\r\n        //navigate to object\r\n        if (e.dataItem._id) {\r\n          let idx = me.model.assets.indexOf(e.dataItem._id);\r\n          if (idx > -1) {\r\n            me.model.assets.splice(idx, 1);\r\n          }\r\n        }\r\n      }\r\n\r\n      //  value: []\r\n    });\r\n  }\r\n  /**\r\n     * Create or Update Asset\r\n     */\r\n  submit() {\r\n    this.loading = true;\r\n\r\n    //get tags\r\n    if (this.tagger) {\r\n      this.model.tags = this.tagger.getTags().values;\r\n    }\r\n\r\n    if (this.update) {\r\n      //update\r\n      this.client\r\n        .put(`/project/id/${this.model._id}`, this.model)\r\n        .then(data => {\r\n          this.loading = false;\r\n          if (data && data.message) {\r\n            Materialize.toast(data.message, 5000);\r\n            //go to the list\r\n            window.location.hash = '#/project-list';\r\n          }\r\n        });\r\n    } else {\r\n      //create\r\n      this.client.post('/project/', this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/project-list';\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete the asset\r\n   */\r\n  delete() {\r\n    // if (this.model.assets.length) {\r\n    // Materialize.toast('Please deallocate assets if you want to delete the project.', 3000);\r\n    // } else {\r\n    //delete project\r\n    this.client.delete(`/project/id/${this.model._id}`).then(data => {\r\n      this.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //go to the list\r\n        window.location.hash = '#/project-list';\r\n      }\r\n    });\r\n\r\n    // }\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Http)\r\nexport class ProjectList {\r\n  http;\r\n\r\n  //widgets\r\n  grid;\r\n  tagger;\r\n\r\n  constructor(http) {\r\n    this.http = http;\r\n  }\r\n\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('list-tags', {\r\n      allowDuplicates: false,\r\n      //on addition of tags\r\n      onTagAdd: function(event, tag) {\r\n        if (me.tagger) {\r\n          me.renderGrid(me.tagger.getTags().values);\r\n        }\r\n      },\r\n      //on removal of tag\r\n      onTagRemove: function(event, tag) {\r\n        me.renderGrid(me.tagger.getTags().values);\r\n      }\r\n    });\r\n    //render all assets grid\r\n    this.renderGrid();\r\n  }\r\n\r\n  renderGrid(tags) {\r\n    console.log('render grid');\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        detailTemplate: kendo.template($('#template').html()),\r\n        columns: [\r\n          {\r\n            template: \"<a href='\\\\#asset-list/#:_id#'>#:name#</a>\",\r\n            field: 'name',\r\n            title: 'Project Name',\r\n            width: 150,\r\n            filterable: {\r\n              cell: {\r\n                showOperators: false,\r\n                operator: 'contains',\r\n                suggestionOperator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'assets',\r\n            title: 'Assets',\r\n            filterable: false,\r\n            template: function(dataItem) {\r\n              let html = [];\r\n              for (let i = 0; i < dataItem.assets.length; i++) {\r\n                if (dataItem.assets[i]) {\r\n                  html.push(\r\n                    `<a href='#asset-details/${dataItem.assets[i]._id}'>${dataItem.assets[i].name}</a>`\r\n                  );\r\n                }\r\n              }\r\n              return html.join(', ');\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    //check for project admin access(2)\r\n    if (App.currentUser.privileges.indexOf(2) > -1) {\r\n      config.toolbar.push({\r\n        template: '<a class=\"k-button\" href=\"\\\\#/project-admin\"><span class=\"k-icon k-i-plus-outline\"></span> Create New</a>'\r\n      });\r\n    }\r\n\r\n    //set the data types\r\n    config.dataSource.schema.model.fields = {\r\n      name: { type: 'string' }\r\n    };\r\n\r\n    //extend to include tags\r\n    if (tags) {\r\n      config.dataSource.filter = { field: 'tags', operator: 'eq', value: tags };\r\n    }\r\n    //set the request url\r\n    config.dataSource.transport.read.url = App.config.apiUrl + '/project';\r\n\r\n    this.grid = $('#projectGrid').kendoGrid(config);\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\n\r\n@inject(Http)\r\nexport class ReportAssetUtilization {\r\n  http;\r\n\r\n  //widgets\r\n  grid;\r\n  tagger;\r\n\r\n  constructor(http) {\r\n    this.http = http;\r\n  }\r\n\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('list-tags', {\r\n      allowDuplicates: false,\r\n      //on addition of tags\r\n      onTagAdd: function (event, tag) {\r\n        if (me.tagger) {\r\n          me.renderGrid(me.tagger.getTags().values);\r\n        }\r\n      },\r\n      //on removal of tag\r\n      onTagRemove: function (event, tag) {\r\n        me.renderGrid(me.tagger.getTags().values);\r\n      }\r\n    });\r\n    //render all assets grid\r\n    this.renderGrid();\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {*} tags\r\n   */\r\n  renderGrid(tags) {\r\n    console.log('render grid');\r\n    //set columns for the grid\r\n    let config = $.extend(\r\n      true,\r\n      {\r\n        columns: [\r\n          {\r\n            template: \"# if(_asset.pState == 1){ # <a href='\\\\#asset-details/#:_asset._id#'>#:_asset.name#</a> # }else{ # #:_asset.name#  # } #\",\r\n            field: 'name',\r\n            title: 'Asset Name',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            template: \"#: moment(startTime).format('D/M/YYYY') #\",\r\n            field: 'startTime',\r\n            title: 'Date'\r\n          },\r\n          {\r\n            field: 'powerOutputKW',\r\n            title: 'Power Output in KW',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'averagePowerOutput',\r\n            title: 'Average Power Output in KW',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'totalFuelUsed',\r\n            title: 'Total Fuel Used',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: 'totalEngineHours',\r\n            title: 'Total Engine Hours',\r\n            filterable: {\r\n              cell: {\r\n                operator: 'contains'\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      App.config.grid\r\n    );\r\n\r\n    config.dataBound = function () {\r\n      //do nothing\r\n    };\r\n\r\n    //set the data types\r\n    config.dataSource.schema.model.fields = {\r\n      name: { type: 'string' }\r\n    };\r\n\r\n    //extend to include tags\r\n    if (tags) {\r\n      config.dataSource.filter = { field: 'tags', operator: 'eq', value: tags };\r\n    }\r\n    //set the request url\r\n    config.dataSource.transport.read.url =\r\n      App.config.apiUrl + '/statistics/assetutilization';\r\n\r\n    this.grid = $('#assetUtilizationGrid').kendoGrid(config);\r\n  }\r\n}\r\n","export function configure(config) {\r\n  //config.globalResources([]);\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\nimport { Router } from 'aurelia-router';\r\n\r\n@inject(Http, HttpClient, Router)\r\nexport class UserAdmin {\r\n  loading = true;\r\n\r\n  //asset model\r\n  model = {\r\n    assets: [],\r\n    privileges: []\r\n  };\r\n\r\n  //creating (false) or updating flag (true)\r\n  update = false;\r\n\r\n  //asset tags\r\n  tagger;\r\n\r\n  //list of non-aurelia based controls\r\n  controls = {};\r\n\r\n  constructor(http, httpClient, router) {\r\n    this.client = http.client;\r\n    this.fetchAPI = httpClient;\r\n    this.router = router;\r\n\r\n    //get user role settings\r\n    this.possiblePrivileges = App.config.privileges;\r\n  }\r\n\r\n  /**\r\n     * Once the component is activated\r\n     * @param {string} params asset _id\r\n     */\r\n  activate(params) {\r\n    console.log('user admin activate');\r\n  }\r\n\r\n  /**\r\n     * Once the DOM is attached\r\n     */\r\n  attached() {\r\n    console.log('user admin attached');\r\n    let me = this;\r\n    console.log(this.router.currentInstruction.params);\r\n    if (\r\n      this.router.currentInstruction.params &&\r\n      this.router.currentInstruction.params.id\r\n    ) {\r\n      let id = this.router.currentInstruction.params.id;\r\n      //updating\r\n      this.update = true;\r\n      this.client.get(`/user/id/${id}`).then(res => {\r\n        this.loading = false;\r\n        if (res && res.data) {\r\n          this.model = res.data[0];\r\n          this.displayControls();\r\n        }\r\n      });\r\n    } else {\r\n      this.displayControls();\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  displayControls() {\r\n    let me = this;\r\n    //create the timezone selector with the value\r\n    this.controls.timezone = $('#timezone').kendoComboBox({\r\n      dataTextField: 'text',\r\n      dataValueField: 'offset',\r\n      dataSource: App.config.timezone,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.timezone ? me.model.timezone : 4\r\n    });\r\n\r\n    //create the distance selector with the value\r\n    this.controls.distance = $('#distance').kendoComboBox({\r\n      dataSource: App.config.distance,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.distance ? me.model.distance : 'km'\r\n    });\r\n\r\n    //create the distance selector with the value\r\n    this.controls.speed = $('#speed').kendoComboBox({\r\n      dataSource: App.config.speed,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.speed ? me.model.speed : 'km/hr'\r\n    });\r\n\r\n    //create the pressure selector with the value\r\n    this.controls.pressure = $('#pressure').kendoComboBox({\r\n      dataSource: App.config.pressure,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.v ? me.model.pressure : 'psi'\r\n    });\r\n\r\n    //create the distance selector with the value\r\n    this.controls.volume = $('#volume').kendoComboBox({\r\n      dataSource: App.config.volume,\r\n      filter: 'contains',\r\n      suggest: true,\r\n      value: me.model.volume ? me.model.volume : 'l'\r\n    });\r\n  }\r\n  /**\r\n     * Create or Update Asset\r\n     */\r\n  submit() {\r\n    this.loading = true;\r\n\r\n    //get all third  party control values\r\n    for (let key in this.controls) {\r\n      this.model[key] = this.controls[key].val();\r\n    }\r\n\r\n    if (this.update) {\r\n      //update\r\n\r\n      this.client.put(`/user/id/${this.model._id}`, this.model).then(data => {\r\n        this.loading = false;\r\n\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/administration';\r\n        }\r\n      });\r\n    } else {\r\n      //create\r\n\r\n      this.client.post('/user/', this.model).then(data => {\r\n        this.loading = false;\r\n\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/administration';\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete the asset\r\n   */\r\n  delete() {\r\n    // if (this.model.assets.length) {\r\n    // Materialize.toast('Please deallocate assets if you want to delete the project.', 3000);\r\n    // } else {\r\n    //delete project\r\n    this.client.delete(`/user/id/${this.model._id}`).then(data => {\r\n      this.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //go to the list\r\n        window.location.hash = '#/administration';\r\n      }\r\n    });\r\n\r\n    // }\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class AssetAdmin {\r\n  loading = true;\r\n\r\n  //asset model\r\n  model = {\r\n    features: App.config.features\r\n  };\r\n\r\n  //creating (false) or updating flag (true)\r\n  update = false;\r\n\r\n  //asset tags\r\n  tagger;\r\n\r\n  constructor(http, httpClient) {\r\n    this.client = http.client;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  /**\r\n     * Once the component is activated\r\n     * @param {string} params asset _id\r\n     */\r\n  activate(params) {\r\n    if (params.id) {\r\n      //updating\r\n      this.update = true;\r\n      this.client.get(`/asset/id/${params.id}`).then(res => {\r\n        this.loading = false;\r\n        if (res && res.data) {\r\n          //set the asset model\r\n          this.model = $.extend(true, this.model, res.data[0]);\r\n          //add tags\r\n          this.tagger.add(this.model.tags);\r\n          //set Generator Frequency Value\r\n          if (this.model.generatorFrequency) {\r\n            $(this.generatorFrequency)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorFrequency);\r\n          }\r\n          if (this.model.generatorEngineRating) {\r\n            $(this.generatorEngineRating)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorEngineRating);\r\n          }\r\n          if (this.model.status) {\r\n            $(this.status).data('kendoDropDownList').value(this.model.status);\r\n          }\r\n          if (this.model.interfaceType) {\r\n            $(this.interfaceType)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.interfaceType);\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Once the DOM is attached\r\n     */\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('admin-tags', {\r\n      allowDuplicates: false\r\n    });\r\n\r\n    //create generator Frequency dropdown\r\n    $(this.generatorFrequency).kendoDropDownList({\r\n      dataSource: App.config.generatorFrequency,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorFrequency = this.value();\r\n      }\r\n    });\r\n    //generator engine rating dropdown\r\n    $(this.generatorEngineRating).kendoDropDownList({\r\n      dataSource: App.config.generatorEngineRating,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorEngineRating = this.value();\r\n      }\r\n    });\r\n    //generator status dropdown\r\n    $(this.status).kendoDropDownList({\r\n      dataSource: App.config.generatorStatus,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.status = this.value();\r\n      }\r\n    });\r\n    //mailbox types\r\n    $(this.interfaceType).kendoDropDownList({\r\n      dataSource: App.config.interfaceType,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.interfaceType = this.value();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Uploading an avatar\r\n   * @param {*} images\r\n   */\r\n  uploadAssetImage(images) {\r\n    console.log('uploadAssetImage');\r\n    if (images && images[0]) {\r\n      let image = images[0];\r\n      let filename;\r\n\r\n      switch (image.type) {\r\n      case 'image/png':\r\n        filename = this.model._id + '.png';\r\n        break;\r\n\r\n      case 'image/jpeg':\r\n        filename = this.model._id + '.jpg';\r\n        break;\r\n\r\n      default:\r\n        Materialize.toast('Please upload a .jpg or .png file', 3000);\r\n        break;\r\n      }\r\n      if (filename && this.model._id) {\r\n        let me = this;\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('images', image, filename);\r\n        formData.append('_id', this.model._id);\r\n\r\n        //use FETCH API to POST image\r\n\r\n        this.fetchAPI\r\n          .fetch(App.config.apiUrl + '/asset/photo', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            if (data) {\r\n              Materialize.toast('Asset image uploaded successfully.', 3000);\r\n            }\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload an image.', 2000);\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Create or Update Asset\r\n     */\r\n  submit() {\r\n    this.loading = true;\r\n\r\n    //get tags\r\n    if (this.tagger) {\r\n      this.model.tags = this.tagger.getTags().values;\r\n    }\r\n\r\n    if (this.update) {\r\n      //update\r\n      this.client.put(`/asset/id/${this.model._id}`, this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    } else {\r\n      //create\r\n      this.client.post('/asset/', this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete the asset\r\n   */\r\n  delete() {\r\n    //create\r\n    this.client.delete(`/asset/id/${this.model._id}`).then(data => {\r\n      this.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //go to the list\r\n        window.location.hash = '#/asset-list';\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class AssetAdmin {\r\n  loading = true;\r\n\r\n  //asset model\r\n  model = {\r\n    features: App.config.features\r\n  };\r\n\r\n  //creating (false) or updating flag (true)\r\n  update = false;\r\n\r\n  //asset tags\r\n  tagger;\r\n\r\n  constructor(http, httpClient) {\r\n    this.client = http.client;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  /**\r\n     * Once the component is activated\r\n     * @param {string} params asset _id\r\n     */\r\n  activate(params) {\r\n    if (params.id) {\r\n      //updating\r\n      this.update = true;\r\n      this.client.get(`/asset/id/${params.id}`).then(res => {\r\n        this.loading = false;\r\n        if (res && res.data) {\r\n          //set the asset model\r\n          this.model = $.extend(true, this.model, res.data[0]);\r\n          //add tags\r\n          this.tagger.add(this.model.tags);\r\n          //set Generator Frequency Value\r\n          if (this.model.generatorFrequency) {\r\n            $(this.generatorFrequency)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorFrequency);\r\n          }\r\n          if (this.model.generatorEngineRating) {\r\n            $(this.generatorEngineRating)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorEngineRating);\r\n          }\r\n          if (this.model.status) {\r\n            $(this.status).data('kendoDropDownList').value(this.model.status);\r\n          }\r\n          if (this.model.interfaceType) {\r\n            $(this.interfaceType)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.interfaceType);\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Once the DOM is attached\r\n     */\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('admin-tags', {\r\n      allowDuplicates: false\r\n    });\r\n\r\n    //create generator Frequency dropdown\r\n    $(this.generatorFrequency).kendoDropDownList({\r\n      dataSource: App.config.generatorFrequency,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorFrequency = this.value();\r\n      }\r\n    });\r\n    //generator engine rating dropdown\r\n    $(this.generatorEngineRating).kendoDropDownList({\r\n      dataSource: App.config.generatorEngineRating,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorEngineRating = this.value();\r\n      }\r\n    });\r\n    //generator status dropdown\r\n    $(this.status).kendoDropDownList({\r\n      dataSource: App.config.generatorStatus,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.status = this.value();\r\n      }\r\n    });\r\n    //mailbox types\r\n    $(this.interfaceType).kendoDropDownList({\r\n      dataSource: App.config.interfaceType,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.interfaceType = this.value();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Uploading an avatar\r\n   * @param {*} images\r\n   */\r\n  uploadAssetImage(images) {\r\n    console.log('uploadAssetImage');\r\n    if (images && images[0]) {\r\n      let image = images[0];\r\n      let filename;\r\n\r\n      switch (image.type) {\r\n      case 'image/png':\r\n        filename = this.model._id + '.png';\r\n        break;\r\n\r\n      case 'image/jpeg':\r\n        filename = this.model._id + '.jpg';\r\n        break;\r\n\r\n      default:\r\n        Materialize.toast('Please upload a .jpg or .png file', 3000);\r\n        break;\r\n      }\r\n      if (filename && this.model._id) {\r\n        let me = this;\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('images', image, filename);\r\n        formData.append('_id', this.model._id);\r\n\r\n        //use FETCH API to POST image\r\n\r\n        this.fetchAPI\r\n          .fetch(App.config.apiUrl + '/asset/photo', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            if (data) {\r\n              Materialize.toast('Asset image uploaded successfully.', 3000);\r\n            }\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload an image.', 2000);\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Create or Update Asset\r\n     */\r\n  submit() {\r\n    this.loading = true;\r\n\r\n    //get tags\r\n    if (this.tagger) {\r\n      this.model.tags = this.tagger.getTags().values;\r\n    }\r\n\r\n    if (this.update) {\r\n      //update\r\n      this.client.put(`/asset/id/${this.model._id}`, this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    } else {\r\n      //create\r\n      this.client.post('/asset/', this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete the asset\r\n   */\r\n  delete() {\r\n    //create\r\n    this.client.delete(`/asset/id/${this.model._id}`).then(data => {\r\n      this.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //go to the list\r\n        window.location.hash = '#/asset-list';\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { inject } from 'aurelia-framework';\r\nimport { Http } from '../http';\r\nimport { HttpClient } from 'aurelia-fetch-client';\r\n\r\n@inject(Http, HttpClient)\r\nexport class AdAdmin {\r\n  loading = true;\r\n\r\n  //asset model\r\n  model = {\r\n    features: App.config.features\r\n  };\r\n\r\n  //creating (false) or updating flag (true)\r\n  update = false;\r\n\r\n  //asset tags\r\n  tagger;\r\n\r\n  constructor(http, httpClient) {\r\n    this.client = http.client;\r\n    this.fetchAPI = httpClient;\r\n  }\r\n\r\n  /**\r\n     * Once the component is activated\r\n     * @param {string} params asset _id\r\n     */\r\n  activate(params) {\r\n    if (params.id) {\r\n      //updating\r\n      this.update = true;\r\n      this.client.get(`/asset/id/${params.id}`).then(res => {\r\n        this.loading = false;\r\n        if (res && res.data) {\r\n          //set the asset model\r\n          this.model = $.extend(true, this.model, res.data[0]);\r\n          //add tags\r\n          this.tagger.add(this.model.tags);\r\n          //set Generator Frequency Value\r\n          if (this.model.generatorFrequency) {\r\n            $(this.generatorFrequency)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorFrequency);\r\n          }\r\n          if (this.model.generatorEngineRating) {\r\n            $(this.generatorEngineRating)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.generatorEngineRating);\r\n          }\r\n          if (this.model.status) {\r\n            $(this.status).data('kendoDropDownList').value(this.model.status);\r\n          }\r\n          if (this.model.interfaceType) {\r\n            $(this.interfaceType)\r\n              .data('kendoDropDownList')\r\n              .value(this.model.interfaceType);\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Once the DOM is attached\r\n     */\r\n  attached() {\r\n    let me = this;\r\n    //init tagger input\r\n    this.tagger = new Taggle('admin-tags', {\r\n      allowDuplicates: false\r\n    });\r\n\r\n    //create generator Frequency dropdown\r\n    $(this.generatorFrequency).kendoDropDownList({\r\n      dataSource: App.config.generatorFrequency,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorFrequency = this.value();\r\n      }\r\n    });\r\n    //generator engine rating dropdown\r\n    $(this.generatorEngineRating).kendoDropDownList({\r\n      dataSource: App.config.generatorEngineRating,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.generatorEngineRating = this.value();\r\n      }\r\n    });\r\n    //generator status dropdown\r\n    $(this.status).kendoDropDownList({\r\n      dataSource: App.config.generatorStatus,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.status = this.value();\r\n      }\r\n    });\r\n    //mailbox types\r\n    $(this.interfaceType).kendoDropDownList({\r\n      dataSource: App.config.interfaceType,\r\n      // index: 0,\r\n      change: function() {\r\n        //set the changed value\r\n        me.model.interfaceType = this.value();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Uploading an avatar\r\n   * @param {*} images\r\n   */\r\n  uploadAssetImage(images) {\r\n    console.log('uploadAssetImage');\r\n    if (images && images[0]) {\r\n      let image = images[0];\r\n      let filename;\r\n\r\n      switch (image.type) {\r\n      case 'image/png':\r\n        filename = this.model._id + '.png';\r\n        break;\r\n\r\n      case 'image/jpeg':\r\n        filename = this.model._id + '.jpg';\r\n        break;\r\n\r\n      default:\r\n        Materialize.toast('Please upload a .jpg or .png file', 3000);\r\n        break;\r\n      }\r\n      if (filename && this.model._id) {\r\n        let me = this;\r\n        //form-data\r\n        let formData = new FormData();\r\n        formData.append('images', image, filename);\r\n        formData.append('_id', this.model._id);\r\n\r\n        //use FETCH API to POST image\r\n\r\n        this.fetchAPI\r\n          .fetch(App.config.apiUrl + '/asset/photo', {\r\n            method: 'POST',\r\n            body: formData\r\n          })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            if (data) {\r\n              Materialize.toast('Asset image uploaded successfully.', 3000);\r\n            }\r\n          })\r\n          .catch(error => Materialize.toast(error.message, 5000));\r\n      }\r\n    } else {\r\n      Materialize.toast('Please upload an image.', 2000);\r\n    }\r\n  }\r\n\r\n  /**\r\n     * Create or Update Asset\r\n     */\r\n  submit() {\r\n    this.loading = true;\r\n\r\n    //get tags\r\n    if (this.tagger) {\r\n      this.model.tags = this.tagger.getTags().values;\r\n    }\r\n\r\n    if (this.update) {\r\n      //update\r\n      this.client.put(`/asset/id/${this.model._id}`, this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    } else {\r\n      //create\r\n      this.client.post('/asset/', this.model).then(data => {\r\n        this.loading = false;\r\n        if (data && data.message) {\r\n          Materialize.toast(data.message, 5000);\r\n          //go to the list\r\n          window.location.hash = '#/asset-list';\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete the asset\r\n   */\r\n  delete() {\r\n    //create\r\n    this.client.delete(`/asset/id/${this.model._id}`).then(data => {\r\n      this.loading = false;\r\n      if (data && data.message) {\r\n        Materialize.toast(data.message, 5000);\r\n        //go to the list\r\n        window.location.hash = '#/asset-list';\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":".."}